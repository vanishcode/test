(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[5470],{35470:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Wallet:()=>Wr,getWallet:()=>jr,initWallet:()=>$r,sequence:()=>ia});var s={};n.r(s),n.d(s,{walletContracts:()=>w});var i={};n.r(i),n.d(i,{API:()=>k,SequenceAPIClient:()=>x,SmartRampOrderStatus:()=>C,SmartRampTxnStatus:()=>E,SortOrder:()=>_,WebRPCSchemaHash:()=>b,WebRPCSchemaVersion:()=>v,WebRPCVersion:()=>y});var r={};n.r(r),n.d(r,{Logger:()=>We,base64Decode:()=>Oe,base64DecodeObject:()=>Ne,base64Encode:()=>xe,base64EncodeObject:()=>Te,checkProperties:()=>tt,configureLogger:()=>Fe,deepCopy:()=>st,defineReadOnly:()=>Ze,encodeMessageDigest:()=>Ae,encodeTypedDataDigest:()=>Qe,encodeTypedDataHash:()=>ze,getRandomInt:()=>je,getStatic:()=>Xe,isBigNumberish:()=>rt,isBrowser:()=>Le,isNode:()=>Re,jwtDecodeClaims:()=>Ue,logger:()=>Be,packMessageData:()=>Pe,promisify:()=>$e,queryStringFromObject:()=>He,queryStringToObject:()=>Ge,resolveProperties:()=>et,sanitizeAlphanumeric:()=>Ke,sanitizeHost:()=>Je,sanitizeNumberString:()=>Ve,shallowCopy:()=>nt,sleep:()=>Ye,subDigestOf:()=>Me,urlClean:()=>it});var a={};n.r(a),n.d(a,{AllowProvider:()=>Bt,CachedProvider:()=>$t,ChainId:()=>_t,EagerProvider:()=>jt,JsonRpcExternalProvider:()=>Wt,JsonRpcRouter:()=>Mt,JsonRpcSender:()=>qt,JsonRpcVersion:()=>Pt,PublicProvider:()=>Yt,SigningProvider:()=>Jt,allowProviderMiddleware:()=>Ft,checkNetworkConfig:()=>vt,createJsonRpcMiddlewareStack:()=>Rt,ensureUniqueNetworks:()=>ft,ensureValidNetworks:()=>gt,exceptionProviderMiddleware:()=>Ht,findNetworkConfig:()=>yt,getAuthNetwork:()=>ut,getChainId:()=>ht,indexerURL:()=>St,isJsonRpcHandler:()=>Ut,isJsonRpcProvider:()=>Lt,isNetworkConfig:()=>lt,isValidNetworkConfig:()=>pt,loggingProviderMiddleware:()=>Gt,mainnetNetworks:()=>Ot,maybeChainId:()=>dt,networkProviderMiddleware:()=>Vt,networks:()=>Tt,networksIndex:()=>bt,nodesURL:()=>xt,relayerURL:()=>It,sequenceContext:()=>At,sortNetworks:()=>Ct,stringTemplate:()=>Et,testnetNetworks:()=>Nt,updateNetworkConfig:()=>wt,validateAndSortNetworks:()=>mt});var o={};n.r(o),n.d(o,{Multicall:()=>en,providers:()=>sn});var c={};n.r(c),n.d(c,{ConfigFinder:()=>Cn,SequenceUtilsFinder:()=>_n,SignatureType:()=>On,WalletContractBytecode:()=>rn,addressOf:()=>gn,buildStubSignature:()=>qn,compareAddr:()=>yn,createWalletConfig:()=>dn,decodeSignature:()=>Nn,editConfig:()=>vn,encodeSignature:()=>Ln,genConfig:()=>bn,imageHash:()=>fn,isConfigEqual:()=>mn,isDecodedAddress:()=>kn,isDecodedEOASigner:()=>In,isDecodedEOASplitSigner:()=>xn,isDecodedFullSigner:()=>Tn,isDecodedSigner:()=>Sn,isUsableConfig:()=>un,isValidConfigSigners:()=>pn,joinSignatures:()=>Mn,joinTwoSignatures:()=>Rn,mutateSignature:()=>Dn,recoverEOASigner:()=>Pn,signerOf:()=>Un,sortConfig:()=>wn,splitDecodedEOASigner:()=>An});var l={};n.r(l),n.d(l,{ContractType:()=>jn,EventLogDataType:()=>Gn,EventLogType:()=>Hn,Indexer:()=>Jn,SequenceIndexerClient:()=>Zn,SequenceIndexerServices:()=>Qn,SortOrder:()=>Kn,TxnTransferType:()=>Vn,WebRPCSchemaHash:()=>$n,WebRPCSchemaVersion:()=>Fn,WebRPCVersion:()=>Bn});var h={};n.r(h),n.d(h,{ContractType:()=>ss,Metadata:()=>as,SequenceMetadataClient:()=>ls,SortOrder:()=>rs,SwapType:()=>is,WebRPCSchemaHash:()=>ns,WebRPCSchemaVersion:()=>ts,WebRPCVersion:()=>es});var d={};n.r(d),n.d(d,{MetaTransactionsType:()=>fs,appendNonce:()=>Os,computeMetaTxnHash:()=>bs,decodeNonce:()=>Ms,digestOfTransactions:()=>ys,digestOfTransactionsNonce:()=>vs,encodeNonce:()=>Ps,flattenAuxTransactions:()=>Es,fromTransactionish:()=>Ls,hasSequenceTransactions:()=>Is,isAsyncSendable:()=>ks,isSequenceTransaction:()=>Ss,isSignedTransactions:()=>Rs,makeAfterNonce:()=>As,makeExpirable:()=>Ns,packMetaTransactionsData:()=>ws,packMetaTransactionsNonceData:()=>ms,readSequenceNonce:()=>xs,sequenceTxAbiEncode:()=>Ts,toSequenceTransaction:()=>_s,toSequenceTransactions:()=>Cs});var u={};n.r(u),n.d(u,{BaseRelayer:()=>Ws,BaseRelayerDefaults:()=>qs,LocalRelayer:()=>Gs,ProviderRelayer:()=>js,ProviderRelayerDefaults:()=>Fs,RpcRelayer:()=>si,RpcRelayerProto:()=>Xs,isBaseRelayerOptions:()=>Ds,isLocalRelayerOptions:()=>Hs,isProviderRelayerOptions:()=>$s,isRelayer:()=>ri,isRpcRelayerOptions:()=>ni,proto:()=>Xs});var p={};n.r(p),n.d(p,{AuthError:()=>Si,DEFAULT_SESSION_EXPIRATION:()=>vi,ErrAccountIsRequired:()=>Ii,LONG_SESSION_EXPIRATION:()=>bi,Session:()=>Ci,ValidateSequenceDeployedWalletProof:()=>xi,ValidateSequenceUndeployedWalletProof:()=>Ti,signAuthorization:()=>ki});var g={};n.r(g),n.d(g,{Guard:()=>Mi,WebRPCSchemaHash:()=>Pi,WebRPCSchemaVersion:()=>Ai,WebRPCVersion:()=>Ni});var f={};n.r(f),n.d(f,{BaseInjectedTransport:()=>Pr,BaseProviderTransport:()=>Yi,BaseWalletTransport:()=>br,CHANNEL_ID:()=>Or,DefaultProviderConfig:()=>Br,ErrSignedInRequired:()=>Gi,EventType:()=>Fi,ExtensionMessageHandler:()=>Nr,ExtensionMessageProvider:()=>Ar,InitState:()=>ji,LocalStorage:()=>mr,LocalStore:()=>yr,LocalWeb3Provider:()=>er,MuxMessageProvider:()=>Sr,OpenState:()=>$i,PROVIDER_OPEN_TIMEOUT:()=>Vi,ProviderError:()=>Hi,ProxyMessageChannel:()=>Cr,ProxyMessageChannelPort:()=>Er,ProxyMessageHandler:()=>kr,ProxyMessageProvider:()=>_r,UnrealMessageHandler:()=>Dr,UnrealMessageProvider:()=>Ur,Wallet:()=>Wr,WalletRequestHandler:()=>zi,Web3Provider:()=>Zi,Web3Signer:()=>tr,WindowMessageHandler:()=>Tr,WindowMessageProvider:()=>xr,WindowSessionParams:()=>Bi,getWallet:()=>jr,initWallet:()=>$r,isBrowserExtension:()=>gr,isSequenceProvider:()=>Xi,isUnityPlugin:()=>fr,isValidMessageSignature:()=>dr,isValidSignature:()=>hr,isValidTypedDataSignature:()=>ur,isWalletUpToDate:()=>wr,messageToBytes:()=>cr,nextMessageIdx:()=>Ji,prefixEIP191Message:()=>lr,recoverWalletConfig:()=>pr});const w={erc1271:Object.freeze({__proto__:null,abi:[{type:"function",name:"isValidSignature",constant:!0,inputs:[{type:"bytes32"},{type:"bytes"}],outputs:[{type:"bytes4"}],payable:!1,stateMutability:"view"}],returns:{isValidSignatureBytes32:"0x1626ba7e"}}),factory:Object.freeze({__proto__:null,abi:[{type:"function",name:"deploy",constant:!1,inputs:[{type:"address"},{type:"bytes32"}],outputs:[],payable:!0,stateMutability:"payable"}]}),mainModule:Object.freeze({__proto__:null,abi:[{type:"function",name:"nonce",constant:!0,inputs:[],outputs:[{type:"uint256"}],payable:!1,stateMutability:"view"},{type:"function",name:"readNonce",constant:!0,inputs:[{type:"uint256"}],outputs:[{type:"uint256"}],payable:!1,stateMutability:"view"},{type:"function",name:"updateImplementation",constant:!1,inputs:[{type:"address"}],outputs:[],payable:!1,stateMutability:"nonpayable"},{type:"function",name:"selfExecute",constant:!1,inputs:[{components:[{type:"bool",name:"delegateCall"},{type:"bool",name:"revertOnError"},{type:"uint256",name:"gasLimit"},{type:"address",name:"target"},{type:"uint256",name:"value"},{type:"bytes",name:"data"}],type:"tuple[]"}],outputs:[],payable:!1,stateMutability:"nonpayable"},{type:"function",name:"execute",constant:!1,inputs:[{components:[{type:"bool",name:"delegateCall"},{type:"bool",name:"revertOnError"},{type:"uint256",name:"gasLimit"},{type:"address",name:"target"},{type:"uint256",name:"value"},{type:"bytes",name:"data"}],type:"tuple[]"},{type:"uint256"},{type:"bytes"}],outputs:[],payable:!1,stateMutability:"nonpayable"},{type:"function",name:"createContract",inputs:[{type:"bytes"}],payable:!0,stateMutability:"payable"}]}),mainModuleUpgradable:Object.freeze({__proto__:null,abi:[{type:"function",name:"updateImageHash",constant:!0,inputs:[{type:"bytes32"}],outputs:[],payable:!1,stateMutability:"view"},{type:"function",name:"imageHash",constant:!0,inputs:[],outputs:[{type:"bytes32"}],payable:!1,stateMutability:"view"}]}),sequenceUtils:Object.freeze({__proto__:null,abi:[{inputs:[{internalType:"address",name:"_factory",type:"address"},{internalType:"address",name:"_mainModule",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"_wallet",type:"address"},{indexed:!0,internalType:"bytes32",name:"_imageHash",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"_threshold",type:"uint256"},{indexed:!1,internalType:"bytes",name:"_signers",type:"bytes"}],name:"RequiredConfig",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"_wallet",type:"address"},{indexed:!0,internalType:"address",name:"_signer",type:"address"}],name:"RequiredSigner",type:"event"},{inputs:[{internalType:"address",name:"_addr",type:"address"}],name:"callBalanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"callBlockNumber",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_i",type:"uint256"}],name:"callBlockhash",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"callChainId",outputs:[{internalType:"uint256",name:"id",type:"uint256"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"_addr",type:"address"}],name:"callCode",outputs:[{internalType:"bytes",name:"code",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_addr",type:"address"}],name:"callCodeHash",outputs:[{internalType:"bytes32",name:"codeHash",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_addr",type:"address"}],name:"callCodeSize",outputs:[{internalType:"uint256",name:"size",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"callCoinbase",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"callDifficulty",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"callGasLeft",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"callGasLimit",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"callGasPrice",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"callOrigin",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"callTimestamp",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"knownImageHashes",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"lastImageHashUpdate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"lastSignerUpdate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"lastWalletUpdate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"bool",name:"delegateCall",type:"bool"},{internalType:"bool",name:"revertOnError",type:"bool"},{internalType:"uint256",name:"gasLimit",type:"uint256"},{internalType:"address",name:"target",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],internalType:"struct IModuleCalls.Transaction[]",name:"_txs",type:"tuple[]"}],name:"multiCall",outputs:[{internalType:"bool[]",name:"_successes",type:"bool[]"},{internalType:"bytes[]",name:"_results",type:"bytes[]"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_wallet",type:"address"},{internalType:"uint256",name:"_threshold",type:"uint256"},{components:[{internalType:"uint256",name:"weight",type:"uint256"},{internalType:"address",name:"signer",type:"address"}],internalType:"struct RequireUtils.Member[]",name:"_members",type:"tuple[]"},{internalType:"bool",name:"_index",type:"bool"}],name:"publishConfig",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_wallet",type:"address"},{internalType:"bytes32",name:"_hash",type:"bytes32"},{internalType:"uint256",name:"_sizeMembers",type:"uint256"},{internalType:"bytes",name:"_signature",type:"bytes"},{internalType:"bool",name:"_index",type:"bool"}],name:"publishInitialSigners",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_wallet",type:"address"},{internalType:"uint256",name:"_nonce",type:"uint256"}],name:"requireMinNonce",outputs:[],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_expiration",type:"uint256"}],name:"requireNonExpired",outputs:[],stateMutability:"view",type:"function"}]}),requireFreshSigner:Object.freeze({__proto__:null,abi:[{inputs:[{internalType:"address",name:"",type:"address"}],name:"requireFreshSigner",outputs:[],stateMutability:"nonpayable",type:"function"}]})};function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},m.apply(this,arguments)}const y="v1",v="v0.4.0",b="8e34a4b927a5faab07d6558c21251a5218b82ac4";let C,E,_;!function(e){e.UNKNOWN="UNKNOWN",e.RUNNING_CHECKS="RUNNING_CHECKS",e.PROCESSING="PROCESSING",e.FAILED="FAILED",e.COMPLETE="COMPLETE"}(C||(C={})),function(e){e.UNKNOWN="UNKNOWN",e.SUCCESSFUL="SUCCESSFUL",e.FAILED="FAILED"}(E||(E={})),function(e){e.DESC="DESC",e.ASC="ASC"}(_||(_={}));class k{constructor(e,t){this.hostname=void 0,this.fetch=void 0,this.path="/rpc/API/",this.ping=e=>this.fetch(this.url("Ping"),S({},e)).then((e=>I(e).then((e=>({status:e.status}))))),this.version=e=>this.fetch(this.url("Version"),S({},e)).then((e=>I(e).then((e=>({version:e.version}))))),this.runtimeStatus=e=>this.fetch(this.url("RuntimeStatus"),S({},e)).then((e=>I(e).then((e=>({status:e.status}))))),this.getSequenceContext=e=>this.fetch(this.url("GetSequenceContext"),S({},e)).then((e=>I(e).then((e=>({data:e.data}))))),this.getAuthToken=(e,t)=>this.fetch(this.url("GetAuthToken"),S(e,t)).then((e=>I(e).then((e=>({status:e.status,jwtToken:e.jwtToken,address:e.address,user:e.user}))))),this.sendPasswordlessLink=(e,t)=>this.fetch(this.url("SendPasswordlessLink"),S(e,t)).then((e=>I(e).then((e=>({status:e.status}))))),this.friendList=(e,t)=>this.fetch(this.url("FriendList"),S(e,t)).then((e=>I(e).then((e=>({page:e.page,friends:e.friends}))))),this.getFriendByAddress=(e,t)=>this.fetch(this.url("GetFriendByAddress"),S(e,t)).then((e=>I(e).then((e=>({status:e.status,friend:e.friend}))))),this.searchFriends=(e,t)=>this.fetch(this.url("SearchFriends"),S(e,t)).then((e=>I(e).then((e=>({friends:e.friends}))))),this.addFriend=(e,t)=>this.fetch(this.url("AddFriend"),S(e,t)).then((e=>I(e).then((e=>({status:e.status,friend:e.friend}))))),this.updateFriendNickname=(e,t)=>this.fetch(this.url("UpdateFriendNickname"),S(e,t)).then((e=>I(e).then((e=>({status:e.status,friend:e.friend}))))),this.removeFriend=(e,t)=>this.fetch(this.url("RemoveFriend"),S(e,t)).then((e=>I(e).then((e=>({status:e.status}))))),this.contractCall=(e,t)=>this.fetch(this.url("ContractCall"),S(e,t)).then((e=>I(e).then((e=>({returns:e.returns}))))),this.decodeContractCall=(e,t)=>this.fetch(this.url("DecodeContractCall"),S(e,t)).then((e=>I(e).then((e=>({call:e.call}))))),this.lookupContractCallSelectors=(e,t)=>this.fetch(this.url("LookupContractCallSelectors"),S(e,t)).then((e=>I(e).then((e=>({signatures:e.signatures}))))),this.userStorageFetch=(e,t)=>this.fetch(this.url("UserStorageFetch"),S(e,t)).then((e=>I(e).then((e=>({object:e.object}))))),this.userStorageSave=(e,t)=>this.fetch(this.url("UserStorageSave"),S(e,t)).then((e=>I(e).then((e=>({ok:e.ok}))))),this.userStorageDelete=(e,t)=>this.fetch(this.url("UserStorageDelete"),S(e,t)).then((e=>I(e).then((e=>({ok:e.ok}))))),this.userStorageFetchAll=(e,t)=>this.fetch(this.url("UserStorageFetchAll"),S(e,t)).then((e=>I(e).then((e=>({objects:e.objects}))))),this.getMoonpayLink=(e,t)=>this.fetch(this.url("GetMoonpayLink"),S(e,t)).then((e=>I(e).then((e=>({signedUrl:e.signedUrl}))))),this.getSardineClientToken=e=>this.fetch(this.url("GetSardineClientToken"),S({},e)).then((e=>I(e).then((e=>({token:e.token}))))),this.isUsingGoogleMail=(e,t)=>this.fetch(this.url("IsUsingGoogleMail"),S(e,t)).then((e=>I(e).then((e=>({yes:e.yes}))))),this.isValidSignature=(e,t)=>this.fetch(this.url("IsValidSignature"),S(e,t)).then((e=>I(e).then((e=>({isValid:e.isValid}))))),this.isValidMessageSignature=(e,t)=>this.fetch(this.url("IsValidMessageSignature"),S(e,t)).then((e=>I(e).then((e=>({isValid:e.isValid}))))),this.isValidTypedDataSignature=(e,t)=>this.fetch(this.url("IsValidTypedDataSignature"),S(e,t)).then((e=>I(e).then((e=>({isValid:e.isValid}))))),this.isValidETHAuthProof=(e,t)=>this.fetch(this.url("IsValidETHAuthProof"),S(e,t)).then((e=>I(e).then((e=>({isValid:e.isValid}))))),this.getCoinPrices=(e,t)=>this.fetch(this.url("GetCoinPrices"),S(e,t)).then((e=>I(e).then((e=>({tokenPrices:e.tokenPrices}))))),this.getCollectiblePrices=(e,t)=>this.fetch(this.url("GetCollectiblePrices"),S(e,t)).then((e=>I(e).then((e=>({tokenPrices:e.tokenPrices}))))),this.getExchangeRate=(e,t)=>this.fetch(this.url("GetExchangeRate"),S(e,t)).then((e=>I(e).then((e=>({exchangeRate:e.exchangeRate}))))),this.listPayCardsOnFile=e=>this.fetch(this.url("ListPayCardsOnFile"),S({},e)).then((e=>I(e).then((e=>({payCards:e.payCards}))))),this.savePayCard=(e,t)=>this.fetch(this.url("SavePayCard"),S(e,t)).then((e=>I(e).then((e=>({ok:e.ok,payCard:e.payCard}))))),this.updatePayCardCVC=(e,t)=>this.fetch(this.url("UpdatePayCardCVC"),S(e,t)).then((e=>I(e).then((e=>({ok:e.ok}))))),this.deletePayCard=(e,t)=>this.fetch(this.url("DeletePayCard"),S(e,t)).then((e=>I(e).then((e=>({ok:e.ok}))))),this.smartRampQuote=(e,t)=>this.fetch(this.url("SmartRampQuote"),S(e,t)).then((e=>I(e).then((e=>({status:e.status,quoteDetails:e.quoteDetails}))))),this.smartRampPurchase=(e,t)=>this.fetch(this.url("SmartRampPurchase"),S(e,t)).then((e=>I(e).then((e=>({processing:e.processing,receipt:e.receipt}))))),this.smartRampWaitOrderConfirmation=(e,t)=>this.fetch(this.url("SmartRampWaitOrderConfirmation"),S(e,t)).then((e=>I(e).then((e=>({done:e.done,receipt:e.receipt}))))),this.smartRampGetOrder=(e,t)=>this.fetch(this.url("SmartRampGetOrder"),S(e,t)).then((e=>I(e).then((e=>({order:e.order}))))),this.smartRampCheckCardAuthorization=(e,t)=>this.fetch(this.url("SmartRampCheckCardAuthorization"),S(e,t)).then((e=>I(e).then((e=>({cardAuth:e.cardAuth}))))),this.smartRampOrdersList=(e,t)=>this.fetch(this.url("SmartRampOrdersList"),S(e,t)).then((e=>I(e).then((e=>({page:e.page,orders:e.orders}))))),this.smartRampGetOrderTxnHash=(e,t)=>this.fetch(this.url("SmartRampGetOrderTxnHash"),S(e,t)).then((e=>I(e).then((e=>({txnHash:e.txnHash,txnSuccessful:e.txnSuccessful}))))),this.smartRampSubmitCardAuthorization=(e,t)=>this.fetch(this.url("SmartRampSubmitCardAuthorization"),S(e,t)).then((e=>I(e).then((e=>({status:e.status}))))),this.adminSmartRampGetOrder=(e,t)=>this.fetch(this.url("AdminSmartRampGetOrder"),S(e,t)).then((e=>I(e).then((e=>({order:e.order}))))),this.adminSmartRampListCompletedOrders=(e,t)=>this.fetch(this.url("AdminSmartRampListCompletedOrders"),S(e,t)).then((e=>I(e).then((e=>({orders:e.orders}))))),this.adminSmartRampListPendingOrders=(e,t)=>this.fetch(this.url("AdminSmartRampListPendingOrders"),S(e,t)).then((e=>I(e).then((e=>({pendingOrders:e.pendingOrders}))))),this.getInviteInfo=e=>this.fetch(this.url("GetInviteInfo"),S({},e)).then((e=>I(e).then((e=>({inviteInfo:e.inviteInfo}))))),this.isValidAccessCode=(e,t)=>this.fetch(this.url("IsValidAccessCode"),S(e,t)).then((e=>I(e).then((e=>({status:e.status}))))),this.internalClaimAccessCode=(e,t)=>this.fetch(this.url("InternalClaimAccessCode"),S(e,t)).then((e=>I(e).then((e=>({status:e.status}))))),this.walletRecover=(e,t)=>this.fetch(this.url("WalletRecover"),S(e,t)).then((e=>I(e).then((e=>({encryptedWallet:e.encryptedWallet}))))),this.blockNumberAtTime=(e,t)=>this.fetch(this.url("BlockNumberAtTime"),S(e,t)).then((e=>I(e).then((e=>({blocks:e.blocks}))))),this.hostname=e,this.fetch=(e,n)=>t(e,n)}url(e){return this.hostname+this.path+e}}const S=(e={},t={})=>({method:"POST",headers:m({},t,{"Content-Type":"application/json"}),body:JSON.stringify(e||{})}),I=e=>e.text().then((t=>{let n;try{n=JSON.parse(t)}catch(n){throw{code:"unknown",msg:`expecting JSON, got: ${t}`,status:e.status}}if(!e.ok)throw n;return n}));class x extends k{constructor(e,t){super(e.endsWith("/")?e.slice(0,-1):e,n.g.fetch),this.jwtAuth=t,this._fetch=(e,t)=>{const s={};return this.jwtAuth&&this.jwtAuth.length>0&&(s.Authorization=`BEARER ${this.jwtAuth}`),t.headers=m({},t.headers,s),n.g.fetch(e,t)},this.fetch=this._fetch}}var T=n(1005),O=n(58549),N=n(29503),A=n(67640),P=n(59256),M=n(79378),R=n(4358),L=n(48834).Buffer;const U="function"==typeof atob,D="function"==typeof btoa,q="function"==typeof L,W="function"==typeof TextDecoder?new TextDecoder:void 0,B="function"==typeof TextEncoder?new TextEncoder:void 0,F=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),$=(e=>{let t={};return e.forEach(((e,n)=>t[e]=n)),t})(F),j=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,H=String.fromCharCode.bind(String),G="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):(e,t=(e=>e))=>new Uint8Array(Array.prototype.slice.call(e,0).map(t)),V=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),K=D?e=>btoa(e):q?e=>L.from(e,"binary").toString("base64"):e=>{let t,n,s,i,r="";const a=e.length%3;for(let a=0;a<e.length;){if((n=e.charCodeAt(a++))>255||(s=e.charCodeAt(a++))>255||(i=e.charCodeAt(a++))>255)throw new TypeError("invalid character found");t=n<<16|s<<8|i,r+=F[t>>18&63]+F[t>>12&63]+F[t>>6&63]+F[63&t]}return a?r.slice(0,a-3)+"===".substring(a):r},J=q?e=>L.from(e).toString("base64"):e=>{let t=[];for(let n=0,s=e.length;n<s;n+=4096)t.push(H.apply(null,e.subarray(n,n+4096)));return K(t.join(""))},Y=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?H(192|t>>>6)+H(128|63&t):H(224|t>>>12&15)+H(128|t>>>6&63)+H(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return H(240|t>>>18&7)+H(128|t>>>12&63)+H(128|t>>>6&63)+H(128|63&t)},z=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Q=q?e=>L.from(e,"utf8").toString("base64"):B?e=>J(B.encode(e)):e=>K(e.replace(z,Y)),Z=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,X=e=>{switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return H(55296+(t>>>10))+H(56320+(1023&t));case 3:return H((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return H((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},ee=U?e=>atob(V(e)):q?e=>L.from(e,"base64").toString("binary"):e=>{if(e=e.replace(/\s+/g,""),!j.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,n,s,i="";for(let r=0;r<e.length;)t=$[e.charAt(r++)]<<18|$[e.charAt(r++)]<<12|(n=$[e.charAt(r++)])<<6|(s=$[e.charAt(r++)]),i+=64===n?H(t>>16&255):64===s?H(t>>16&255,t>>8&255):H(t>>16&255,t>>8&255,255&t);return i},te=q?e=>G(L.from(e,"base64")):e=>G(ee(e),(e=>e.charCodeAt(0))),ne=q?e=>L.from(e,"base64").toString("utf8"):W?e=>W.decode(te(e)):e=>ee(e).replace(Z,X),se=(e,t=!1)=>t?(e=>e.replace(/=/g,"").replace(/[+\/]/g,(e=>"+"==e?"-":"_")))(Q(e)):Q(e),ie=e=>ne(V(e.replace(/[-_]/g,(e=>"-"==e?"+":"/"))));var re=function(){return re=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},re.apply(this,arguments)};function ae(e,t,n,s){return new(n||(n=Promise))((function(i,r){function a(e){try{c(s.next(e))}catch(e){r(e)}}function o(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((s=s.apply(e,t||[])).next())}))}function oe(e,t){var n,s,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,o[0]&&(a=0)),a;)try{if(n=1,s&&(i=2&o[0]?s.return:o[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,o[1])).done)return i;switch(s=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,s=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],s=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}var ce=function(){function e(e){this.prefix=ge,this.address=(null==e?void 0:e.address)?e.address.toLowerCase():"",this.claims=(null==e?void 0:e.claims)?e.claims:{app:"",iat:0,exp:0,v:pe},this.signature=(null==e?void 0:e.signature)?e.signature:"",this.extra=(null==e?void 0:e.extra)?e.extra:""}return e.prototype.setIssuedAtNow=function(){this.claims.iat=Math.round((new Date).getTime()/1e3)},e.prototype.setExpiryIn=function(e){this.claims.exp=Math.round((new Date).getTime()/1e3)+e},e.prototype.validateClaims=function(){return le(this.claims)},e.prototype.messageDigest=function(){var e,t=this.validateClaims();if(t.err)throw t.err;return A.arrayify((e=this.messageTypedData(),M.E.hash(e.domain,e.types,e.message)))},e.prototype.messageTypedData=function(){var e={domain:re({},fe),types:{Claims:[]},message:{}};return this.claims.app&&this.claims.app.length>0&&(e.types.Claims.push({name:"app",type:"string"}),e.message.app=this.claims.app),this.claims.iat&&this.claims.iat>0&&(e.types.Claims.push({name:"iat",type:"int64"}),e.message.iat=this.claims.iat),this.claims.exp&&this.claims.exp>0&&(e.types.Claims.push({name:"exp",type:"int64"}),e.message.exp=this.claims.exp),this.claims.n&&this.claims.n>0&&(e.types.Claims.push({name:"n",type:"uint64"}),e.message.n=this.claims.n),this.claims.typ&&this.claims.typ.length>0&&(e.types.Claims.push({name:"typ",type:"string"}),e.message.typ=this.claims.typ),this.claims.ogn&&this.claims.ogn.length>0&&(e.types.Claims.push({name:"ogn",type:"string"}),e.message.ogn=this.claims.ogn),this.claims.v&&this.claims.v.length>0&&(e.types.Claims.push({name:"v",type:"string"}),e.message.v=this.claims.v),e},e}(),le=function(e){if(""===e.app)return{ok:!1,err:new Error("claims: app is empty")};var t=Math.round((new Date).getTime()/1e3),n=31536300;return""===e.v?{ok:!1,err:new Error("claims: ethauth version is empty")}:e.iat&&0!==e.iat&&(e.iat>t+300||e.iat<t-n)?{ok:!1,err:new Error("claims: iat is invalid")}:e.exp<t-300||e.exp>t+n?{ok:!1,err:new Error("claims: token has expired")}:{ok:!0}},he=function(e,t,n){return ae(void 0,void 0,void 0,(function(){var e,t;return oe(this,(function(s){return e=n.messageDigest(),"0x"===(t=R.verifyMessage(e,n.signature)).slice(0,2)&&42===t.length&&t.toLowerCase()===n.address.toLowerCase()?[2,{isValid:!0,address:n.address}]:[2,{isValid:!1}]}))}))},de=function(e,t,n){return ae(void 0,void 0,void 0,(function(){var t,s,i;return oe(this,(function(r){switch(r.label){case 0:return e&&void 0!==e?(t=n.messageDigest(),[4,e.getCode(n.address)]):[2,{isValid:!1}];case 1:if("0x"===(s=r.sent())||s.length<=2)throw new Error("ValidateContractAccountProof failed. unable to fetch wallet contract code");return i=["function isValidSignature(bytes32, bytes) public view returns (bytes4)"],[4,new N.CH(n.address,i,e).isValidSignature(t,A.arrayify(n.signature))];case 2:return r.sent()===ue?[2,{isValid:!0,address:n.address}]:[2,{isValid:!1}]}}))}))},ue="0x1626ba7e",pe="1",ge="eth",fe={name:"ETHAuth",version:pe},we=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this;this.configJsonRpcProvider=function(e){return ae(n,void 0,void 0,(function(){var t;return oe(this,(function(n){switch(n.label){case 0:return this.provider=new T.r(e),[4,this.provider.send("net_version",[])];case 1:if(t=n.sent(),this.chainId=parseInt(t),!this.chainId||0===this.chainId||NaN===this.chainId)throw new Error("ethauth: unable to get chainId");return this.ethereumJsonRpcURL=e,[2]}}))}))},this.configValidators=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0==e.length)throw new Error("validators list is empty");n.validators=e},this.encodeProof=function(e,t){return void 0===t&&(t=!1),ae(n,void 0,void 0,(function(){var n,s;return oe(this,(function(i){switch(i.label){case 0:if(42!==e.address.length||"0x"!==e.address.slice(0,2))throw new Error("ethauth: invalid address");if(""===e.signature||"0x"!==e.signature.slice(0,2))throw new Error("ethauth: invalid signature");if(e.extra&&"0x"!==e.extra.slice(0,2))throw new Error("ethauth: invalid extra encoding, expecting hex data");return[4,this.validateProof(e,t)];case 1:if(!i.sent())throw new Error("ethauth: proof is invalid");return n=JSON.stringify(e.claims),s=ge+"."+e.address.toLowerCase()+"."+se(n,!0)+"."+e.signature,e.extra&&e.extra.length>0&&(s+="."+e.extra),[2,s]}}))}))},this.decodeProof=function(e,t){return void 0===t&&(t=!1),ae(n,void 0,void 0,(function(){var n,s,i,r,a,o,c,l,h;return oe(this,(function(d){switch(d.label){case 0:if((n=e.split(".")).length<4||n.length>5)throw new Error("ethauth: invalid proof string");if(s=n[0],i=n[1],r=n[2],a=n[3],o=n[4],s!==ge)throw new Error("ethauth: not an ethauth proof");return c=ie(r),l=JSON.parse(c),h=new ce({address:i,claims:l,signature:a,extra:o}),[4,this.validateProof(h,t)];case 1:if(!d.sent())throw new Error("ethauth: proof is invalid");return[2,h]}}))}))},this.validateProof=function(e,t){return void 0===t&&(t=!1),ae(n,void 0,void 0,(function(){var n;return oe(this,(function(s){switch(s.label){case 0:if((n=this.validateProofClaims(e)).err)throw new Error("ethauth: proof claims are invalid ".concat(n.err));return!0===t?[3,2]:[4,this.validateProofSignature(e)];case 1:if(!0!==s.sent())throw new Error("ethauth: proof signature is invalid");s.label=2;case 2:return[2,!0]}}))}))},this.validateProofSignature=function(e){return ae(n,void 0,void 0,(function(){var t,n,s;return oe(this,(function(i){switch(i.label){case 0:t=[],s=0,i.label=1;case 1:if(!(s<this.validators.length))return[3,6];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,(0,this.validators[s])(this.provider,this.chainId,e)];case 3:return!0===(n=i.sent().isValid)?[2,!0]:(t.push(n),[3,5]);case 4:return i.sent(),t.push(!1),[3,5];case 5:return s++,[3,1];case 6:for(s=0;s<t.length;s++)if(t[s])return[2,!0];return[2,!1]}}))}))},this.validateProofClaims=function(e){return e.validateClaims()},0==e.length?this.validators=[he,de]:this.validators=e},me=n(10196),ye=n(10528),ve=n(90711),be=n(41731),Ce=n(99780),Ee=n(88210),_e=n(13390),ke=n(2222),Se=n(95958),Ie=n(34406);const xe=e=>se(e,!0),Te=e=>se(JSON.stringify(e),!0),Oe=e=>{if(null!=e)return ie(e)},Ne=e=>{if(null!=e)return JSON.parse(ie(e))},Ae=e=>"string"==typeof e?A.arrayify(P.keccak256(ke.Y0(e))):A.arrayify(P.keccak256(e)),Pe=(e,t,n)=>be.pack(["string","uint256","address","bytes32"],["",t,e,n]),Me=(e,t,n)=>P.keccak256(Pe(e,t,n)),Re=()=>"undefined"==typeof window&&"object"==typeof Ie,Le=()=>!Re(),Ue=e=>{const t=e.split(".");if(3!==t.length)throw new Error("invalid jwt");return JSON.parse(ie(t[1]))};function De(){return De=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},De.apply(this,arguments)}var qe;!function(e){e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.DISABLED=5]="DISABLED"}(qe||(qe={}));class We{constructor(e){this.config=e,this.logLevel=void 0,this.configure(e)}configure(e){switch(this.config=De({},this.config,e),this.config.logLevel){case"DEBUG":this.logLevel=qe.DEBUG;break;case"INFO":default:this.logLevel=qe.INFO;break;case"WARN":this.logLevel=qe.WARN;break;case"ERROR":this.logLevel=qe.ERROR;break;case"DISABLED":this.logLevel=qe.DISABLED}void 0===this.config.silence&&(this.config.silence=!1)}debug(e,...t){!0!==this.config.silence&&this.logLevel===qe.DEBUG&&console.log(e,...t)}info(e,...t){!0!==this.config.silence&&this.logLevel<=qe.INFO&&console.log(e,...t)}warn(e,...t){!0!==this.config.silence&&this.logLevel<=qe.WARN&&(console.warn(e,...t),this.config.onwarn&&this.config.onwarn(e,t))}error(e,...t){!0!==this.config.silence&&this.logLevel<=qe.ERROR&&(console.error(e,...t),this.config.onerror&&this.config.onerror(e,t))}}const Be=new We({logLevel:"INFO",silence:!0}),Fe=e=>Be.configure(e);function $e(e,t){return function(...n){const s=Array.prototype.slice.call(n);return new Promise((async(n,i)=>{try{s.push(((e,t)=>e?i(e):n(t))),await e.apply(t,s)}catch(e){i(e)}}))}}const je=(e=0,t=Number.MAX_SAFE_INTEGER)=>(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e);function He(e,t){return`${encodeURIComponent(e)}=${encodeURIComponent(JSON.stringify(t))}`}function Ge(e){const t=e.split("&"),n={};for(const e of t){const t=e.split("=");n[decodeURIComponent(t[0])]=JSON.parse(decodeURIComponent(t[1]))}return n}const Ve=e=>{if(!e||"string"!=typeof e)return"";const t=e.match(/[\d.]+/);return t&&t.length>0?t[0].trim():""},Ke=e=>{if(!e||"string"!=typeof e)return"";const t=e.match(/[\w\s\d]+/);return t&&t.length>0?t[0].trim():""},Je=e=>{if(!e||"string"!=typeof e)return"";const t=e.match(/[\w\d.\-:\/]+/);return t&&t.length>0?t[0].trim():""},Ye=e=>new Promise((t=>{const n=setTimeout((()=>{clearTimeout(n),t()}),e)})),ze=e=>{const t=De({},e.types);return delete t.EIP712Domain,M.E.hash(e.domain,t,e.message)},Qe=e=>A.arrayify(ze(e)),{defineReadOnly:Ze,getStatic:Xe,resolveProperties:et,checkProperties:tt,shallowCopy:nt,deepCopy:st}=Se,it=e=>e.replace(/([^:]\/)\/+/g,"$1");function rt(e){return null!=e&&(ye.O$.isBigNumber(e)||"number"==typeof e&&e%1==0||"string"==typeof e&&!!e.match(/^-?[0-9]+$/)||A.isHexString(e)||"bigint"==typeof e||A.isBytes(e))}var at=n(99268),ot=n(58171);function ct(){return ct=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ct.apply(this,arguments)}function lt(e){return e&&void 0!==e.chainId&&void 0!==e.name&&void 0!==e.rpcUrl&&void 0!==e.relayer}const ht=e=>"number"==typeof e?e:e.chainId?e.chainId:ye.O$.from(e).toNumber(),dt=e=>{if(e)return ht(e)},ut=e=>e.find((e=>e.isAuthChain)),pt=(e,t=!1,n=!1)=>{if(!e)throw new Error("invalid network config: empty config");const s=[];if(Array.isArray(e)?s.push(...e):s.push(e),0===s.length){if(t)throw new Error("invalid network config: empty config");return!1}const i=s.map((e=>e.chainId)).sort(),r=i.filter(((e,t)=>i.indexOf(e)!==t));if(r.length>0){if(t)throw new Error(`invalid network config: duplicate chainIds ${r}`);return!1}s.forEach((e=>e.name=e.name.toLowerCase()));const a=s.map((e=>e.name)).sort(),o=a.filter(((e,t)=>a.indexOf(e)!==t));if(o.length>0){if(t)throw new Error(`invalid network config: duplicate network names ${o}`);return!1}let c=!1,l=!1;for(let e=0;e<s.length;e++){const i=s[e];if(!(i.rpcUrl&&""!==i.rpcUrl||i.provider)){if(t)throw new Error(`invalid network config for chainId ${i.chainId}: rpcUrl or provider must be provided`);return!1}if(!n&&!i.relayer){if(t)throw new Error(`invalid network config for chainId ${i.chainId}: relayer must be provided`);return!1}if(i.isDefaultChain){if(c){if(t)throw new Error(`invalid network config for chainId ${i.chainId}: DefaultChain is already set by another config`);return!1}c=!0}if(i.isAuthChain){if(l&&t)throw new Error(`invalid network config for chainId ${i.chainId}: AuthChain is already set by another config`);l=!0}}if(!c){if(t)throw new Error("invalid network config: DefaultChain must be set");return!1}if(!l){if(t)throw new Error("invalid network config: AuthChain must be set");return!1}return!0},gt=(e,t=!1)=>(pt(e,!0,t),e),ft=(e,t=!0)=>{const n=e.map((e=>e.chainId)).sort(),s=n.filter(((e,t)=>n.indexOf(e)!==t));if(s.length>0){if(t)throw new Error(`invalid network config: duplicate chainIds ${s}`);return!1}return!0},wt=(e,t)=>{if(e&&t){if(!e.chainId&&!e.name)throw new Error("failed to update network config: source config is missing chainId or name");if(e.chainId!==t.chainId&&e.name!==t.name)throw new Error("failed to update network config: one of chainId or name must match");e.rpcUrl&&(t.rpcUrl=e.rpcUrl,t.provider=void 0),e.provider&&(t.provider=e.provider),e.relayer&&(t.relayer=e.relayer)}},mt=e=>gt(Ct(e)),yt=(e,t)=>{if("string"==typeof t){if(t.startsWith("0x")){const n=ye.O$.from(t).toNumber();return e.find((e=>e.chainId===n))}return e.find((e=>e.name===t))}return"number"==typeof t?e.find((e=>e.chainId===t)):t.chainId?e.find((e=>e.chainId===t.chainId)):void 0},vt=(e,t)=>!!e&&(e.name===t||e.chainId===t),bt=e=>{const t={};for(let n=0;n<e.length;n++)t[e[n].name]=e[n];return t},Ct=e=>{if(!e)return[];const t=e.sort(((e,t)=>e.chainId===t.chainId?0:e.chainId<t.chainId?-1:1)),n=t.findIndex((e=>e.isDefaultChain));n>0&&t.splice(0,0,t.splice(n,1)[0]);const s=t.findIndex((e=>e.isAuthChain&&!0!==e.isDefaultChain));return s>0&&t.splice(1,0,t.splice(s,1)[0]),t},Et=(e,t)=>"string"==typeof e?(t=t||{},e.replace(/\$\{\s*([$#@\-\d\w]+)\s*\}/gim,(function(e,n){let s=t[n];return s="function"==typeof s?s():null==s?"":"object"==typeof s||"symbol"==typeof s?s.toString():s.valueOf(),s}))):"";let _t;var kt;(kt=_t||(_t={}))[kt.MAINNET=1]="MAINNET",kt[kt.ROPSTEN=3]="ROPSTEN",kt[kt.RINKEBY=4]="RINKEBY",kt[kt.GOERLI=5]="GOERLI",kt[kt.KOVAN=42]="KOVAN",kt[kt.POLYGON=137]="POLYGON",kt[kt.POLYGON_MUMBAI=80001]="POLYGON_MUMBAI",kt[kt.BSC=56]="BSC",kt[kt.BSC_TESTNET=97]="BSC_TESTNET",kt[kt.OPTIMISM=10]="OPTIMISM",kt[kt.OPTIMISM_TESTNET=69]="OPTIMISM_TESTNET",kt[kt.ARBITRUM=42161]="ARBITRUM",kt[kt.ARBITRUM_TESTNET=421611]="ARBITRUM_TESTNET",kt[kt.ARBITRUM_NOVA=42170]="ARBITRUM_NOVA",kt[kt.AVALANCHE=43114]="AVALANCHE",kt[kt.AVALANCHE_TESTNET=43113]="AVALANCHE_TESTNET",kt[kt.FANTOM=250]="FANTOM",kt[kt.FANTOM_TESTNET=4002]="FANTOM_TESTNET",kt[kt.GNOSIS=100]="GNOSIS",kt[kt.AURORA=1313161554]="AURORA",kt[kt.AURORA_TESTNET=1313161556]="AURORA_TESTNET";const St=e=>Et("https://${network}-indexer.sequence.app",{network:e}),It=e=>Et("https://${network}-relayer.sequence.app",{network:e}),xt=e=>Et("https://nodes.sequence.app/${network}",{network:e}),Tt={[_t.MAINNET]:{chainId:_t.MAINNET,name:"mainnet",title:"Ethereum",blockExplorer:{name:"Etherscan",rootUrl:"https://etherscan.io/"}},[_t.ROPSTEN]:{chainId:_t.ROPSTEN,name:"ropsten",title:"Ropsten",testnet:!0,blockExplorer:{name:"Etherscan (Ropsten)",rootUrl:"https://ropsten.etherscan.io/"}},[_t.RINKEBY]:{chainId:_t.RINKEBY,name:"rinkeby",title:"Rinkeby",testnet:!0,blockExplorer:{name:"Etherscan (Rinkeby)",rootUrl:"https://rinkeby.etherscan.io/"},disabled:!0},[_t.GOERLI]:{chainId:_t.GOERLI,name:"goerli",title:"Goerli",testnet:!0,blockExplorer:{name:"Etherscan (Goerli)",rootUrl:"https://goerli.etherscan.io/"}},[_t.KOVAN]:{chainId:_t.KOVAN,name:"kovan",title:"Kovan",testnet:!0,blockExplorer:{name:"Etherscan (Kovan)",rootUrl:"https://kovan.etherscan.io/"}},[_t.POLYGON]:{chainId:_t.POLYGON,name:"polygon",title:"Polygon",blockExplorer:{name:"Polygonscan",rootUrl:"https://polygonscan.com/"}},[_t.POLYGON_MUMBAI]:{chainId:_t.POLYGON_MUMBAI,name:"mumbai",title:"Polygon Mumbai",testnet:!0,blockExplorer:{name:"Polygonscan (Mumbai)",rootUrl:"https://mumbai.polygonscan.com/"}},[_t.BSC]:{chainId:_t.BSC,name:"bsc",title:"BNB Smart Chain",blockExplorer:{name:"BSCScan",rootUrl:"https://bscscan.com/"}},[_t.BSC_TESTNET]:{chainId:_t.BSC_TESTNET,name:"bsc-testnet",title:"BNB Smart Chain Testnet",testnet:!0,blockExplorer:{name:"BSCScan (Testnet)",rootUrl:"https://testnet.bscscan.com/"}},[_t.OPTIMISM]:{chainId:_t.OPTIMISM,name:"optimism",title:"Optimism",blockExplorer:{name:"Etherscan (Optimism)",rootUrl:"https://optimistic.etherscan.io/"}},[_t.OPTIMISM_TESTNET]:{chainId:_t.OPTIMISM_TESTNET,name:"optimism-testnet",title:"Optimistic Kovan",testnet:!0,blockExplorer:{name:"Etherscan (Optimism Testnet)",rootUrl:"https://kovan-optimistic.etherscan.io/"}},[_t.ARBITRUM]:{chainId:_t.ARBITRUM,name:"arbitrum",title:"Arbitrum One",blockExplorer:{name:"Arbiscan",rootUrl:"https://arbiscan.io/"}},[_t.ARBITRUM_TESTNET]:{chainId:_t.ARBITRUM_TESTNET,name:"arbitrum-testnet",title:"Arbitrum Testnet",testnet:!0,blockExplorer:{name:"Arbiscan (Testnet)",rootUrl:"https://testnet.arbiscan.io/"}},[_t.ARBITRUM_NOVA]:{chainId:_t.ARBITRUM_NOVA,name:"arbitrum-nova",title:"Arbitrum Nova",blockExplorer:{name:"Nova Explorer",rootUrl:"https://nova-explorer.arbitrum.io/"}},[_t.AVALANCHE]:{chainId:_t.AVALANCHE,name:"avalanche",title:"Avalanche",blockExplorer:{name:"Snowtrace",rootUrl:"https://snowtrace.io/"}},[_t.AVALANCHE_TESTNET]:{chainId:_t.AVALANCHE_TESTNET,name:"avalanche-testnet",title:"Avalanche Testnet",testnet:!0,blockExplorer:{name:"Snowtrace (Testnet)",rootUrl:"https://testnet.snowtrace.io/"}},[_t.FANTOM]:{chainId:_t.FANTOM,name:"fantom",title:"Fantom",blockExplorer:{name:"FTMScan",rootUrl:"https://ftmscan.com/"}},[_t.FANTOM_TESTNET]:{chainId:_t.FANTOM_TESTNET,name:"fantom-testnet",title:"Fantom Testnet",testnet:!0,blockExplorer:{name:"FTMScan (Testnet)",rootUrl:"https://testnet.ftmscan.com/"}},[_t.GNOSIS]:{chainId:_t.GNOSIS,name:"gnosis",title:"Gnosis Chain",blockExplorer:{name:"Gnosis Chain Explorer",rootUrl:"https://blockscout.com/xdai/mainnet/"}},[_t.AURORA]:{chainId:_t.AURORA,name:"aurora",title:"Aurora",blockExplorer:{name:"Aurora Explorer",rootUrl:"https://aurorascan.dev/"}},[_t.AURORA_TESTNET]:{chainId:_t.AURORA_TESTNET,name:"aurora-testnet",title:"Aurora Testnet",blockExplorer:{name:"Aurora Explorer (Testnet)",rootUrl:"https://testnet.aurorascan.dev/"}}},Ot=mt([ct({},Tt[_t.MAINNET],{rpcUrl:xt("mainnet"),relayer:{url:It("mainnet")},indexerUrl:St("mainnet")}),ct({},Tt[_t.POLYGON],{rpcUrl:xt("polygon"),relayer:{url:It("polygon")},indexerUrl:St("polygon"),isDefaultChain:!0,isAuthChain:!0}),ct({},Tt[_t.BSC],{rpcUrl:xt("bsc"),indexerUrl:St("bsc"),relayer:{url:It("bsc")}}),ct({},Tt[_t.AVALANCHE],{rpcUrl:xt("avalanche"),indexerUrl:St("avalanche"),relayer:{url:It("avalanche")}}),ct({},Tt[_t.ARBITRUM],{rpcUrl:xt("arbitrum"),indexerUrl:St("arbitrum"),relayer:{url:It("arbitrum")}}),ct({},Tt[_t.ARBITRUM_NOVA],{rpcUrl:xt("arbitrum-nova"),indexerUrl:St("arbitrum-nova"),relayer:{url:It("arbitrum-nova")}}),ct({},Tt[_t.OPTIMISM],{rpcUrl:xt("optimism"),indexerUrl:St("optimism"),relayer:{url:It("optimism")}})]),Nt=mt([ct({},Tt[_t.RINKEBY],{rpcUrl:xt("rinkeby"),relayer:{url:It("rinkeby")},indexerUrl:St("rinkeby")}),ct({},Tt[_t.GOERLI],{rpcUrl:xt("goerli"),relayer:{url:It("goerli")},indexerUrl:St("goerli")}),ct({},Tt[_t.POLYGON_MUMBAI],{rpcUrl:xt("mumbai"),relayer:{url:It("mumbai")},indexerUrl:St("mumbai"),isDefaultChain:!0,isAuthChain:!0}),ct({},Tt[_t.BSC_TESTNET],{rpcUrl:xt("bsc-testnet"),relayer:{url:It("bsc-testnet")},indexerUrl:St("bsc-testnet")})]),At={factory:"0xf9D09D634Fb818b05149329C1dcCFAeA53639d96",mainModule:"0xd01F11855bCcb95f88D7A48492F66410d4637313",mainModuleUpgradable:"0x7EFE6cE415956c5f80C6530cC6cc81b4808F6118",guestModule:"0x02390F3E6E5FD1C6786CB78FD3027C117a9955A7",sequenceUtils:"0xd130B43062D875a4B7aF3f8fc036Bc6e9D3E1B3E",libs:{requireFreshSigner:"0xE6B9B21C077F382333220a072e4c44280b873907"}},Pt="2.0";class Mt{constructor(e,t){this.sender=void 0,this.handler=void 0,this.sender=t,e&&this.setMiddleware(e)}setMiddleware(e){this.handler=Rt(e,this.sender.sendAsync)}sendAsync(e,t,n){try{this.handler(e,t,n)}catch(e){t(e,void 0)}}}const Rt=(e,t)=>{if(0===e.length)return t;const n=e=>e.sendAsyncMiddleware?e.sendAsyncMiddleware:e;let s;s=n(e[e.length-1])(t);for(let t=e.length-2;t>=0;t--)s=n(e[t])(s);return s};function Lt(e){return void 0!==e&&void 0!==e.send&&void 0!==e.constructor.defaultUrl&&void 0!==e.detectNetwork&&void 0!==e.getSigner&&void 0!==e.perform}function Ut(e){return void 0!==e&&void 0!==e.sendAsync}let Dt=0;class qt{constructor(e,t){this.send=void 0,this.request=void 0,this.defaultChainId=void 0,this.sendAsync=(e,t,n)=>{this.send(e.method,e.params,n||this.defaultChainId).then((n=>{t(void 0,{jsonrpc:"2.0",id:e.id,result:n})})).catch((e=>{t(e,void 0)}))},this.defaultChainId=t,Lt(e)?this.send=e.send.bind(e):Ut(e)?this.send=(t,n,s)=>new Promise(((i,r)=>{e.sendAsync({jsonrpc:Pt,id:++Dt,method:t,params:n},((e,t)=>{e?r(e):i(t?t.result:void 0)}),s||this.defaultChainId)})):this.send=e,this.request=(e,t)=>this.send(e.method,e.params,t)}}class Wt{constructor(e){this.provider=e,this.sendAsync=(e,t)=>{this.provider.send(e.method,e.params).then((n=>{t(void 0,{jsonrpc:"2.0",id:e.id,result:n})})).catch((e=>{t(e,void 0)}))},this.send=this.sendAsync}}class Bt{constructor(e){this.sendAsyncMiddleware=void 0,this.isAllowedFunc=void 0,this.isAllowedFunc=e||(e=>!0),this.sendAsyncMiddleware=Ft(this.isAllowedFunc)}setIsAllowedFunc(e){this.isAllowedFunc=e,this.sendAsyncMiddleware=Ft(this.isAllowedFunc)}}const Ft=e=>t=>(n,s,i)=>{if(!e(n))throw new Error("allowProvider middleware precondition is unmet.");t(n,s,i)};class $t{constructor(e){this.cachableJsonRpcMethods=["net_version","eth_chainId","eth_accounts","sequence_getWalletContext","sequence_getNetworks"],this.cache=void 0,this.onUpdateCallback=void 0,this.defaultChainId=void 0,this.sendAsyncMiddleware=e=>(t,n,s)=>{if(this.cachableJsonRpcMethods.includes(t.method)){const e=this.cacheKey(t.method,t.params,s||this.defaultChainId),i=this.getCacheValue(e);if(i&&""!==i)return void n(void 0,{jsonrpc:"2.0",id:t.id,result:i})}e(t,((e,s,i)=>{if(this.cachableJsonRpcMethods.includes(t.method)&&s&&s.result){const e=this.cacheKey(t.method,t.params,i||this.defaultChainId);this.setCacheValue(e,s.result)}n(e,s)}),s||this.defaultChainId)},this.cacheKey=(e,t,n)=>{let s="";return s=n?`${n}:${e}:`:`:${e}:`,t&&0!==t.length?s+JSON.stringify(t):s+"[]"},this.getCache=()=>this.cache,this.setCache=e=>{this.cache=e,this.onUpdateCallback&&this.onUpdateCallback()},this.getCacheValue=e=>this.cache[e],this.setCacheValue=(e,t)=>{this.cache[e]=t,this.onUpdateCallback&&this.onUpdateCallback(e,t)},this.clearCache=()=>{this.cache={}},this.cache={},this.defaultChainId=e}onUpdate(e){this.onUpdateCallback=e}}class jt{constructor(e){this.props=void 0,this.sendAsyncMiddleware=e=>(t,n,s)=>{const{id:i,method:r}=t;switch(r){case"net_version":if(this.props.chainId)return void n(void 0,{jsonrpc:"2.0",id:i,result:`${this.props.chainId}`});break;case"eth_chainId":if(this.props.chainId)return void n(void 0,{jsonrpc:"2.0",id:i,result:A.hexlify(this.props.chainId)});break;case"eth_accounts":if(this.props.accountAddress)return void n(void 0,{jsonrpc:"2.0",id:i,result:[O.getAddress(this.props.accountAddress)]});break;case"sequence_getWalletContext":if(this.props.walletContext)return void n(void 0,{jsonrpc:"2.0",id:i,result:this.props.walletContext})}e(t,n,s)},this.props=e}}const Ht=e=>(t,n,s)=>{e(t,((e,t)=>{if(!e&&t&&t.error)throw"string"==typeof t.error?new Error(t.error):new Error(t.error.message);n(e,t)}),s)},Gt=e=>(t,n,s)=>{const i=s?` chainId:${s}`:"";Be.info(`[provider request]${i} id:${t.id} method:${t.method} params:`,t.params),e(t,((e,s)=>{e?Be.warn(`[provider response]${i} id:${t.id} method:${t.method} params:`,t.params,"error:",e):Be.info(`[provider response]${i} id:${t.id} method:${t.method} params:`,t.params,"response:",s),n(e,s)}),s)},Vt=e=>t=>(n,s,i)=>{const r=e(n),{id:a,method:o}=n;switch(o){case"net_version":return void s(void 0,{jsonrpc:"2.0",id:a,result:`${r}`});case"eth_chainId":return void s(void 0,{jsonrpc:"2.0",id:a,result:A.hexlify(r)})}t(n,s,i)},Kt=["personal_sign","eth_sign","eth_signTypedData","eth_signTypedData_v4","eth_sendTransaction","eth_sendRawTransaction","sequence_getWalletContext","sequence_getWalletConfig","sequence_getWalletState","sequence_getNetworks","sequence_updateConfig","sequence_publishConfig","sequence_gasRefundOptions","sequence_getNonce","sequence_relay","eth_decrypt","eth_getEncryptionPublicKey","wallet_addEthereumChain","wallet_switchEthereumChain","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"];class Jt{constructor(e){this.provider=void 0,this.sendAsyncMiddleware=e=>(t,n,s)=>{Kt.includes(t.method)?this.provider.sendAsync(t,n,s):e(t,n,s)},this.provider=e}}class Yt{constructor(e){this.privateJsonRpcMethods=["net_version","eth_chainId","eth_accounts",...Kt],this.provider=void 0,this.rpcUrl=void 0,this.sendAsyncMiddleware=e=>(t,n)=>{!this.provider||this.privateJsonRpcMethods.includes(t.method)?(Be.debug("[public-provider] sending request to signer window",t.method),e(t,n)):this.provider.send(t.method,t.params).then((e=>{n(void 0,{jsonrpc:"2.0",id:t.id,result:e})})).catch((e=>n(e)))},e&&this.setRpcUrl(e)}getRpcUrl(){return this.rpcUrl}setRpcUrl(e){e&&""!==e?(this.rpcUrl=e,this.provider=new T.r(e)):(this.rpcUrl=void 0,this.provider=void 0)}}function zt(){return zt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},zt.apply(this,arguments)}let Qt;function Zt(e,t){return e.reduce((function(e,n,s){return t(n,s)?e[0].push(n):e[1].push(n),e}),[[],[]])}!function(e){e.ethCall="eth_call",e.ethGetBalance="eth_getBalance",e.ethGetCode="eth_getCode"}(Qt||(Qt={}));const Xt={batchSize:50,timeWindow:50,contract:At.sequenceUtils,verbose:!1};class en{constructor(e){var t=this;if(this.batchableJsonRpcMethods=[Qt.ethCall,Qt.ethGetCode,Qt.ethGetBalance],this.multicallInterface=new at.vU(w.sequenceUtils.abi),this.options=void 0,this.timeout=void 0,this.queue=[],this.scheduleExecution=()=>{this.queue.length>0&&(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(this.run,this.options.timeWindow))},this.handle=(e,t,n)=>this.batchableJsonRpcMethods.find((e=>e===t.method))?(this.queue.push({request:t,callback:n,next:e}),this.options.verbose&&console.log("Scheduling call",t.method),void this.scheduleExecution()):(this.options.verbose&&console.log("Forwarded call",t.method),e(t,n)),this.run=async function(){t.options.verbose&&console.log("Processing multicall");const e=Math.min(t.options.batchSize,t.queue.length);if(0===e)return;if(1===e)return t.forward(t.queue[0]),t.queue=[],void(t.options.verbose&&console.log("Skip multicall, single item"));t.options.verbose&&console.log("Resolving",e);var n=t.queue.slice(0,e);t.queue=e===t.queue.length?[]:t.queue.slice(e),t.options.verbose&&console.log("Updated queue",t.queue.length),0!==t.queue.length&&t.scheduleExecution();const s=n[0].next;let i;var[n,r]=Zt(n,(e=>{try{if(e.next!==s)return!1;switch(e.request.method){case Qt.ethCall:if(e.request.params[0].from||e.request.params[0].gasPrice||e.request.params[0].value)return!1;case Qt.ethGetBalance:case Qt.ethGetCode:const s=function(e){if(void 0===e)return"latest";switch(e){case"earliest":case"latest":case"pending":return e}return ye.O$.from(e)}(e.request.params[1]);if(void 0===i&&(i=s),(t=s)!==(n=i)&&!(ye.O$.isBigNumber(t)?ye.O$.isBigNumber(n)&&t.eq(n):!ye.O$.isBigNumber(n)&&t===n))return!1}return!0}catch(e){return!1}var t,n}));if(0!==r.length&&(t.options.verbose&&console.log("Forwarding incompatible calls",r.length),t.forward(r),0===n.length))return;let a=n.map((e=>{try{switch(e.request.method){case Qt.ethCall:return{delegateCall:!1,revertOnError:!1,target:e.request.params[0].to,data:e.request.params[0].data,gasLimit:e.request.params[0].gas?e.request.params[0].gas:0,value:0};case Qt.ethGetCode:return{delegateCall:!1,revertOnError:!1,target:t.options.contract,gasLimit:0,value:0,data:t.multicallInterface.encodeFunctionData(t.multicallInterface.getFunction("callCode"),[e.request.params[0]])};case Qt.ethGetBalance:return{delegateCall:!1,revertOnError:!1,target:t.options.contract,gasLimit:0,value:0,data:t.multicallInterface.encodeFunctionData(t.multicallInterface.getFunction("callBalanceOf"),[e.request.params[0]])};default:return null}}catch(e){return null}}));var[n,r]=Zt(n,((e,t)=>void 0!==a[t]));if(a=a.filter((e=>e)),0!==r.length&&(t.options.verbose&&console.log("Forwarding calls on error",r.length),t.forward(r),0===n.length))return;let o;try{o=t.multicallInterface.encodeFunctionData(t.multicallInterface.getFunction("multiCall"),[a])}catch(e){return void t.forward(n)}const c=je(),l=await async function(e,t){try{return await e}catch(e){return t instanceof Function?t(e):t}}($e(s)({id:c,jsonrpc:Pt,method:Qt.ethCall,params:[{to:t.options.contract,value:0,data:o},ye.O$.isBigNumber(i)?i.toNumber():i]}),(e=>({jsonrpc:Pt,id:c,result:void 0,error:e})));if(l.error)return t.forward(n);let h;try{h=t.multicallInterface.decodeFunctionResult(t.multicallInterface.getFunction("multiCall"),l.result)}catch(e){return void t.forward(n)}t.options.verbose&&console.log("Got response for",n.length),n.forEach(((e,n)=>{if(h[0][n])switch(e.request.method){case Qt.ethCall:e.callback(void 0,{jsonrpc:e.request.jsonrpc,id:e.request.id,result:h[1][n]});break;case Qt.ethGetCode:e.callback(void 0,{jsonrpc:e.request.jsonrpc,id:e.request.id,result:Ce.$.decode(["bytes"],h[1][n])[0]});break;case Qt.ethGetBalance:e.callback(void 0,{jsonrpc:e.request.jsonrpc,id:e.request.id,result:Ce.$.decode(["uint256"],h[1][n])[0]})}else t.forward(e)}))},this.options=e?zt({},en.DefaultOptions,e):en.DefaultOptions,this.options.batchSize<=0)throw new Error(`Invalid batch size of ${this.options.batchSize}`)}forward(e){Array.isArray(e)?e.forEach((e=>e.next(e.request,e.callback))):e.next(e.request,e.callback)}static isMulticall(e){return e&&void 0!==e.handle&&void 0!==e.conf&&en.isMulticallOptions(e.options)}static isMulticallOptions(e){return void 0!==e&&void 0!==e.batchSize&&void 0!==e.timeWindow&&void 0!==e.contract}}en.DefaultOptions=zt({},Xt);const tn=["getNetwork","getBlockNumber","getGasPrice","getTransactionCount","getStorageAt","sendTransaction","estimateGas","getBlock","getTransaction","getTransactionReceipt","getLogs","emit","litenerCount","addListener","removeListener","waitForTransaction","detectNetwork","getBlockWithTransactions"];class nn extends ot.Zk{constructor(e,t){var n;super(e.getNetwork()),n=this,this.provider=e,this.multicall=void 0,this.listenerCount=this.provider.listenerCount,this.getResolver=async function(e){const t=n.provider;if(t.getResolver){const s=await t.getResolver(await e);return s?new ot.H2(n,s.address,s.name):null}return t.getResolver(await e)},this.next=async function(e,t){try{switch(e.method){case Qt.ethCall:n.callback(e,t,await n.provider.call(e.params[0],e.params[1]));break;case Qt.ethGetCode:n.callback(e,t,await n.provider.getCode(e.params[0],e.params[1]));break;case Qt.ethGetBalance:n.callback(e,t,await n.provider.getBalance(e.params[0],e.params[1]))}}catch(s){n.callback(e,t,void 0,s)}},this.multicall=en.isMulticall(t)?t:new en(t),tn.forEach((t=>{void 0!==e[t]&&(this[t]=(...n)=>e[t](...n))}))}callback(e,t,n,s){t(s,{jsonrpc:Pt,id:e.id,result:n,error:s})}async call(e,t){return this.rpcCall(Qt.ethCall,e,t)}async getCode(e,t){return this.rpcCall(Qt.ethGetCode,e,t)}async getBalance(e,t){return this.rpcCall(Qt.ethGetBalance,e,t)}async rpcCall(e,...t){const n=je();return(await $e(this.multicall.handle)(this.next,{jsonrpc:Pt,id:n,method:e,params:t})).result}}var sn=Object.freeze({__proto__:null,ProxyMethods:tn,MulticallProvider:nn,MulticallExternalProvider:class{constructor(e,t){if(this.provider=e,this.multicall=void 0,this.multicall=en.isMulticall(t)?t:new en(t),e.send){const t=async function(t,n){e.send(t,n)};this.send=(e,n)=>{this.multicall.handle(t,e,n)}}if(e.sendAsync){const t=async function(t,n){e.sendAsync(t,n)};this.sendAsync=(e,n)=>{this.multicall.handle(t,e,n)}}}get isMetaMask(){return this.provider.isMetaMask}get isStatus(){return this.provider.isStatus}},multicallMiddleware:e=>t=>{const n=en.isMulticall(e)?e:new en(e);return(e,s)=>n.handle(t,e,s)}});const rn="0x603a600e3d39601a805130553df3363d3d373d3d3d363d30545af43d82803e903d91601857fd5bf3",an="@sequence.config.imageHashes",on=e=>`@sequence.config.${e}`;let cn;try{cn=localStorage}catch(e){const t=new Map;cn={getItem:e=>{var n;return null!=(n=t.get(e))?n:null},setItem:(e,n)=>t.set(e,n),removeItem:e=>t.delete(e)}}function ln(e){var t;const n=JSON.parse(null!=(t=cn.getItem(on(e)))?t:"null");return n?(hn(e),n):void 0}function hn(e){var t;let n=JSON.parse(null!=(t=cn.getItem(an))?t:"[]");for(n=n.filter((t=>t!==e)),n.push(e);n.length>10;)cn.removeItem(on(n.shift()));cn.setItem(an,JSON.stringify(n))}const dn=async(e,t)=>{const n={threshold:e,signers:[]};if(t.forEach((async e=>{n.signers.push({weight:e.weight,address:me.E.isSigner(e.signer)?await e.signer.getAddress():e.signer})})),!un(n))throw new Error("wallet config is not usable");return n},un=e=>e.signers.reduce(((e,t)=>ye.O$.from(t.weight).add(e)),ve._Y).gte(ye.O$.from(e.threshold)),pn=(e,t)=>{if(0===t.length)return!0;const n=e.signers.map((e=>O.getAddress(e.address))),s=t.map((e=>O.getAddress(e)));let i=!0;return s.forEach((e=>{n.includes(e)||(i=!1)})),i},gn=(e,t,n=!1)=>{if("string"==typeof e){const n=P.keccak256(be.pack(["bytes","bytes32"],[rn,A.hexZeroPad(t.mainModule,32)])),s=P.keccak256(be.pack(["bytes1","address","bytes32","bytes32"],["0xff",t.factory,e,n]));return O.getAddress(A.hexDataSlice(s,12))}return e.address&&!n?e.address:gn(fn(e),t)},fn=e=>{const t=(e=wn(e)).signers.reduce(((e,t)=>P.keccak256(Ce.$.encode(["bytes32","uint8","address"],[e,t.weight,t.address]))),be.pack(["uint256"],[e.threshold]));return function(e,t){cn.setItem(on(e),JSON.stringify(t)),hn(e)}(t,e),t},wn=e=>{e.signers.sort(((e,t)=>yn(e.address,t.address))),e.signers.forEach((e=>e.address=O.getAddress(e.address))),e.address&&(e.address=O.getAddress(e.address));const t=e.signers.map((e=>e.address));if(t.filter(((e,n)=>t.indexOf(e)!==n)).length>0)throw new Error("invalid wallet config: duplicate signer addresses detected in the config, ${signerDupes}");return e},mn=(e,t)=>fn(e)===fn(t),yn=(e,t)=>{const n=ye.O$.from(e),s=ye.O$.from(t);return n.lt(s)?-1:n.eq(s)?0:1};function vn(e,t){const n=e=>({weight:ye.O$.from(e.weight).toNumber(),address:O.getAddress(e.address)}),s=e.signers.map(n),i=t.set?t.set.map(n):[],r=t.del?t.del.map((e=>O.getAddress(e.address))):[],a=i.map((e=>e.address)),o=s.filter((e=>-1===r.indexOf(e.address)&&-1===a.indexOf(e.address))).concat(...i);return wn({address:e.address,threshold:t.threshold?ye.O$.from(t.threshold).toNumber():e.threshold,signers:o})}function bn(e,t){return wn({threshold:ye.O$.from(e).toNumber(),signers:t.map((e=>({weight:ye.O$.from(e.weight).toNumber(),address:O.getAddress(e.address)})))})}class Cn{constructor(){this.findCurrentConfig=void 0,this.findLastWalletOfInitialSigner=void 0}}function En(){return En=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},En.apply(this,arguments)}class _n{constructor(e){var t=this;this.authProvider=e,this.findCurrentConfig=async function(e){const{provider:n,context:s,ignoreIndex:i,requireIndex:r,skipCache:a}=e,o=O.getAddress(e.address);if(Be.info(`[findCurrentConfig] address:${o}, ignoreIndex:${i}, requireIndex:${r}`),r&&i)throw Error("findCurrentConfig: can't ignore index and require index");const c=n.getNetwork(),l=e.knownConfigs?e.knownConfigs:[],{imageHash:h,config:d}=await t.findCurrentImageHash(s,n,o,l,a);if(void 0===h)return{config:void 0};const u=await t.findConfigForImageHash(s,h,d?[d,...l]:l,a),p=(await c).chainId;return{config:u?En({},u,{chainId:p,address:o}):void 0}},this.findLastWalletOfInitialSigner=async function(e){const{signer:n,context:s,ignoreIndex:i,requireIndex:r}=e;if(Be.info(`[findLastWalletOfInitialSigner] signer:${n}`),r&&i)throw Error("findCurrentConfig: can't ignore index and require index");const a=new N.CH(s.sequenceUtils,w.sequenceUtils.abi,t.authProvider),o=i?0:(await a.lastSignerUpdate(n)).toNumber();if(r&&0===o)return{wallet:void 0};const c=a.filters.RequiredSigner(null,n),l=await t.findLatestLog(t.authProvider,En({},c,{fromBlock:o,toBlock:0!==o?o:"latest"}));return void 0===l?(Be.warn("publishConfig: wallet config last log not found"),{wallet:void 0}):{wallet:a.interface.decodeEventLog("RequiredSigner",l.data,l.topics)._wallet}},this.findConfigForImageHash=async function(e,n,s=[],i=!1){const r=s.find((e=>fn(e)===n));if(r)return r;if(!i){const e=ln(n);if(e)return e}Be.info(`[findConfigForImageHash] image:${n}`);const a=new N.CH(e.sequenceUtils,w.sequenceUtils.abi,t.authProvider),o=(await a.lastImageHashUpdate(n)).toNumber(),c=a.filters.RequiredConfig(void 0,n),l=await t.findLatestLog(t.authProvider,En({},c,{fromBlock:o,toBlock:0!==o?o:"latest"}));if(void 0===l)return;const h=a.interface.decodeEventLog("RequiredConfig",l.data,l.topics),d=Ce.$.decode(["tuple(\n        uint256 weight,\n        address signer\n      )[]"],h._signers)[0],u={threshold:ye.O$.from(h._threshold).toNumber(),signers:d.map((e=>({address:e.signer,weight:ye.O$.from(e.weight).toNumber()})))};return fn(u),u},this.findCurrentImageHash=async function(e,n,s,i=[],r){Be.info(`[findCurrentImageHash] address:${s}`);const a=new N.CH(s,w.mainModuleUpgradable.abi,n),o=await a.functions.imageHash.call([]).catch((()=>[]));if(void 0!==o[0])return{imageHash:o[0],config:r?void 0:ln(o[0])};const c=O.getAddress(s),l=i.find((t=>gn(t,e,!0)===c));if(l)return{imageHash:fn(l),config:l};const h=new N.CH(e.sequenceUtils,w.sequenceUtils.abi,t.authProvider),d=await h.knownImageHashes(s);if(d!==Ee.R){if(gn(d,e)!==s)throw Error("findCurrentImageHash: inconsistent RequireUtils results");return{imageHash:d}}const u=h.filters.RequiredConfig(s),p=await t.findFirstLog(t.authProvider,u);if(void 0!==p){const t=h.interface.decodeEventLog("RequiredConfig",p.data,p.topics),n=Ce.$.decode(["tuple(\n          uint256 weight,\n          address signer\n        )[]"],t._signers)[0],i={threshold:ye.O$.from(t._threshold).toNumber(),signers:n.map((e=>({address:e.signer,weight:ye.O$.from(e.weight).toNumber()})))},r=fn(i);if(gn(r,e)===s)return{imageHash:r,config:i}}return{}},this.findLatestLog=async function(e,n){const s="latest"===n.toBlock?await e.getBlockNumber():n.toBlock,i=n.fromBlock;0===i&&Be.warn(`findLatestLog: expensive getLogs query fromBlock 0 toBlock ${s}`);try{const t=await e.getLogs(En({},n,{toBlock:s}));return 0===t.length?void 0:t[t.length-1]}catch(r){const a=Math.floor((s-i)/2+i),o=await t.findLatestLog(e,En({},n,{fromBlock:a,toBlock:s}));return void 0!==o?o:t.findLatestLog(e,En({},n,{fromBlock:i,toBlock:a}))}},this.findFirstLog=async function(e,n){const s="latest"!==n.toBlock&&n.toBlock?n.toBlock:await e.getBlockNumber(),i=n.fromBlock?n.fromBlock:0;0===i&&Be.warn(`findFirstLog: expensive getLogs query fromBlock 0 toBlock ${s}`);try{const t=await e.getLogs(En({},n,{fromBlock:i,toBlock:s}));return 0===t.length?void 0:t[0]}catch(r){const a=Math.floor((s-i)/2+i),o=await t.findFirstLog(e,En({},n,{fromBlock:i,toBlock:a}));return void 0!==o?o:t.findFirstLog(e,En({},n,{fromBlock:a,toBlock:s}))}}}}function kn(e){return void 0!==e.address&&!Sn(e)}function Sn(e){return In(e)||xn(e)||Tn(e)}function In(e){const t=e;return void 0!==t.signature&&void 0===t.address}function xn(e){const t=e;return void 0!==t.r&&void 0!==t.s&&void 0!==t.v&&void 0!==t.t}function Tn(e){const t=e;return void 0!==t.address&&void 0!==t.signature}let On;!function(e){e[e.EOA=0]="EOA",e[e.Address=1]="Address",e[e.Full=2]="Full"}(On||(On={}));const Nn=e=>{if("string"!=typeof e)return e;const t=e.replace("0x",""),n=ye.O$.from(`0x${t.slice(0,4)}`).toNumber(),s=[];for(let e=4;e<t.length;){const n=ye.O$.from(t.slice(e,e+2)).toNumber();e+=2;const i=ye.O$.from(`0x${t.slice(e,e+2)}`).toNumber();switch(e+=2,n){case On.Address:const n=O.getAddress(t.slice(e,e+40));e+=40,s.push({weight:i,address:n});break;case On.EOA:const r=A.arrayify(`0x${t.slice(e,e+132)}`);e+=132;const a=A.splitSignature(r.slice(0,65)),o=a.r,c=a.s,l=a.v,h=ye.O$.from(r[r.length-1]).toNumber();s.push({weight:i,signature:r,r:o,s:c,v:l,t:h});break;case On.Full:const d=O.getAddress(t.slice(e,e+40));e+=40;const u=ye.O$.from(`0x${t.slice(e,e+4)}`).mul(2).toNumber();e+=4;const p=A.arrayify(`0x${t.slice(e,e+u)}`);e+=u,s.push({weight:i,address:d,signature:p});break;default:throw Error("Signature type not supported")}}return{threshold:n,signers:s}},An=e=>{const t=A.arrayify(e.signature);return En({},e,A.splitSignature(t.slice(0,65)),{t:ye.O$.from(t[t.length-1]).toNumber()})},Pn=(e,t)=>{const n=xn(t)?t:An(t);switch(n.t){case 1:return _e.recoverAddress(e,{r:n.r,s:n.s,v:n.v});case 2:const t=P.keccak256(be.pack(["string","bytes32"],["Ethereum Signed Message:\n32",e]));return _e.recoverAddress(t,{r:n.r,s:n.s,v:n.v});default:throw new Error("Unknown signature")}},Mn=(...e)=>e.map((e=>"string"==typeof e?Nn(e):e)).reduce(((e,t)=>Rn(e,t))),Rn=(e,t)=>({threshold:e.threshold,signers:e.signers.map(((e,n)=>kn(e)?t.signers[n]:e))}),Ln=e=>{if("string"==typeof e)return Ln(Nn(e));const t=e.signers.map((e=>{if(kn(e))return be.pack(["uint8","uint8","address"],[On.Address,e.weight,e.address]);if(xn(e))return be.pack(["uint8","uint8","bytes32","bytes32","uint8","uint8"],[On.EOA,e.weight,e.r,e.s,e.v,e.t]);if(Tn(e)){const t=A.arrayify(e.signature).length;return be.pack(["uint8","uint8","address","uint16","bytes"],[On.Full,e.weight,e.address,t,e.signature])}if(In(e))return be.pack(["uint8","uint8","bytes"],[On.EOA,e.weight,e.signature]);throw Error("Unkwnown signature part type")}));return be.pack(["uint16",...Array(t.length).fill("bytes")],[e.threshold,...t])};function Un(e,t){if(kn(e))return e.address;if(Tn(e))return e.address;if(xn(e)||In(e))return Pn(t,e);throw Error("Unkwnown signature part type")}function Dn(e,t,n){const s=e.signers.map((e=>Un(e,n)));return{threshold:t.threshold,signers:t.signers.map((t=>{const n=s.indexOf(t.address);return-1!==n?En({},e.signers[n],{weight:t.weight}):{weight:t.weight,address:t.address}}))}}async function qn(e,t){const n=new sn.MulticallProvider(e);let s=(await Promise.all(t.signers.map((async(e,t)=>En({},e,{index:t,isEOA:0===A.arrayify(await n.getCode(e.address)).length}))))).sort(((e,t)=>e.weight-t.weight)),i=0;s=s.map((e=>i>=t.threshold||e.isEOA?e:(i+=e.weight,En({},e,{willSign:!0})))),i<t.threshold&&(s=s.map((e=>e.willSign||i>=t.threshold?e:(i+=e.weight,En({},e,{willSign:!0})))));const r=A.arrayify("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a01b02"),a=s.sort(((e,t)=>e.index-t.index));return{threshold:t.threshold,signers:a.map((e=>e.willSign?e.isEOA?{weight:e.weight,signature:r}:{weight:e.weight,address:e.address,signature:Ln({threshold:1,signers:[{address:R.Wallet.createRandom().address,weight:1},{weight:1,signature:r}]})+A.hexlify(3).substring(2)}:{address:e.address,weight:e.weight}))}}function Wn(){return Wn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Wn.apply(this,arguments)}const Bn="v1",Fn="v0.4.0",$n="7cdd11a44d6d1c5371dca8be8a603b1c67d53e22";let jn,Hn,Gn,Vn,Kn;!function(e){e.UNKNOWN="UNKNOWN",e.ERC20="ERC20",e.ERC721="ERC721",e.ERC1155="ERC1155",e.SEQUENCE_WALLET="SEQUENCE_WALLET",e.ERC20_BRIDGE="ERC20_BRIDGE",e.ERC721_BRIDGE="ERC721_BRIDGE",e.ERC1155_BRIDGE="ERC1155_BRIDGE"}(jn||(jn={})),function(e){e.UNKNOWN="UNKNOWN",e.BLOCK_ADDED="BLOCK_ADDED",e.BLOCK_REMOVED="BLOCK_REMOVED"}(Hn||(Hn={})),function(e){e.UNKNOWN="UNKNOWN",e.TOKEN_TRANSFER="TOKEN_TRANSFER",e.SEQUENCE_TXN="SEQUENCE_TXN"}(Gn||(Gn={})),function(e){e.UNKNOWN="UNKNOWN",e.SEND="SEND",e.RECEIVE="RECEIVE"}(Vn||(Vn={})),function(e){e.DESC="DESC",e.ASC="ASC"}(Kn||(Kn={}));class Jn{constructor(e,t){this.hostname=void 0,this.fetch=void 0,this.path="/rpc/Indexer/",this.ping=e=>this.fetch(this.url("Ping"),Yn({},e)).then((e=>zn(e).then((e=>({status:e.status}))))),this.version=e=>this.fetch(this.url("Version"),Yn({},e)).then((e=>zn(e).then((e=>({version:e.version}))))),this.runtimeStatus=e=>this.fetch(this.url("RuntimeStatus"),Yn({},e)).then((e=>zn(e).then((e=>({status:e.status}))))),this.getChainID=e=>this.fetch(this.url("GetChainID"),Yn({},e)).then((e=>zn(e).then((e=>({chainID:e.chainID}))))),this.getEtherBalance=(e,t)=>this.fetch(this.url("GetEtherBalance"),Yn(e,t)).then((e=>zn(e).then((e=>({balance:e.balance}))))),this.getTokenBalances=(e,t)=>this.fetch(this.url("GetTokenBalances"),Yn(e,t)).then((e=>zn(e).then((e=>({page:e.page,balances:e.balances}))))),this.getTokenSupplies=(e,t)=>this.fetch(this.url("GetTokenSupplies"),Yn(e,t)).then((e=>zn(e).then((e=>({page:e.page,contractType:e.contractType,tokenIDs:e.tokenIDs}))))),this.getTokenSuppliesMap=(e,t)=>this.fetch(this.url("GetTokenSuppliesMap"),Yn(e,t)).then((e=>zn(e).then((e=>({supplies:e.supplies}))))),this.getBalanceUpdates=(e,t)=>this.fetch(this.url("GetBalanceUpdates"),Yn(e,t)).then((e=>zn(e).then((e=>({page:e.page,balances:e.balances}))))),this.getTransactionHistory=(e,t)=>this.fetch(this.url("GetTransactionHistory"),Yn(e,t)).then((e=>zn(e).then((e=>({page:e.page,transactions:e.transactions}))))),this.syncBalance=(e,t)=>this.fetch(this.url("SyncBalance"),Yn(e,t)).then((e=>zn(e).then((e=>({}))))),this.hostname=e,this.fetch=(e,n)=>t(e,n)}url(e){return this.hostname+this.path+e}}const Yn=(e={},t={})=>({method:"POST",headers:Wn({},t,{"Content-Type":"application/json"}),body:JSON.stringify(e||{})}),zn=e=>e.text().then((t=>{let n;try{n=JSON.parse(t)}catch(n){throw{code:"unknown",msg:`expecting JSON, got: ${t}`,status:e.status}}if(!e.ok)throw n;return n}));let Qn;!function(e){e.MAINNET="https://mainnet-indexer.sequence.app",e.POLYGON="https://polygon-indexer.sequence.app",e.POLYGON_MUMBAI="https://mumbai-indexer.sequence.app",e.ARBITRUM="https://arbitrum-indexer.sequence.app",e.ARBITRUM_NOVA="https://arbitrum-nova-indexer.sequence.app",e.OPTIMISM="https://optimism-indexer.sequence.app",e.AVALANCHE="https://avalanche-indexer.sequence.app",e.GNOSIS="https://gnosis-indexer.sequence.app",e.BSC="https://bsc-indexer.sequence.app",e.BSC_TESTNET="https://bsc-testnet-indexer.sequence.app",e.GOERLI="https://goerli-indexer.sequence.app"}(Qn||(Qn={}));class Zn extends Jn{constructor(e,t){super(e.endsWith("/")?e.slice(0,-1):e,n.g.fetch),this.jwtAuth=t,this._fetch=(e,t)=>{const s={};return this.jwtAuth&&this.jwtAuth.length>0&&(s.Authorization=`BEARER ${this.jwtAuth}`),t.headers=Wn({},t.headers,s),n.g.fetch(e,t)},this.fetch=this._fetch}}function Xn(){return Xn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Xn.apply(this,arguments)}const es="v1",ts="v0.4.0",ns="29ad5fdbf3aa39c52fb5571db3fda19c79544914";let ss,is,rs;!function(e){e.UNKNOWN="UNKNOWN",e.ERC20="ERC20",e.ERC721="ERC721",e.ERC1155="ERC1155"}(ss||(ss={})),function(e){e.UNKNOWN="UNKNOWN",e.BUY="BUY",e.SELL="SELL"}(is||(is={})),function(e){e.DESC="DESC",e.ASC="ASC"}(rs||(rs={}));class as{constructor(e,t){this.hostname=void 0,this.fetch=void 0,this.path="/rpc/Metadata/",this.ping=e=>this.fetch(this.url("Ping"),os({},e)).then((e=>cs(e).then((e=>({status:e.status}))))),this.version=e=>this.fetch(this.url("Version"),os({},e)).then((e=>cs(e).then((e=>({version:e.version}))))),this.runtimeStatus=e=>this.fetch(this.url("RuntimeStatus"),os({},e)).then((e=>cs(e).then((e=>({status:e.status}))))),this.getTokenMetadata=(e,t)=>this.fetch(this.url("GetTokenMetadata"),os(e,t)).then((e=>cs(e).then((e=>({tokenMetadata:e.tokenMetadata}))))),this.refreshTokenMetadata=(e,t)=>this.fetch(this.url("RefreshTokenMetadata"),os(e,t)).then((e=>cs(e).then((e=>({status:e.status}))))),this.getTokenMetadataBatch=(e,t)=>this.fetch(this.url("GetTokenMetadataBatch"),os(e,t)).then((e=>cs(e).then((e=>({contractTokenMetadata:e.contractTokenMetadata}))))),this.searchTokenMetadata=(e,t)=>this.fetch(this.url("SearchTokenMetadata"),os(e,t)).then((e=>cs(e).then((e=>({page:e.page,tokenMetadata:e.tokenMetadata}))))),this.searchTokenIDs=(e,t)=>this.fetch(this.url("SearchTokenIDs"),os(e,t)).then((e=>cs(e).then((e=>({page:e.page,tokenIds:e.tokenIds}))))),this.getContractInfo=(e,t)=>this.fetch(this.url("GetContractInfo"),os(e,t)).then((e=>cs(e).then((e=>({contractInfo:e.contractInfo}))))),this.getContractInfoBatch=(e,t)=>this.fetch(this.url("GetContractInfoBatch"),os(e,t)).then((e=>cs(e).then((e=>({contractInfoMap:e.contractInfoMap}))))),this.searchContractInfo=(e,t)=>this.fetch(this.url("SearchContractInfo"),os(e,t)).then((e=>cs(e).then((e=>({contractInfoList:e.contractInfoList}))))),this.searchContractInfoBatch=(e,t)=>this.fetch(this.url("SearchContractInfoBatch"),os(e,t)).then((e=>cs(e).then((e=>({contractInfoByChain:e.contractInfoByChain}))))),this.getNiftyswapTokenQuantity=(e,t)=>this.fetch(this.url("GetNiftyswapTokenQuantity"),os(e,t)).then((e=>cs(e).then((e=>({quantity:e.quantity}))))),this.getNiftyswapUnitPrices=(e,t)=>this.fetch(this.url("GetNiftyswapUnitPrices"),os(e,t)).then((e=>cs(e).then((e=>({prices:e.prices}))))),this.hostname=e,this.fetch=(e,n)=>t(e,n)}url(e){return this.hostname+this.path+e}}const os=(e={},t={})=>({method:"POST",headers:Xn({},t,{"Content-Type":"application/json"}),body:JSON.stringify(e||{})}),cs=e=>e.text().then((t=>{let n;try{n=JSON.parse(t)}catch(n){throw{code:"unknown",msg:`expecting JSON, got: ${t}`,status:e.status}}if(!e.ok)throw n;return n}));class ls extends as{constructor(e="https://metadata.sequence.app"){super(e.endsWith("/")?e.slice(0,-1):e,n.g.fetch)}}var hs=n(80221),ds=n(7495),us=n(42366),ps=n(51906);function gs(){return gs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},gs.apply(this,arguments)}const fs="tuple(\n  bool delegateCall,\n  bool revertOnError,\n  uint256 gasLimit,\n  address target,\n  uint256 value,\n  bytes data\n)[]";function ws(...e){const t=xs(...e);if(void 0===t)throw new Error("Encoding transactions without defined nonce");return ms(t,...e)}function ms(e,...t){return Ce.$.encode(["uint256",fs],[e,Ts(t)])}function ys(...e){const t=xs(...e);if(void 0===t)throw new Error("Computing hash for transactions without defined nonce");return vs(t,...e)}function vs(e,...t){return P.keccak256(ms(e,...t))}function bs(e,t,...n){return Me(e,t,ys(...n)).replace(/^0x/,"")}async function Cs(e,t,n=!1,s){const i=Es(t),r=(await Promise.all(t.map((e=>e.nonce)))).filter((e=>void 0!==e)).map((e=>ye.O$.from(e))),a=0!==r.length?r.reduce(((e,t)=>e.lt(t)?e:t)):void 0;return Promise.all(i.map((t=>_s(e,t,n,s,a))))}function Es(e){if(!Array.isArray(e)){if("auxiliary"in e){const t=e.auxiliary,n=gs({},e);return delete n.auxiliary,t?[n,...Es(t)]:[n]}return[e]}return e.flatMap(Es)}async function _s(e,t,n=!1,s,i){if(Ss(t))return t;const r=void 0===t.gasLimit?t.gas:t.gasLimit;if(t.to)return{delegateCall:!1,revertOnError:n,gasLimit:r?await r:s,to:await t.to,value:t.value?await t.value:0,data:await t.data,nonce:i||await t.nonce};{const a=new at.vU(w.mainModule.abi),o=a.encodeFunctionData(a.getFunction("createContract"),[t.data]),c="string"==typeof e?e:e.getAddress();return{delegateCall:!1,revertOnError:n,gasLimit:r?await r:s,to:await c,value:t.value?await t.value:0,data:o,nonce:i||await t.nonce}}}function ks(e){return e.send||e.sendAsync}function Ss(e){return void 0!==e.delegateCall||void 0!==e.revertOnError}function Is(e){return void 0!==e.find((e=>Ss(e)))}function xs(...e){const t=e.find((e=>void 0!==e.nonce));if(!t)return;const n=ye.O$.from(t.nonce);if(e.find((e=>void 0!==e.nonce&&!ye.O$.from(e.nonce).eq(n))))throw new Error("Mixed nonces on Sequence transactions");return t?t.nonce:void 0}function Ts(e){return e.map((e=>{var t;return{delegateCall:!0===e.delegateCall,revertOnError:!0===e.revertOnError,gasLimit:void 0!==e.gasLimit?e.gasLimit:ve._Y,target:null!=(t=e.to)?t:ps.d,value:void 0!==e.value?e.value:ve._Y,data:void 0!==e.data?e.data:[]}}))}function Os(e,t){return e.map((e=>gs({},e,{nonce:t})))}function Ns(e,t,n){const s=new at.vU(w.sequenceUtils.abi);if(!e||!e.sequenceUtils)throw new Error("Undefined sequenceUtils");return[{delegateCall:!1,revertOnError:!0,gasLimit:0,to:e.sequenceUtils,value:0,data:s.encodeFunctionData(s.getFunction("requireNonExpired"),[n])},...t]}function As(e,t,n){const s=new at.vU(w.sequenceUtils.abi);if(!e||!e.sequenceUtils)throw new Error("Undefined sequenceUtils");return[{delegateCall:!1,revertOnError:!0,gasLimit:0,to:e.sequenceUtils,value:0,data:s.encodeFunctionData(s.getFunction("requireMinNonce"),[n.address,n.space?Ps(n.space,n.nonce):n.nonce])},...t]}function Ps(e,t){const n=ye.O$.from(e),s=ye.O$.from(t),i=ve.Py.pow(ye.O$.from(96));if(!s.div(i).eq(ve._Y))throw new Error("Space already encoded");return s.add(n.mul(i))}function Ms(e){const t=ye.O$.from(e),n=ve.Py.pow(ye.O$.from(96));return[t.div(n),t.mod(n)]}function Rs(e){return void 0!==e&&void 0!==e.chainId&&void 0!==e.config&&void 0!==e.context&&void 0!==e.signature&&void 0!==e.transactions&&Array.isArray(e.transactions)&&e.transactions.reduce(((e,t)=>e&&Ss(t)),!0)}async function Ls(e,t,n){let s=[];if(s=Array.isArray(n)?Is(n)?Es(n):await Cs(t,n):Ss(n)?Es([n]):await Cs(t,[n]),n.expiration&&(s=Ns(e,s,n.expiration)),n.afterNonce){const i=n.afterNonce;s=As(e,s,i.address?{address:i.address,nonce:i.nonce,space:i.space}:{address:t,nonce:i})}return s}function Us(){return Us=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Us.apply(this,arguments)}function Ds(e){return void 0!==e.bundleCreation&&"boolean"==typeof e.bundleCreation||void 0!==e.creationGasLimit&&rt(e.creationGasLimit)||void 0!==e.provider&&(ds.zt.isProvider(e.provider)||"string"==typeof e.provider)}const qs={bundleCreation:!0,creationGasLimit:ve.Py.pow(17)};class Ws{constructor(e){this.provider=void 0,this.bundleCreation=void 0,this.creationGasLimit=void 0;const t=Us({},qs,e);this.bundleCreation=t.bundleCreation,this.provider=t.provider,this.creationGasLimit=ye.O$.from(t.creationGasLimit)}async isWalletDeployed(e){if(!this.provider)throw new Error("Bundled creation provider not found");return"0x"!==await this.provider.getCode(e)}prepareWalletDeploy(e,t){const n=new at.vU(w.factory.abi);return{to:t.factory,data:n.encodeFunctionData(n.getFunction("deploy"),[t.mainModule,fn(e)])}}async prependWalletDeploy(e){const{config:t,context:n,transactions:s,nonce:i,signature:r}=e,a=gn(t,n),o=new at.vU(w.mainModule.abi),c=async function(){const e=await r;return"string"==typeof e?e:Ln(e)}();return this.bundleCreation&&!await this.isWalletDeployed(a)?{to:n.guestModule,execute:{transactions:[Us({},this.prepareWalletDeploy(t,n),{delegateCall:!1,revertOnError:!1,gasLimit:this.creationGasLimit,value:ve._Y}),{delegateCall:!1,revertOnError:!0,gasLimit:ve._Y,to:a,value:ve._Y,data:o.encodeFunctionData(o.getFunction("execute"),[Ts(s),i,await c])}],nonce:ve._Y,signature:"0x"}}:{to:a,execute:{transactions:s,nonce:ye.O$.from(i),signature:await c}}}async prepareTransactions(e,t,n,...s){const i=xs(...s);if(!i)throw new Error("Unable to prepare transactions without a defined nonce");const{to:r,execute:a}=await this.prependWalletDeploy({config:e,context:t,transactions:s,nonce:i,signature:n}),o=new at.vU(w.mainModule.abi);return{to:r,data:o.encodeFunctionData(o.getFunction("execute"),[Ts(a.transactions),a.nonce,a.signature])}}}const Bs=ye.O$.from(8e5),Fs={waitPollRate:1e3,deltaBlocksLog:12,fromBlockLog:-1024};function $s(e){return void 0!==e.provider&&ds.zt.isProvider(e.provider)}class js extends Ws{constructor(e){super(e),this.provider=void 0,this.waitPollRate=void 0,this.deltaBlocksLog=void 0,this.fromBlockLog=void 0;const t=Us({},Fs,e);this.provider=t.provider,this.waitPollRate=t.waitPollRate,this.deltaBlocksLog=t.deltaBlocksLog,this.fromBlockLog=t.fromBlockLog}async simulate(e,...t){var n=this;return(await Promise.all(t.map((async function(t){if(t.gasLimit&&!ye.O$.from(t.gasLimit||0).eq(ve._Y))return t.gasLimit;if(t.delegateCall)return Bs;if(t.to===e&&!await n.isWalletDeployed(e))return Bs;if(!n.provider)throw new Error("signer.provider is not set, but is required");return n.provider.estimateGas({from:e,to:t.to,data:t.data,value:t.value})})))).map((e=>({executed:!0,succeeded:!0,gasUsed:ye.O$.from(e).toNumber(),gasLimit:ye.O$.from(e).toNumber()})))}async getNonce(e,t,n,s){if(!this.provider)throw new Error("provider is not set");const i=gn(e,t);if("0x"===await this.provider.getCode(i))return 0;void 0===n&&(n=0);const r=new N.CH(i,w.mainModule.abi,this.provider);return Ps(n,await r.readNonce(n,{blockTag:s}))}async wait(e,t,n=this.waitPollRate,s=5){var i=this;"string"!=typeof e&&(Be.info("computing id",e.config,e.context,e.chainId,...e.transactions),e=bs(gn(e.config,e.context),e.chainId,...e.transactions));let r=!1;const a=async function(e,t){let i=0;for(;!r;){try{return await e()}catch(e){if(i++,void 0!==s&&i>=s)throw Be.error(`giving up after ${i} failed attempts${t?`: ${t}`:""}`,e),e;Be.warn(`attempt #${i} failed${t?`: ${t}`:""}`,e)}n>0&&await new Promise((e=>setTimeout(e,n)))}throw new Error(`timed out after ${i} failed attempts${t?`: ${t}`:""}`)},o=async function(){let t=i.fromBlockLog;if(t<0){const e=await a((()=>i.provider.getBlockNumber()),"unable to get latest block number");t=e+t}if("string"!=typeof e)throw new Error("impossible");const s=e.replace("0x","");for(;!r;){const e=await a((()=>i.provider.getBlockNumber()),"unable to get latest block number"),o=await a((()=>i.provider.getLogs({fromBlock:Math.max(0,t-i.deltaBlocksLog),toBlock:e,topics:["0x1f180c27086c7a39ea2a7b25239d1ab92348f07ca7bb59d1438fcf527568f881"]})),`unable to get NonceChange logs for blocks ${Math.max(0,t-i.deltaBlocksLog)} to ${e}`);t=e;const c=(await Promise.all(o.map((e=>a((()=>i.provider.getTransactionReceipt(e.transactionHash)),`unable to get receipt for transaction ${e.transactionHash}`))))).find((e=>e.logs.find((e=>0===e.topics.length&&e.data.replace("0x","")===s||1===e.topics.length&&"0x3dbd1590ea96dd3253a91f24e64e3a502e1225d602a5731357bc12643070ccd7"===e.topics[0]&&e.data.length>=64&&e.data.replace("0x","").startsWith(s)))));if(c)return Us({receipt:c},await a((()=>i.provider.getTransaction(c.transactionHash)),`unable to get transaction ${c.transactionHash}`));r||await new Promise((e=>setTimeout(e,n)))}throw new Error(`Timeout waiting for transaction receipt ${e}`)};return void 0!==t?Promise.race([o(),new Promise(((n,s)=>setTimeout((()=>{r=!0,s(`Timeout waiting for transaction receipt ${e}`)}),t)))]):o()}}function Hs(e){return void 0!==e.signer&&me.E.isSigner(e.signer)}class Gs extends js{constructor(e){if(super(me.E.isSigner(e)?{provider:e.provider}:Us({},e,{provider:e.signer.provider})),this.signer=void 0,this.txnOptions=void 0,this.signer=me.E.isSigner(e)?e:e.signer,!this.signer.provider)throw new Error("Signer must have a provider")}async deployWallet(e,t){const n=this.prepareWalletDeploy(e,t);return this.signer.sendTransaction(Us({},n,{gasLimit:ve.Py.pow(17)}))}async getFeeOptions(e,t,...n){return{options:[]}}async gasRefundOptions(e,t,...n){const{options:s}=await this.getFeeOptions(e,t,...n);return s}setTransactionOptions(e){this.txnOptions=e}async relay(e,t,n=!0){if(void 0!==t&&Be.warn("LocalRelayer doesn't accept fee quotes"),!e.context.guestModule||42!==e.context.guestModule.length)throw new Error("LocalRelayer requires the context.guestModule address");const{to:s,execute:i}=await this.prependWalletDeploy(e),r=new at.vU(w.mainModule.abi),a=r.encodeFunctionData(r.getFunction("execute"),[Ts(i.transactions),i.nonce,i.signature]),o=this.signer.sendTransaction(Us({to:s,data:a},this.txnOptions));if(n){const e=await o;return e.receipt=await e.wait(),e}return o}}let Vs,Ks,Js,Ys;!function(e){e.UNKNOWN="UNKNOWN",e.DROPPED="DROPPED",e.QUEUED="QUEUED",e.SENT="SENT",e.SUCCEEDED="SUCCEEDED",e.PARTIALLY_FAILED="PARTIALLY_FAILED",e.FAILED="FAILED"}(Vs||(Vs={})),function(e){e.SEND="SEND",e.RECEIVE="RECEIVE",e.BRIDGE_DEPOSIT="BRIDGE_DEPOSIT",e.BRIDGE_WITHDRAW="BRIDGE_WITHDRAW",e.BURN="BURN",e.UNKNOWN="UNKNOWN"}(Ks||(Ks={})),function(e){e.UNKNOWN="UNKNOWN",e.ERC20_TOKEN="ERC20_TOKEN",e.ERC1155_TOKEN="ERC1155_TOKEN"}(Js||(Js={})),function(e){e.DESC="DESC",e.ASC="ASC"}(Ys||(Ys={}));class zs{constructor(e,t){this.hostname=void 0,this.fetch=void 0,this.path="/rpc/Relayer/",this.ping=e=>this.fetch(this.url("Ping"),Qs({},e)).then((e=>Zs(e).then((e=>({status:e.status}))))),this.version=e=>this.fetch(this.url("Version"),Qs({},e)).then((e=>Zs(e).then((e=>({version:e.version}))))),this.runtimeStatus=e=>this.fetch(this.url("RuntimeStatus"),Qs({},e)).then((e=>Zs(e).then((e=>({status:e.status}))))),this.getSequenceContext=e=>this.fetch(this.url("GetSequenceContext"),Qs({},e)).then((e=>Zs(e).then((e=>({data:e.data}))))),this.getChainID=e=>this.fetch(this.url("GetChainID"),Qs({},e)).then((e=>Zs(e).then((e=>({chainID:e.chainID}))))),this.sendMetaTxn=(e,t)=>this.fetch(this.url("SendMetaTxn"),Qs(e,t)).then((e=>Zs(e).then((e=>({status:e.status,txnHash:e.txnHash}))))),this.getMetaTxnNonce=(e,t)=>this.fetch(this.url("GetMetaTxnNonce"),Qs(e,t)).then((e=>Zs(e).then((e=>({nonce:e.nonce}))))),this.getMetaTxnReceipt=(e,t)=>this.fetch(this.url("GetMetaTxnReceipt"),Qs(e,t)).then((e=>Zs(e).then((e=>({receipt:e.receipt}))))),this.simulate=(e,t)=>this.fetch(this.url("Simulate"),Qs(e,t)).then((e=>Zs(e).then((e=>({results:e.results}))))),this.updateMetaTxnGasLimits=(e,t)=>this.fetch(this.url("UpdateMetaTxnGasLimits"),Qs(e,t)).then((e=>Zs(e).then((e=>({payload:e.payload}))))),this.feeTokens=e=>this.fetch(this.url("FeeTokens"),Qs({},e)).then((e=>Zs(e).then((e=>({isFeeRequired:e.isFeeRequired,tokens:e.tokens}))))),this.feeOptions=(e,t)=>this.fetch(this.url("FeeOptions"),Qs(e,t)).then((e=>Zs(e).then((e=>({options:e.options,quote:e.quote}))))),this.getMetaTxnNetworkFeeOptions=(e,t)=>this.fetch(this.url("GetMetaTxnNetworkFeeOptions"),Qs(e,t)).then((e=>Zs(e).then((e=>({options:e.options}))))),this.sentTransactions=(e,t)=>this.fetch(this.url("SentTransactions"),Qs(e,t)).then((e=>Zs(e).then((e=>({page:e.page,transactions:e.transactions}))))),this.pendingTransactions=(e,t)=>this.fetch(this.url("PendingTransactions"),Qs(e,t)).then((e=>Zs(e).then((e=>({page:e.page,transactions:e.transactions}))))),this.listGasSponsors=(e,t)=>this.fetch(this.url("ListGasSponsors"),Qs(e,t)).then((e=>Zs(e).then((e=>({page:e.page,gasSponsors:e.gasSponsors}))))),this.addGasSponsor=(e,t)=>this.fetch(this.url("AddGasSponsor"),Qs(e,t)).then((e=>Zs(e).then((e=>({status:e.status,gasSponsor:e.gasSponsor}))))),this.updateGasSponsor=(e,t)=>this.fetch(this.url("UpdateGasSponsor"),Qs(e,t)).then((e=>Zs(e).then((e=>({status:e.status,gasSponsor:e.gasSponsor}))))),this.reportGasSponsorUsage=(e,t)=>this.fetch(this.url("ReportGasSponsorUsage"),Qs(e,t)).then((e=>Zs(e).then((e=>({gasSponsorUsage:e.gasSponsorUsage}))))),this.hostname=e,this.fetch=(e,n)=>t(e,n)}url(e){return this.hostname+this.path+e}}const Qs=(e={},t={})=>({method:"POST",headers:Us({},t,{"Content-Type":"application/json"}),body:JSON.stringify(e||{})}),Zs=e=>e.text().then((t=>{let n;try{n=JSON.parse(t)}catch(n){throw{code:"unknown",msg:`expecting JSON, got: ${t}`,status:e.status}}if(!e.ok)throw n;return n}));var Xs=Object.freeze({__proto__:null,WebRPCVersion:"v1",WebRPCSchemaVersion:"v0.4.0",WebRPCSchemaHash:"dd44f90f38fc726a1f1430cfece544c3316f6b4f",get ETHTxnStatus(){return Vs},get TransferType(){return Ks},get FeeTokenType(){return Js},get SortOrder(){return Ys},Relayer:zs});const ei=[Vs.DROPPED,Vs.SUCCEEDED,Vs.PARTIALLY_FAILED,Vs.FAILED],ti=[Vs.DROPPED,Vs.PARTIALLY_FAILED,Vs.FAILED];function ni(e){return void 0!==e.url&&"string"==typeof e.url}class si extends Ws{constructor(e){super(e),this.service=void 0,this.service=new zs(e.url,n.g.fetch)}async waitReceipt(e,t=1e3,n=5,s){"string"!=typeof e&&(Be.info("computing id",e.config,e.context,e.chainId,...e.transactions),e=bs(gn(e.config,e.context),e.chainId,...e.transactions)),Be.info(`[rpc-relayer/waitReceipt] waiting for ${e}`);let i=0;for(;void 0===s||!s();){try{const{receipt:t}=await this.service.getMetaTxnReceipt({metaTxID:e});if(t&&t.txnReceipt&&"null"!==t.txnReceipt&&ei.includes(t.status))return{receipt:t}}catch(e){if(i++,i===n)throw e}void 0!==s&&s()||await new Promise((e=>setTimeout(e,t)))}throw new Error(`Cancelled waiting for transaction receipt ${e}`)}async simulate(e,...t){const n=Ce.$.encode([fs],[Ts(t)]);return(await this.service.simulate({wallet:e,transactions:n})).results}async getFeeOptions(e,t,...n){const s=await this.service.feeTokens();if(s.isFeeRequired){const i=s.tokens.map((e=>e.symbol)).join(", ");Be.info(`[rpc-relayer/getFeeOptions] relayer fees are required, accepted tokens are ${i}`);const r=gn(e,t);let a=xs(...n);if(void 0===a&&(a=await this.getNonce(e,t)),!this.provider)throw Be.warn("[rpc-relayer/getFeeOptions] provider not set, needed for stub signature"),new Error("provider is not set");const{to:o,execute:c}=await this.prependWalletDeploy({config:e,context:t,transactions:n,nonce:a,signature:qn(this.provider,e)}),l=new at.vU(w.mainModule.abi),h=l.encodeFunctionData(l.getFunction("execute"),[Ts(c.transactions),c.nonce,c.signature]),{options:d,quote:u}=await this.service.feeOptions({wallet:r,to:o,data:h});return Be.info(`[rpc-relayer/getFeeOptions] got refund options ${JSON.stringify(d)}`),{options:d,quote:{_tag:"FeeQuote",_quote:u}}}return Be.info("[rpc-relayer/getFeeOptions] relayer fees are not required"),{options:[]}}async gasRefundOptions(e,t,...n){const{options:s}=await this.getFeeOptions(e,t,...n);return s}async getNonce(e,t,n){const s=gn(e,t);Be.info(`[rpc-relayer/getNonce] get nonce for wallet ${s} space: ${n}`);const i=void 0!==n?ye.O$.from(n).toHexString():void 0,r=await this.service.getMetaTxnNonce({walletContractAddress:s,space:i}),a=ye.O$.from(r.nonce),[o,c]=Ms(a);return Be.info(`[rpc-relayer/getNonce] got next nonce for wallet ${s} ${c} space: ${o}`),a}async relay(e,t,n=!0){var s=this;let i;if(Be.info(`[rpc-relayer/relay] relaying signed meta-transactions ${JSON.stringify(e)} with quote ${JSON.stringify(t)}`),void 0!==t&&("string"==typeof t._quote?i=t._quote:Be.warn("[rpc-relayer/relay] ignoring invalid fee quote")),!this.provider)throw Be.warn("[rpc-relayer/relay] provider not set, failed relay"),new Error("provider is not set");const{to:r,execute:a}=await this.prependWalletDeploy(e),o=gn(e.config,e.context),c=new at.vU(w.mainModule.abi),l=c.encodeFunctionData(c.getFunction("execute"),[Ts(a.transactions),a.nonce,a.signature]),h=await this.service.sendMetaTxn({call:{walletAddress:o,contract:r,input:l},quote:i});if(Be.info(`[rpc-relayer/relay] got relay result ${JSON.stringify(h)}`),n)return this.wait(h.txnHash);{const e={hash:h.txnHash,confirmations:0,from:o,wait:e=>Promise.reject(new Error("impossible"))},t=async function(t){var n;if(!s.provider)throw new Error("cannot wait for receipt, relayer has no provider set");const i=await s.wait(h.txnHash),r=null==(n=i.receipt)?void 0:n.transactionHash;if(!r)throw new Error("cannot wait for receipt, unknown native transaction hash");return Object.assign(e,i),s.provider.waitForTransaction(r,t)};return e.wait=t,e}}async wait(e,t,n=1e3,s=5){var i=this;let r=!1;const{receipt:a}=await(void 0!==t?Promise.race([this.waitReceipt(e,n,s,(()=>r)),new Promise(((n,s)=>setTimeout((()=>{r=!0,s(`Timeout waiting for transaction receipt ${e}`)}),t)))]):this.waitReceipt(e,n,s));if(!a.txnReceipt||ti.includes(a.status))throw new ii(a);const o=JSON.parse(a.txnReceipt);return{blockHash:o.blockHash,blockNumber:ye.O$.from(o.blockNumber).toNumber(),confirmations:1,from:"string"==typeof e?void 0:gn(e.config,e.context),hash:o.transactionHash,raw:a.txnReceipt,receipt:o,wait:async function(e){return i.provider.waitForTransaction(o.transactionHash,e)}}}}class ii{constructor(e){this.receipt=e}}function ri(e){return"object"==typeof e&&"function"==typeof e.simulate&&"function"==typeof e.getFeeOptions&&"function"==typeof e.gasRefundOptions&&"function"==typeof e.getNonce&&"function"==typeof e.relay&&"function"==typeof e.wait}function ai(){return ai=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ai.apply(this,arguments)}class oi extends me.E{static isSequenceSigner(e){return ci(e)}}function ci(e){const t=e;return t&&void 0!==t.updateConfig&&void 0!==t.publishConfig&&void 0!==t.getWalletContext&&void 0!==t.getWalletConfig}Error;class li extends Error{}class hi extends me.E{signMessage(e,t){return this.signMessageWithData(e)}sendTransaction(e){throw new Error("sendTransaction method is not supported in RemoteSigner")}signTransaction(e){throw new Error("signTransaction method is not supported in RemoteSigner")}connect(e){throw new Error("connect method is not supported in RemoteSigner")}static signMessageWithData(e,t,n,s){return this.isRemoteSigner(e)?e.signMessageWithData(t,n,s):e.signMessage(t)}static isRemoteSigner(e){return void 0!==e.signMessageWithData}}async function di(e){return Array.isArray(e)?Promise.all(e.map((e=>hs.resolveProperties(e)))):hs.resolveProperties(e)}class ui extends oi{constructor(e,...t){super(),this.context=void 0,this.config=void 0,this._signers=void 0,this.provider=void 0,this.sender=void 0,this.relayer=void 0,this.chainId=void 0;const{config:n,context:s,strict:i}=e;if(this.context=ai({},s||At),!0===i?this.context.nonStrict=void 0:!1===i&&(this.context.nonStrict=!0),!this.context.nonStrict&&!un(n))throw new Error("wallet config is not usable (strict mode)");this.config=wn(n),this._signers=t.map((e=>me.E.isSigner(e)?e:new R.Wallet(e))),this.imageHash}useConfig(e,t){return new ui({config:e,context:this.context,strict:t},...this._signers).setProvider(this.provider).setRelayer(this.relayer)}useSigners(...e){return new ui({config:this.config,context:this.context},...e).setProvider(this.provider).setRelayer(this.relayer)}connect(e,t){if(Lt(e))return new ui({config:this.config,context:this.context},...this._signers).setProvider(e).setRelayer(t);throw new Error("Wallet provider argument is expected to be a JsonRpcProvider")}setProvider(e){if(void 0===e)return this;if(ds.zt.isProvider(e))this.provider=e,this.sender=new qt(e);else{const t=new T.r(e);this.provider=t,this.sender=new qt(t)}return this.chainId=void 0,this}setRelayer(e){return void 0===e||(this.relayer=e),this}async getProvider(e){return e&&await this.getChainIdNumber(e),this.provider}async getRelayer(e){return e&&await this.getChainIdNumber(e),this.relayer}async getWalletContext(){return this.context}async getWalletConfig(e){return e=await this.getChainIdNumber(e),[ai({},this.config,{chainId:e})]}async getWalletState(e){const[t,n,s]=await Promise.all([this.getAddress(),this.getChainId(),this.isDeployed()]);return[{context:this.context,config:this.config,address:t,chainId:n,deployed:s,imageHash:this.imageHash,lastImageHash:s?await wi(this):void 0}]}get connected(){return void 0!==this.sender}get address(){return gn(this.config,this.context)}get imageHash(){return fn(this.config)}async getAddress(){return this.address}async getSigners(){return this._signers&&0!==this._signers.length?Promise.all(this._signers.map((e=>e.getAddress().then((e=>O.getAddress(e)))))):[]}async getChainId(){if(this.chainId)return this.chainId;if(!this.provider)throw new Error("provider is not set, first connect a provider");return this.chainId=(await this.provider.getNetwork()).chainId,this.chainId}async getNetworks(){return[{chainId:await this.getChainId(),name:"",rpcUrl:""}]}async getNonce(e,t){return this.relayer.getNonce(this.config,this.context,t,e)}async getTransactionCount(e){const t=await this.getNonce(e,0),[n,s]=Ms(t);return ye.O$.from(s).toNumber()}async sendTransaction(e,t,n,s,i,r){const a=await this.signTransactions(e,t,n);return i&&i(a,bs(gn(a.config,a.context),a.chainId,...a.transactions)),this.relayer.relay(a,s,r)}async sendTransactionBatch(e,t,n=!0,s,i,r){return this.sendTransaction(e,t,n,s,i,r)}async signTransactions(e,t,n){const s=await this.getChainIdNumber(t),i=await di(e);if(!this.provider)throw new Error("missing provider");if(!this.relayer)throw new Error("missing relayer");let r=await Ls(this.context,this.address,i);if(r.some((e=>void 0===e.gasLimit))){const e=await this.relayer.simulate(this.address,...r);for(const t in r)void 0===r[t].gasLimit&&(r[t].gasLimit=e[t].gasLimit)}const a=xs(...r)||await this.getNonce();r=Os(r,a);const o=vs(a,...r);return{digest:o,chainId:s,context:this.context,config:this.config,transactions:r,nonce:a,signature:await this.sign(o,!0,t,n)}}async sendSignedTransactions(e,t,n){if(!this.relayer)throw new Error("relayer is not set, first connect a relayer");return await this.getChainIdNumber(t),this.relayer.relay(e,n)}async signMessage(e,t,n,s=!1){const i="string"!=typeof e||e.startsWith("0x")?e:ke.Y0(e);return this.sign(i,s,t,n)}async signTypedData(e,t,n,s,i){const r=await this.getChainIdNumber(s),a=e.chainId?ye.O$.from(e.chainId).toNumber():void 0;if(a&&a!==r)throw new Error(`signTypedData: domain.chainId (${e.chainId}) is expected to be ${r}`);const o=Qe({domain:e,types:t,message:n});return this.sign(o,!0,r,i)}async _signTypedData(e,t,n,s,i){return this.signTypedData(e,t,n,s,i)}async subDigest(e,t){const n=await this.getChainIdNumber(t);return A.arrayify(Me(this.address,n,e))}async sign(e,t=!0,n,s){var i=this;const r=await this.getChainIdNumber(n),a=t?e:P.keccak256(e),o=await this.subDigest(a,n),c=async function(e,t){const n=await Promise.all(e.map((e=>e.getAddress()))),a=await Promise.all(i.config.signers.map((async function(a){try{const c=e[n.indexOf(a.address)];if(!c)return a;if(ci(c)){if(c===i)throw Error("Can't sign transactions for self");return ai({},a,{signature:await c.signMessage(o,r,s,!0)+"03"})}if(hi.isRemoteSigner(c)){const e=await c.signMessageWithData(o,t,r);try{if(Pn(o,{weight:a.weight,signature:e})===a.address)return{weight:a.weight,signature:e}}catch(e){}return ai({},a,{signature:e})}return{weight:a.weight,signature:await c.signMessage(o)+"02"}}catch(e){if(s)throw e;return console.warn(`Skipped signer ${a.address}`),a}})));return{threshold:i.config.threshold,signers:a}},l=this._signers.filter((e=>!hi.isRemoteSigner(e))),h=await c(l,this.packMsgAndSig(a,[],r));if(h.signers.filter(Sn).reduce(((e,t)=>e+t.weight),0)>=this.config.threshold)return Ln(h);const d=this._signers.filter((e=>hi.isRemoteSigner(e))),u=await c(d,this.packMsgAndSig(a,Ln(h),r));return Ln(Mn(h,u))}async signWeight(){return(await this.getSigners()).reduce(((e,t)=>{const n=this.config.signers.find((e=>e.address===t));return n?e.add(n.weight):e}),ve._Y)}async isDeployed(e){await this.getChainIdNumber(e);const t=await this.provider.getCode(this.address);return!!t&&"0x"!==t}async updateConfig(e,t,n=!1,s,i,r,a){e||(e=this.config);const[o,c]=await Promise.all([this.buildUpdateConfigTransaction(e,n,s),null!=t?t:this.getNonce()]);return[ai({address:this.address},e),await this.sendTransaction(Os(o,c),void 0,void 0,i,r,a)]}async publishConfig(e,t,n=[],s,i,r){return this.sendTransaction(this.config.address?this.buildPublishConfigTransaction(this.config,e,t):await this.buildPublishSignersTransaction(e,t,n),void 0,void 0,s,i,r)}async buildUpdateConfigTransaction(e,t=!1,n){var s=this;if(!this.context.nonStrict&&!un(e))throw new Error("wallet config is not usable (strict mode)");const i=await async function(){try{const e=await s.provider.getStorageAt(s.address,Ce.$.encode(["address"],[s.address]));return 0===yn(e,s.context.mainModuleUpgradable)}catch(e){return!1}}(),r=new at.vU(w.mainModule.abi),a=2*(1e5+1800*e.signers.length),o=i?[]:[{delegateCall:!1,revertOnError:!0,gasLimit:ve._Y,to:this.address,value:ve._Y,data:r.encodeFunctionData(r.getFunction("updateImplementation"),[this.context.mainModuleUpgradable])}],c=new at.vU(w.mainModuleUpgradable.abi),l=[...o,{delegateCall:!1,revertOnError:!0,gasLimit:ve._Y,to:this.address,value:ve._Y,data:c.encodeFunctionData(c.getFunction("updateImageHash"),[fn(e)])},...t?await this.buildPublishConfigTransaction(e,n):[]];return 1===l.length?l:[{delegateCall:!1,revertOnError:!1,gasLimit:a,to:this.address,value:ve._Y,data:r.encodeFunctionData(r.getFunction("selfExecute"),[Ts(l)])}]}buildPublishConfigTransaction(e,t=!0,n){const s=new at.vU(w.sequenceUtils.abi);return[{delegateCall:!1,revertOnError:!0,gasLimit:ve._Y,to:this.context.sequenceUtils,value:ve._Y,nonce:n,data:s.encodeFunctionData(s.getFunction("publishConfig"),[this.address,e.threshold,wn(e).signers.map((e=>({weight:e.weight,signer:e.address}))),t])}]}async buildPublishSignersTransaction(e=!0,t,n=[]){var s;const i=new at.vU(w.sequenceUtils.abi),r=new at.vU(w.requireFreshSigner.abi),a=us.O(32),o=await this.signMessage(a,this.chainId,!1),c=Nn(o),l=Ln({threshold:c.threshold,signers:c.signers.map(((e,t)=>{if(Tn(e)){const e=this.config.signers[t];return{weight:e.weight,address:e.address}}return e}))}),h=null==(s=this.context.libs)?void 0:s.requireFreshSigner;if(n.length>0&&void 0===h)throw Error("requireFreshSigners missing library");return[...n.map((e=>({delegateCall:!1,revertOnError:!0,gasLimit:ve._Y,to:h,value:ve._Y,nonce:t,data:r.encodeFunctionData(r.getFunction("requireFreshSigner"),[e])}))),{delegateCall:!1,revertOnError:!0,gasLimit:ve._Y,to:this.context.sequenceUtils,value:ve._Y,nonce:t,data:i.encodeFunctionData(i.getFunction("publishInitialSigners"),[this.address,P.keccak256(a),this.config.signers.length,l,e])}]}async getChainIdNumber(e){if(!e)return await this.getChainId();const t=ht(e);if(this.context.nonStrict)return t;const n=await this.getChainId();if(n!==t)throw new Error(`the specified chainId ${t} does not match the wallet's connected chainId ${n}`);return n}packMsgAndSig(e,t,n){return Ce.$.encode(["address","uint256","bytes","bytes"],[this.address,n,e,t])}signTransaction(e){throw new Error("signTransaction method is not supported in Wallet, please use signTransactions(...)")}static async singleOwner(e,t){const n=me.E.isSigner(e)?e:new R.Wallet(e),s={threshold:1,signers:[{weight:1,address:O.getAddress(await n.getAddress())}]};return new ui({config:s,context:t},n)}async hasEnoughSigners(e){return e&&await this.getChainIdNumber(e),(await this.signWeight()).gte(this.config.threshold)}}class pi extends oi{constructor(e,...t){super(),this.options=void 0,this._wallets=void 0,this._signers=void 0,this.provider=void 0,this._chainId=void 0,this.options=e,this._signers=t,e.context||(this.options.context=ai({},At)),this.options.networks?this.setNetworks(this.options.networks):this.setNetworks([...Ot])}useSigners(...e){return this._signers=e,this._wallets.forEach((t=>{t.wallet=t.wallet.useSigners(...e)})),this}async getWalletContext(){return this.options.context}getConfigFinder(){return this.options.configFinder?this.options.configFinder:new _n(this.authWallet().wallet.provider)}async getWalletConfig(e){let t=[];if(e){const n=this.getWalletByNetwork(e);n&&t.push(n)}else t=this._wallets;return(await Promise.all(t.map((e=>e.wallet.getWalletConfig())))).flat()}async getWalletState(e){let t=[];if(e){const n=this.getWalletByNetwork(e);n&&t.push(n)}else t=this._wallets;const n=Promise.all(t.map((e=>this.getConfigFinder().findCurrentConfig({address:e.wallet.address,provider:e.wallet.provider,context:e.wallet.context,knownConfigs:[e.wallet.config]})))),s=(await Promise.all(t.map((e=>e.wallet.getWalletState())))).flat(),i=s.findIndex((e=>e.chainId===this.getAuthChainId()));i>=0&&(s[i].config=await this.currentConfig(t[i].wallet));const r=await n;return s.map(((e,t)=>{var n;return ai({},e,{config:null==(n=r[t])?void 0:n.config})}))}get address(){return this._wallets[0].wallet.address}getAddress(){return this._wallets[0].wallet.getAddress()}async getSigners(){return this._wallets[0].wallet.getSigners()}async getProvider(e){var t,n;return e?null==(n=this._wallets.find((t=>t.network.chainId===e)))?void 0:n.wallet.getProvider():null==(t=this.mainWallet())?void 0:t.wallet.getProvider()}async getRelayer(e){var t,n;return e?null==(n=this._wallets.find((t=>t.network.chainId===e)))?void 0:n.wallet.getRelayer():null==(t=this.mainWallet())?void 0:t.wallet.getRelayer()}async getNetworks(){return this.options.networks}async getChainId(){if(this._chainId)return this._chainId;const e=await this.provider.getNetwork();return this._chainId=e.chainId,this._chainId}getAuthChainId(){try{return this.options.networks.find((e=>e.isAuthChain)).chainId}catch(e){throw new Error("no auth network")}}async signMessage(e,t,n=!0,s=!1){var i=this;let{wallet:r}=await async function(){if(!t)return i.mainWallet();if(t.address){const e=await t.getChainId();return i.getWalletByNetwork(e)}return i.getWalletByNetwork(t)}(),a=await this.currentConfig(r);a=a||this._wallets[0].wallet.config,r=r.useConfig(a);const o=await r.signWeight();if(o.lt(r.config.threshold)&&!1!==n)throw new li(`Sign message - wallet combined weight ${o.toString()} below required ${r.config.threshold.toString()}`);return r.signMessage(e,void 0,n,s)}async signAuthMessage(e,t=!0,n=!1){var s;return this.signMessage(e,null==(s=this.authWallet())?void 0:s.wallet,t,n)}async signTypedData(e,t,n,s,i=!0){const r=s?this.getWalletByNetwork(s).wallet:this.mainWallet().wallet,a=Qe({domain:e,types:t,message:n});return this.signMessage(a,r,i,!0)}async _signTypedData(e,t,n,s,i=!0){return this.signTypedData(e,t,n,s,i)}async hasEnoughSigners(e){const t=e?this.getWalletByNetwork(e).wallet:this.mainWallet().wallet,n=await this.currentConfig(t);return t.useConfig(n).hasEnoughSigners()}async getFeeOptions(e,t,n=!0){const s=t?this.getWalletByNetwork(t).wallet:this.mainWallet().wallet,i=this.options.context;if(!i)throw new Error("missing wallet context");const[r,a]=await Promise.all([this.currentConfig(s),this.prependConfigUpdate(e,t,n,!0)]);if(!r)throw new Error(`missing current config for chain ${t}`);const o=await Ls(i,this.address,a);return s.relayer.getFeeOptions(r,i,...o)}async sendTransaction(e,t,n=!0,s,i){const r=await this.signTransactions(e,t,n);return i&&i(r,bs(gn(r.config,r.context),r.chainId,...r.transactions)),(t?this.getWalletByNetwork(t).wallet:this.mainWallet().wallet).sendSignedTransactions(r,t,s)}async sendTransactionBatch(e,t,n=!0,s,i){return this.sendTransaction(e,t,n,s,i)}async signTransactions(e,t,n){const s=t?this.getWalletByNetwork(t).wallet:this.mainWallet().wallet;let i=await this.currentConfig(s);if(!i&&(i=await this.currentConfig(),!i))throw new Error("missing auth chain config");const r=await this.prependConfigUpdate(e,t,n);return s.useConfig(i).signTransactions(r)}async prependConfigUpdate(e,t,n,s){const i=await di(e),r=t?this.getWalletByNetwork(t).wallet:this.mainWallet().wallet,[a,o]=await Promise.all([this.currentConfig(r),this.currentConfig()]);if(!s){const e=await r.useConfig(a).signWeight();if(e.lt(a.threshold)&&n)throw new li(`wallet combined weight ${e.toString()} below required threshold ${a.threshold.toString()}`)}if(await r.isDeployed()&&mn(o,a))return i;const c=Array.isArray(i)?i:[i];return[...await r.buildUpdateConfigTransaction(o,!1),...c]}async sendSignedTransactions(e,t,n){return(t?this.getWalletByNetwork(t).wallet:this.mainWallet().wallet).sendSignedTransactions(e,void 0,n)}async updateConfig(e,t,n,s){const i=this.authWallet().wallet;if(e=e?wn(e):i.config,mn(i.config,e)&&!await this.isDeployed())return await i.updateConfig(e,void 0,!0,t,n,s);const r=await this.currentConfig();if(mn(r,e))return[ai({},r,{address:this.address}),void 0];const[a,o]=await i.useConfig(r).updateConfig(e,void 0,!0,t,n,s);return[ai({},e,{address:this.address}),o]}publishConfig(e,t=[],n,s){return this.authWallet().wallet.publishConfig(e,void 0,t,n,s)}async isDeployed(e){return(()=>e?e.address?e:this.getWalletByNetwork(e).wallet:this.authWallet().wallet)().isDeployed()}async currentConfig(e){const t=(()=>e?e.address?e:this.getWalletByNetwork(e).wallet:this.authWallet().wallet)();return(await this.getConfigFinder().findCurrentConfig({address:this.address,provider:t.provider,context:t.context,knownConfigs:[t.config]})).config}getWallets(){return this._wallets}getWalletByNetwork(e){const t=ht(e),n=this._wallets.find((e=>e.network.chainId===t));if(!n)throw new Error(`network ${e} not found in wallets list`);return n}mainWallet(){const e=this._wallets.find((e=>e.network.isDefaultChain));if(!e)throw new Error("mainWallet not found");return e}authWallet(){const e=this._wallets.find((e=>e.network.isAuthChain));if(!e)throw new Error("authChain wallet not found");return e}setNetworks(e,t=[],n){let s=[];if(this._chainId=void 0,n){const i=parseInt(n),r=e.find((e=>e.name===n||e.chainId===i)),a=t.find((e=>e.name===n||e.chainId===i));if(!r&&!a)throw new Error(`unable to set default network as chain '${n}' does not exist`);r?(e.forEach((e=>e.isDefaultChain=!1)),r.isDefaultChain=!0,s=e):a&&(t.forEach((e=>e.isDefaultChain=!1)),a.isDefaultChain=!0,s=t)}else s=e;return this.options.networks=gt(Ct(s)),this._wallets=this.options.networks.map((e=>{const t=new ui({config:this.options.initialConfig,context:this.options.context},...this._signers);if(e.provider)t.setProvider(e.provider);else{if(!e.rpcUrl||""===e.rpcUrl)throw new Error(`network config is missing provider settings for chainId ${e.chainId}`);t.setProvider(e.rpcUrl)}if(ri(e.relayer))t.setRelayer(e.relayer);else{if(!ni(e.relayer))throw new Error(`network config is missing relayer settings for chainId ${e.chainId}`);t.setRelayer(new si(ai({provider:t.provider},e.relayer)))}return e.isDefaultChain&&(this._chainId=e.chainId,this.provider=t.provider),{network:e,wallet:t}})),this.options.networks.find((e=>e.isDefaultChain)).chainId}connect(e){throw new Error("connect method is not supported in MultiWallet")}signTransaction(e){throw new Error("signTransaction method is not supported in MultiWallet, please use signTransactions(...)")}}async function gi(e,t,n,s,i,r){if(function(e,t,n){try{return 0===yn(_e.recoverAddress(t,A.splitSignature(n)),e)}catch(e){return!1}}(e,t,n)||function(e,t,n){try{const s=P.keccak256(be.pack(["string","bytes32"],["Ethereum Signed Message:\n32",t]));return 0===yn(_e.recoverAddress(s,A.splitSignature(n)),e)}catch(e){return!1}}(e,t,n))return!0;const a=await async function(e,t,n,s){if(s)try{if("0x"===await s.getCode(e))return;const i=new N.CH(e,w.erc1271.abi,s),r=await i.isValidSignature(t,n);return w.erc1271.returns.isValidSignatureBytes32===r}catch(e){return!1}}(e,t,n,s);return void 0===a?fi(e,t,n,i,s,r):a}async function fi(e,t,n,s,i,r){if((i||r)&&s)try{const a=r||(await i.getNetwork()).chainId,o=Nn(n),c=A.arrayify(P.keccak256(Pe(e,a,t))),l=await mi(c,o,i,s,r,!0),h=o.signers.reduce(((e,t)=>In(t)||Tn(t)?e+t.weight:e),0);return 0===yn(gn(l,s),e)&&h>=o.threshold}catch(e){return!1}}const wi=async e=>{const t=await e.getAddress(),n=new N.CH(t,w.mainModuleUpgradable.abi,await e.getProvider()),s=await n.functions.imageHash.call([]).catch((()=>[]));return s&&s.length>0?s[0]:""},mi=async(e,t,n,s,i,r)=>{const a=void 0!==t.threshold?t:Nn(t),o=await Promise.all(a.signers.map((async t=>{if(In(t))return{weight:t.weight,address:Pn(e,t)};if(kn(t))return{weight:t.weight,address:O.getAddress(t.address)};if(Tn(t)){if(r&&!await gi(t.address,A.arrayify(e),A.hexlify(t.signature),n,s,i))throw Error("Invalid signature");return{weight:t.weight,address:t.address}}throw Error("Uknown signature type")})));return{threshold:a.threshold,signers:o}};function yi(){return yi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},yi.apply(this,arguments)}const vi=604800,bi=3e7;class Ci{constructor(e,t,n,s,i,r,a,o,c){var l;this.sequenceApiUrl=e,this.sequenceMetadataUrl=t,this.networks=n,this.config=s,this.context=i,this.account=r,this.metadata=a,this.authProvider=o,this._initialAuthRequest=void 0,this._jwt=void 0,this.proofStrings=new Map,this.onAuthCallbacks=[],this.apiClient=void 0,this.metadataClient=void 0,this.indexerClients=new Map,c&&(this._jwt={token:Promise.resolve(c.token),expiration:null!=(l=c.expiration)?l:_i(c.token)})}get name(){return this.metadata.name}get expiration(){return this.metadata.expiration?Math.max(this.metadata.expiration,120):vi}onAuth(e){this.onAuthCallbacks.push(e)}setAccount(e){this.account=e}setConfig(e){this.config=e}async auth(e=5){const t=this.sequenceApiUrl;if(!t)throw Error("No sequence api url");let n;for(let t=0;;t++)try{n=(await this.getJWT(!0)).token;break}catch(n){if(t===e-1)throw console.error(`couldn't authenticate after ${e} attempts`,n),n}return new x(t,n)}get isTestnetMode(){if(this.networks&&0!==this.networks.length)return!!this.networks[0].testnet}async getAPIClient(e=!0){if(!this.apiClient){const t=this.sequenceApiUrl;if(!t)throw Error("No chaind url");const n=(await this.getJWT(e)).token;this.apiClient=new x(t,n)}return this.apiClient}getMetadataClient(){return this.metadataClient||(this.metadataClient=new ls(this.sequenceMetadataUrl)),this.metadataClient}async getIndexerClient(e){const t=yt(this.networks,e);if(!t)throw Error(`No network for chain ${e}`);const n=(await this.getJWT(!0)).token;if(!this.indexerClients.has(t.chainId))if(t.indexer)this.indexerClients.set(t.chainId,t.indexer);else{if(!t.indexerUrl)throw Error(`No indexer url for chain ${e}`);this.indexerClients.set(t.chainId,new Zn(t.indexerUrl,n))}return this.indexerClients.get(t.chainId)}async getJWT(e){var t=this;const n=this.sequenceApiUrl;if(!n)throw Error("No chaind url");if(this._jwt){const e=this._jwt,t=await e.token;if(this.now()<e.expiration)return{token:t,expiration:e.expiration};this._jwt=void 0}if(!e)throw new Error("no auth token in memory");const s=this.getProofStringKey(),{proofString:i,expiration:r}=this.getProofString(s),a={token:i.then((async function(e){const i=new x(n),r=await i.getAuthToken({ewtString:e,testnetMode:t.isTestnetMode});if(!0===(null==r?void 0:r.status)&&0!==r.jwtToken.length)return r.jwtToken;throw await t.isProofStringValid(e)||t.proofStrings.delete(s),new Error("no auth token from server")})).catch((e=>{throw this._jwt=void 0,e})),expiration:r};return this._jwt=a,a.token.then((()=>{this.onAuthCallbacks.forEach((e=>{try{e({status:"fulfilled",value:void 0})}catch(e){}}))})).catch((e=>{this.onAuthCallbacks.forEach((t=>{try{t({status:"rejected",reason:e})}catch(e){}}))})),{token:await a.token,expiration:r}}getProofString(e){if(this.proofStrings.has(e)){const t=this.proofStrings.get(e);if(this.now()<t.expiration)return t;this.proofStrings.delete(e)}const t=new ce({address:this.account.address});t.claims.app=this.name,t.setExpiryIn(this.expiration);const n=new we,s=new _n(this.authProvider),i=this.account.authWallet(),r=this.now()+this.expiration-60,a={proofString:s.findCurrentConfig({address:i.wallet.address,provider:this.authProvider,context:i.wallet.context,knownConfigs:[i.wallet.config]}).then((e=>{if(!e.config)throw Error("Can't find latest config");return i.wallet.useConfig(e.config).sign(t.messageDigest()).then((e=>{const s=Nn(e),i=s.signers.filter(Sn).reduce(((e,t)=>e+t.weight),0);if(i<s.threshold)throw Error(`insufficient signing power, need ${s.threshold}, have ${i}`);return t.signature=e,n.encodeProof(t,!0)}))})).catch((t=>{throw this.proofStrings.delete(e),t})),expiration:r};return this.proofStrings.set(e,a),a}getProofStringKey(){return`${this.account.address} - ${this.name}`}async isProofStringValid(e){try{const t=new we;return t.provider=this.authProvider,await t.decodeProof(e),!0}catch(e){return!1}}async dump(){let e;if(this._jwt)try{const t=this._jwt.expiration;e={token:await this._jwt.token,expiration:t}}catch(e){}return{config:this.config,context:this.context,metadata:this.metadata,jwt:e}}now(){return Math.floor((new Date).getTime()/1e3)}static async open(e){const{sequenceApiUrl:t,sequenceMetadataUrl:n,context:s,networks:i,referenceSigner:r,signers:a,threshold:o,deepSearch:c,knownConfigs:l,noIndex:h,metadata:d}=e,u=Ei(i),p=e.configFinder?e.configFinder:new _n(u),g=Promise.all(a.map((async function(e){return yi({},e,{address:"string"==typeof e.signer?e.signer:await e.signer.getAddress()})}))),f=a.filter((e=>"string"!=typeof e.signer)).map((e=>e.signer)),w=(await p.findLastWalletOfInitialSigner({signer:r,context:s,provider:u,requireIndex:!c})).wallet;if(w){const e=(await p.findCurrentConfig({address:w,provider:u,context:s,knownConfigs:l})).config;if(!e)throw Error("Wallet config not found");const r=new pi({initialConfig:e,networks:i,context:s},...f),a=new Ci(t,n,i,e,s,r,d,u),[c]=await r.updateConfig(vn(e,{threshold:o,set:await g}),!h);return a.setConfig(c),a.setAccount(new pi({initialConfig:c,networks:i,context:s},...f)),a._initialAuthRequest=t?a.auth():Promise.reject("no sequence api url"),a}{const e=bn(o,await g),a=new pi({initialConfig:e,networks:i,context:s},...f);await a.publishConfig(!h,[r]);const c=new Ci(t,n,i,e,s,a,d,u);return c._initialAuthRequest=t?c.auth():Promise.reject("no sequence api url"),c}}static load(e){const{sequenceApiUrl:t,sequenceMetadataUrl:n,dump:s,signers:i,networks:r}=e;return new Ci(t,n,r,s.config,s.context,new pi({initialConfig:s.config,context:s.context,networks:r},...i),s.metadata,Ei(r),s.jwt)}}function Ei(e){var t;const n=ut(e);if(!n)throw Error("Auth chain not found");return null!=(t=n.provider)?t:new T.r(n.rpcUrl)}function _i(e){return Ue(e).exp}const ki=async(e,t)=>{const n=await e.getChainId(),s=O.getAddress(await e.getAddress());if(!s||""===s||"0x"===s)throw Ii;const i=new ce;if(i.address=s,!t||!t.app||""===t.app)throw new Si("authorization options requires app to be set");i.claims.app=t.app,i.claims.ogn=t.origin,i.setExpiryIn(t.expiry?Math.max(t.expiry,200):vi);const r=i.messageTypedData();i.signature=await e.signTypedData(r.domain,r.types,r.message,n);const a=new we;return{typedData:r,proofString:await a.encodeProof(i,!0)}};class Si extends Error{constructor(e){super(e),this.name="AuthError"}}const Ii=new Si("auth error: account address is empty"),xi=async(e,t,n)=>{if(!e||void 0===e||void 0===t)return{isValid:!1};const s=n.messageDigest(),i=await e.getCode(n.address);if("0x"===i||i.length<=2)throw new Error("ValidateSequenceDeployedWalletProof failed. unable to fetch wallet contract code");const r=new N.CH(n.address,["function isValidSignature(bytes32, bytes) public view returns (bytes4)"],e);return await r.isValidSignature(s,A.arrayify(n.signature))===ue?{isValid:!0}:{isValid:!1}},Ti=e=>async(t,n,s)=>{if(!t||void 0===t||void 0===n)return{isValid:!1};if(0!==A.arrayify(await t.getCode(s.address)).length)return{isValid:!1};const i=s.messageDigest(),r=A.arrayify(P.keccak256(i));return{isValid:!!await fi(s.address,r,s.signature,e||At,t,n)}};function Oi(){return Oi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Oi.apply(this,arguments)}const Ni="v1",Ai="v0.4.0",Pi="8d39664df13fabe72919e65140f9563b21aa3531";class Mi{constructor(e,t){this.hostname=void 0,this.fetch=void 0,this.path="/rpc/Guard/",this.ping=e=>this.fetch(this.url("Ping"),Ri({},e)).then((e=>Li(e).then((e=>({status:e.status}))))),this.version=e=>this.fetch(this.url("Version"),Ri({},e)).then((e=>Li(e).then((e=>({version:e.version}))))),this.runtimeStatus=e=>this.fetch(this.url("RuntimeStatus"),Ri({},e)).then((e=>Li(e).then((e=>({status:e.status}))))),this.getSequenceContext=e=>this.fetch(this.url("GetSequenceContext"),Ri({},e)).then((e=>Li(e).then((e=>({data:e.data}))))),this.getSignerConfig=e=>this.fetch(this.url("GetSignerConfig"),Ri({},e)).then((e=>Li(e).then((e=>({signerConfig:e.signerConfig}))))),this.sign=(e,t)=>this.fetch(this.url("Sign"),Ri(e,t)).then((e=>Li(e).then((e=>({sig:e.sig}))))),this.hostname=e,this.fetch=(e,n)=>t(e,n)}url(e){return this.hostname+this.path+e}}const Ri=(e={},t={})=>({method:"POST",headers:Oi({},t,{"Content-Type":"application/json"}),body:JSON.stringify(e||{})}),Li=e=>e.text().then((t=>{let n;try{n=JSON.parse(t)}catch(n){throw{code:"unknown",msg:`expecting JSON, got: ${t}`,status:e.status}}if(!e.ok)throw n;return n}));var Ui=n(91355),Di=n(8550),qi=n(87581);function Wi(){return Wi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Wi.apply(this,arguments)}class Bi extends URLSearchParams{static new(e){return new URLSearchParams(e)}}let Fi,$i,ji;!function(e){e.OPEN="open",e.CLOSE="close",e.MESSAGE="message",e.CONNECT="connect",e.DISCONNECT="disconnect",e.ACCOUNTS_CHANGED="accountsChanged",e.CHAIN_CHANGED="chainChanged",e.NETWORKS="networks",e.WALLET_CONTEXT="walletContext",e.INIT="init",e.DEBUG="_debug"}(Fi||(Fi={})),function(e){e[e.CLOSED=0]="CLOSED",e[e.OPENING=1]="OPENING",e[e.OPENED=2]="OPENED"}($i||($i={})),function(e){e[e.NIL=0]="NIL",e[e.SENT_NONCE=1]="SENT_NONCE",e[e.OK=2]="OK"}(ji||(ji={}));class Hi extends Error{constructor(e){super(e),this.name="ProviderError"}}const Gi=new Hi("Wallet is not signed in. Connect a wallet and try again."),Vi=3e4;let Ki=0;const Ji=()=>++Ki;class Yi{constructor(){var e=this;this.pendingMessageRequests=[],this.responseCallbacks=new Map,this.state=void 0,this.confirmationOnly=!1,this.events=new Ui.EventEmitter2,this.openPayload=void 0,this.connectPayload=void 0,this.accountsChangedPayload=void 0,this.networksPayload=void 0,this.walletContextPayload=void 0,this._sessionId=void 0,this._init=void 0,this._registered=void 0,this.sendAsync=async function(t,n,s){e.state===$i.CLOSED&&(e.confirmationOnly=!0),e.openWallet(void 0,{type:"jsonRpcRequest",method:t.method},s);try{e.isOpened()||await e.waitUntilOpened(),n(void 0,(await e.sendMessageRequest({idx:Ji(),type:Fi.MESSAGE,data:t,chainId:s})).data)}catch(e){n(e)}},this.sendMessageRequest=async function(t){return new Promise(((n,s)=>{(!t.idx||t.idx<=0)&&"init"!==t.type&&s(new Error("message idx not set"));const i=t.idx;e.responseCallbacks.get(i)?s(new Error("duplicate message idx, should never happen")):e.responseCallbacks.set(i,((e,t)=>{if(e)s(e);else{if(!t)throw new Error("no valid response to return");n(t)}})),e.isOpened()?e.sendMessage(t):(Be.debug("pushing to pending requests",t),e.pendingMessageRequests.push(t))}))},this.waitUntilOpened=async function(t=Vi){let n=!1;return Promise.race([new Promise(((s,i)=>{const r=setTimeout((()=>{clearTimeout(r),n||(e.state=$i.CLOSED,e.events.emit("close",{code:1005,message:"opening wallet timed out"})),i(new Error("opening wallet timed out"))}),t)})),new Promise((t=>{var s;if(e.isOpened())return n=!0,void t(null==(s=e.openPayload)?void 0:s.session);e.events.once("open",(s=>{e.openPayload=s,n=!0,t(s.session)}))}))])},this.waitUntilConnected=async function(){await e.waitUntilOpened();const t=new Promise((t=>{e.connectPayload?t(e.connectPayload):e.events.once("connect",(n=>{e.connectPayload=n,t(n)}))})),n=new Promise(((t,n)=>{e.events.once("close",(e=>{n(e?new Error(`wallet closed due to ${JSON.stringify(e)}`):new Error("user closed the wallet"))}))}));return Promise.race([t,n])},this.state=$i.CLOSED,this._registered=!1,this._init=ji.NIL}get registered(){return this._registered}register(){throw new Error("abstract method")}unregister(){throw new Error("abstract method")}openWallet(e,t,n){throw new Error("abstract method")}closeWallet(){throw new Error("abstract method")}isOpened(){return this.registered&&this.state===$i.OPENED}isConnected(){var e;const t=null==(e=this.openPayload)?void 0:e.session;return this.registered&&void 0!==t&&!!t.accountAddress&&42===t.accountAddress.length&&!!t.networks&&t.networks.length>0}handleMessage(e){var t=this;if(e.type===Fi.INIT){Be.debug("MessageProvider, received INIT message",e);const{nonce:t}=e.data;if(!t||0==t.length)return void Be.error("invalid init nonce");this._init=ji.OK,this.sendMessage({idx:-1,type:Fi.INIT,data:{sessionId:this._sessionId,nonce:t}})}if(this._init!==ji.OK)return;Be.debug("RECEIVED MESSAGE FROM WALLET",e.idx,e);const n=e.idx,s=this.responseCallbacks.get(n);if(n&&this.responseCallbacks.delete(n),e.type!==Fi.OPEN||this.isOpened()){if(e.type===Fi.MESSAGE){if(this.confirmationOnly&&setTimeout((()=>{0===this.responseCallbacks.size&&this.closeWallet()}),500),!s)throw new Error("impossible state");if(s)return this.events.emit("message",e),void s(e.data.error,e)}if(e.type===Fi.ACCOUNTS_CHANGED)return this.accountsChangedPayload={accounts:[]},void(e.data&&e.data.length>0?(this.accountsChangedPayload={accounts:[O.getAddress(e.data[0])],origin:e.origin},this.events.emit("accountsChanged",this.accountsChangedPayload.accounts,this.accountsChangedPayload.origin)):this.events.emit("accountsChanged",[],e.origin));if(e.type!==Fi.CHAIN_CHANGED){if(e.type===Fi.NETWORKS)return this.networksPayload=e.data,void this.events.emit("networks",this.networksPayload);if(e.type===Fi.WALLET_CONTEXT)return this.walletContextPayload=e.data,void this.events.emit("walletContext",this.walletContextPayload);e.type===Fi.CLOSE&&this.state!==$i.CLOSED&&this.close(e.data),e.type===Fi.CONNECT&&(this.connectPayload=e.data,this.events.emit("connect",this.connectPayload)),e.type===Fi.DISCONNECT&&this.isConnected()&&(this.events.emit("disconnect",e.data),this.close())}else this.events.emit("chainChanged",e.data)}else{var i,r;if(this._sessionId&&this._sessionId!==(null==(i=e.data)?void 0:i.sessionId))return void Be.debug("open event received from wallet, but does not match sessionId",this._sessionId);if(null!=(r=e.data)&&r.error){var a;const t=new Error(`opening wallet failed: received ${null==(a=e.data)?void 0:a.error}`);throw Be.error(t),this.close(),t}this.state=$i.OPENED,this.openPayload=e.data,this.events.emit("open",this.openPayload),0!==this.pendingMessageRequests.length&&this.pendingMessageRequests.splice(0,this.pendingMessageRequests.length).forEach((async function(e){t.sendMessage(e)}))}}sendMessage(e){throw new Error("abstract method")}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}emit(e,...t){return this.events.emit(e,...t)}close(e){this.state!==$i.CLOSED&&(this.state=$i.CLOSED,this.confirmationOnly=!1,this._sessionId=void 0,Be.info("closing wallet and flushing!"),this.pendingMessageRequests.length=0,this.responseCallbacks.forEach((e=>{e(Wi({},new Error("wallet closed"),{code:4001}))})),this.responseCallbacks.clear(),this.connectPayload=void 0,this.openPayload=void 0,this.accountsChangedPayload=void 0,this.networksPayload=void 0,this.walletContextPayload=void 0,this.events.emit("close",e))}}class zi{constructor(e,t,n,s,i=[]){var r=this;this.signer=void 0,this.signerReadyCallbacks=[],this.prompter=void 0,this.auxDataProvider=void 0,this.mainnetNetworks=void 0,this.testnetNetworks=void 0,this._openIntent=void 0,this._connectOptions=void 0,this._defaultNetworkId=void 0,this._chainId=void 0,this.events=new Ui.EventEmitter2,this.promptConnect=async function(e){if(!e&&!r._connectOptions)throw new Error("prompter connect options are empty");if(!r.prompter)return r.connect(e);const t=await r.prompter.promptConnect(e||r._connectOptions).catch((e=>({connected:!1}))),n=t;return n.connected&&!n.session&&(n.session=await r.walletSession()),t},this.sendAsync=async function(e,t,n){const s={jsonrpc:"2.0",id:e.id,result:null};await r.getSigner();try{if(!(r.signer&&null!==r.signer||Qi.includes(e.method)))throw Gi;const t=r.signer;if(!t)throw new Error("WalletRequestHandler: wallet signer is not configured");const i=await t.getProvider(n);if(!i)throw new Error(`WalletRequestHandler: wallet provider is not configured for chainId ${n}`);switch(e.method){case"net_version":{const e=await i.send("net_version",[]);s.result=e;break}case"eth_chainId":{const e=await i.send("eth_chainId",[]);s.result=e;break}case"eth_accounts":{const e=await t.getAddress();s.result=[e];break}case"eth_getBalance":{const[t,n]=e.params,r=await i.getBalance(t,n);s.result=r.toHexString();break}case"personal_sign":case"eth_sign":{let i;if("personal_sign"===e.method){const[t,n]=e.params;i=t}else{const[t,n]=e.params;i=n}let a="";const o=lr(i);if(null===r.prompter?a=await t.signMessage(o,n):await r.handleConfirmWalletDeployPrompt(r.prompter,t,n)&&(a=await r.prompter.promptSignMessage({chainId:n,message:o},r.connectOptions)),!(a&&a.length>0))throw new Error("declined by user");s.result=a;break}case"eth_signTypedData":case"eth_signTypedData_v4":{const[i,a]=e.params;let o;if("string"==typeof a)try{o=JSON.parse(a)}catch(e){}else o=a;if(!(o&&o.domain&&o.types&&o.message))throw new Error("invalid typedData object");let c="";if(null===r.prompter?c=await t.signTypedData(o.domain,o.types,o.message,n):await r.handleConfirmWalletDeployPrompt(r.prompter,t,n)&&(c=await r.prompter.promptSignMessage({chainId:n,typedData:o},r.connectOptions)),!(c&&c.length>0))throw new Error("declined by user");s.result=c;break}case"eth_sendTransaction":{const[i]=e.params;"gas"in i&&void 0===i.gasLimit&&(i.gasLimit=i.gas,delete i.gas);let a="";if(a=null===r.prompter?(await t.sendTransaction(i,n)).hash:await r.prompter.promptSendTransaction(i,n,r.connectOptions),!a)throw new Error("declined by user");s.result=a;break}case"eth_signTransaction":{const[i]=e.params;if(O.getAddress(i.from)!==await t.getAddress())throw new Error("sender address does not match wallet");null===r.prompter?s.result=await t.signTransactions(i,n):s.result=await r.prompter.promptSignTransaction(i,n,r.connectOptions);break}case"eth_sendRawTransaction":if(Rs(e.params[0])){const n=ye.O$.from(e.params[0].chainId).toNumber(),i=await(await t.getRelayer(n)).relay(e.params[0]);s.result=(await i).hash}else{const t=await i.sendTransaction(e.params[0]);s.result=t.hash}break;case"eth_getTransactionCount":{const n=O.getAddress(e.params[0]),r=e.params[1];if(n===O.getAddress(await t.getAddress())){const e=await t.getTransactionCount(r);s.result=ye.O$.from(e).toHexString()}else{const e=await i.getTransactionCount(n,r);s.result=ye.O$.from(e).toHexString()}break}case"eth_blockNumber":s.result=await i.getBlockNumber();break;case"eth_getBlockByNumber":case"eth_getBlockByHash":s.result=await i.getBlock(e.params[0]);break;case"eth_getTransactionByHash":s.result=await i.getTransaction(e.params[0]);break;case"eth_call":{const[t,n]=e.params;s.result=await i.call(t,n);break}case"eth_getCode":{const[t,n]=e.params;s.result=await i.getCode(t,n);break}case"eth_estimateGas":{const[t]=e.params;s.result=await i.estimateGas(t);break}case"eth_gasPrice":{const e=await i.getGasPrice();s.result=e.toHexString();break}case"wallet_switchEthereumChain":{const[t]=e.params;if(!t.chainId||0===t.chainId.length)throw new Error("invalid chainId");const n=ye.O$.from(t.chainId);if(!await r.setDefaultNetwork(n.toString(),!0))throw new Error(`unable to set chainId ${n}`);s.result=null;break}case"sequence_getWalletContext":s.result=await t.getWalletContext();break;case"sequence_getWalletConfig":{const[n]=e.params;s.result=await t.getWalletConfig(n);break}case"sequence_getWalletState":{const[n]=e.params;s.result=await t.getWalletState(n);break}case"sequence_getNetworks":s.result=await r.getNetworks(!0);break;case"sequence_updateConfig":throw new Error("sequence_updateConfig method is not allowed from a dapp");case"sequence_publishConfig":throw new Error("sequence_publishConfig method is not allowed from a dapp");case"sequence_gasRefundOptions":case"sequence_getNonce":case"sequence_relay":break;case"sequence_setDefaultNetwork":{const[t]=e.params;if(!t)throw new Error("invalid request, method argument defaultNetworkId cannot be empty");if(!await r.setDefaultNetwork(t))throw new Error(`unable to set default network ${t}`);s.result=await r.getNetworks(!0);break}default:{const t=await i.send(e.method,e.params);s.result=t}}}catch(e){Be.error(e),s.result=null,s.error=Wi({},new Error(e),{code:4001})}t(void 0,s)},this.isSignedIn=async function(){return await r.signerReady(),!!r.signer},this.getSigner=async function(){if(await r.signerReady(),void 0===r.signer)throw new Error("signerReady failed resolve");return r.signer},this.signer=e,this.prompter=t,this.auxDataProvider=n,this.mainnetNetworks=s,this.testnetNetworks=i}async signIn(e,t={}){this.setSigner(e);const{connect:n,mainnetNetworks:s,testnetNetworks:i,defaultNetworkId:r}=t;if(s&&s.length>0&&(this.mainnetNetworks=s),i&&i.length>0&&(this.testnetNetworks=i),!(this.mainnetNetworks&&0!==this.mainnetNetworks.length||this.testnetNetworks&&0!==this.testnetNetworks.length))throw new Error("signIn failed as network configuration is empty");const a=r||this._defaultNetworkId;if(a&&!await this.setDefaultNetwork(a,!1))throw new Error(`WalletRequestHandler setup unable to set defaultNetworkId ${a}`);if(n){const e=this._connectOptions,t=await this.connect(e);this.notifyConnect(t),e&&!0===e.keepWalletOpened||this.notifyClose()}}signOut(){this.setSigner(null)}signerReset(){this.signer=void 0}signerReady(e=1e4){return new Promise(((t,n)=>{void 0!==this.signer?t():(setTimeout((()=>{void 0===this.signer&&(this.signerReadyCallbacks=[],n("signerReady timed out"))}),e),this.signerReadyCallbacks.push(t))}))}async connect(e){if(!this.signer)return{connected:!1,chainId:"0x0",error:"unable to connect without signed in account"};const t={connected:!0,chainId:A.hexlify(await this.getChainId())};if(e&&e.askForEmail){var n;const e=await(null==(n=this.auxDataProvider)?void 0:n.get("email"));e&&(t.email=e)}if(e&&e.authorize){const n={app:e.app,origin:e.origin,expiry:e.expiry};try{t.proof=await ki(this.signer,n)}catch(t){return Be.warn(`connect, signAuthorization failed for options: ${JSON.stringify(e)}, due to: ${t.message}`),{connected:!1,chainId:"0x0",error:`signAuthorization failed: ${t.message}`}}}return t.session=await this.walletSession(),t}sendMessageRequest(e){return new Promise((t=>{this.sendAsync(e.data,((n,s)=>{const i=Wi({},e,{data:s});t(i)}),e.chainId)}))}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}async getAddress(){return this.signer?this.signer.getAddress():""}async getChainId(){return this.signer?(this._chainId||(this._chainId=await this.signer.getChainId()),this._chainId):0}get openIntent(){return this._openIntent}setOpenIntent(e){this._openIntent=e}get connectOptions(){return this._connectOptions}setConnectOptions(e){this._connectOptions=e}get defaultNetworkId(){return this._defaultNetworkId}async setDefaultNetwork(e,t=!0){if(e&&(this._defaultNetworkId=e,this._chainId=void 0,this.signer&&this.signer.setNetworks)){const n=this.signer.setNetworks(this.mainnetNetworks,this.testnetNetworks,e);return n&&t&&await this.notifyNetworks(),n}}async getNetworks(e){if(!this.signer)return Be.warn("signer not set: getNetworks is returning an empty list"),[];const t=await this.signer.getNetworks();return e?t.map((e=>{const t=Wi({},e);return t.provider=void 0,t.relayer=void 0,t})):t}async walletSession(){return this.signer?{walletContext:await this.signer.getWalletContext(),accountAddress:await this.signer.getAddress(),networks:await this.getNetworks(!0)}:void 0}notifyConnect(e,t){var n,s;this.events.emit("connect",e),null!=(n=e.session)&&n.accountAddress&&this.events.emit("accountsChanged",[null==(s=e.session)?void 0:s.accountAddress],t)}notifyDisconnect(e){this.events.emit("accountsChanged",[],e),this.events.emit("disconnect")}async notifyNetworks(e){const t=e||await this.getNetworks(!0);if(this.events.emit("networks",t),t.length>0){const e=t.find((e=>e.isDefaultChain));e&&this.events.emit("chainChanged",A.hexlify(e.chainId))}else this.events.emit("chainChanged","0x0")}async notifyWalletContext(){if(!this.signer)return void Be.warn("signer not set: skipping to notify wallet context");const e=await this.signer.getWalletContext();this.events.emit("walletContext",e)}notifyClose(e){this.events.emit("close",e)}setSigner(e){if(this.signer=e,void 0!==e){for(let e=0;e<this.signerReadyCallbacks.length;e++)this.signerReadyCallbacks[e]();this.signerReadyCallbacks=[]}}async handleConfirmWalletDeployPrompt(e,t,n){return!n||(!!await wr(t,n)||!!await e.promptConfirmWalletDeploy(n,this.connectOptions)&&(!!await wr(t,n)||(Be.error("WalletRequestHandler: result for promptConfirmWalletDeploy is not correct"),!1)))}}const Qi=["net_version","eth_chainId","eth_getBalance","eth_getTransactionCount","eth_blockNumber","eth_getBlockByNumber","eth_getBlockByHash","eth_getTransactionByHash","eth_getCode","eth_estimateGas","eth_gasPrice","sequence_getWalletContext","sequence_getNetworks","sequence_setDefaultNetwork"];class Zi extends Di.Q{static isSequenceProvider(e){return Xi(e)}constructor(e,t){const n=new qt(e,dt(t));super(e=n,"any"),this._sender=void 0,this._isSequenceProvider=void 0,this._defaultChainId=void 0,this._sender=n,this._isSequenceProvider=!0,this._defaultChainId=dt(t)}sendAsync(e,t,n){this._sender.sendAsync(e,t,n)}send(e,t,n){return this._sender.send(e,t,n)}request(e){return this.send(e.method,e.params||[],e.chainId)}getSigner(){return new tr(this,this._defaultChainId)}async getChainId(){const e=await this.send("eth_chainId",[]),t=ye.O$.from(e).toNumber();if(this._defaultChainId&&this._defaultChainId!==t)throw new Error(`provider chainId (${t}) does not match provider-bound chainId ${this._defaultChainId}`);return t}}function Xi(e){const t=e;return t&&void 0!==t.send&&!0===t._isSequenceProvider}class er extends Zi{constructor(e,t){super(new zi(e,null,null,t||[]))}}class tr extends oi{constructor(e,t){super(),this.provider=void 0,this.defaultChainId=void 0,this._address=void 0,this._index=void 0,this._context=void 0,this._networks=void 0,this._providers={},this.provider=e,this.defaultChainId=t}async getAddress(){if(this._address)return this._address;const e=await this.provider.send("eth_accounts",[]);return this._address=e[0],this._index=0,O.getAddress(this._address)}signTransaction(e){throw new Error("signTransaction is unsupported, use signTransactions instead")}connect(e){throw new Error("unsupported: cannot alter JSON-RPC Signer connection")}async getProvider(e){if(e){const t=await this.getChainId();if(t!==e)throw new Error(`signer is attempting to access chain ${e}, but is already bound to chain ${t}`)}return this.provider}async getSender(e){return!e||e&&e===this.defaultChainId?this.provider:(this._providers[e]||(this._providers[e]=new Zi(new qt(this.provider,e),e)),this._providers[e])}getRelayer(e){throw new Error("TODO")}async getWalletContext(){return this._context||(this._context=await this.provider.send("sequence_getWalletContext",[])),this._context}async getWalletConfig(e){return await this.provider.send("sequence_getWalletConfig",[dt(e)],dt(e)||this.defaultChainId)}async getWalletState(e){return await this.provider.send("sequence_getWalletState",[dt(e)],dt(e)||this.defaultChainId)}async getNetworks(){return this._networks||(this._networks=await this.provider.send("sequence_getNetworks",[])),this._networks}async getSigners(){const e=(await this.getNetworks()).find((e=>e.isAuthChain));if(!e)throw new Error("authChainId could not be determined from network list");const t=await this.getWalletConfig(e);if(!t||0===t.length)throw new Error("walletConfig returned zero results for authChainId {authChainId}");return t[0].signers.map((e=>e.address))}async signMessage(e,t,n){const s=await this.getSender(dt(t)||this.defaultChainId),i="string"==typeof e?ke.Y0(e):e,r=await this.getAddress();return await s.send("personal_sign",[A.hexlify(i),r])}async signTypedData(e,t,n,s,i){return await this.provider.send("eth_signTypedData_v4",[await this.getAddress(),M.E.getPayload(e,t,n)],dt(s)||this.defaultChainId)}async sendTransaction(e,t,n){const s=await this.getSender(dt(t)||this.defaultChainId);return this.sendUncheckedTransaction(e,t).then((e=>qi.poll((()=>s.getTransaction(e).then((t=>{if(null!==t)return s._wrapTransaction(t,e)}))),{onceBlock:this.provider}).catch((t=>{throw t.transactionHash=e,t}))))}async sendTransactionBatch(e,t,n){const s=await di(e);if(!s||0===s.length)throw new Error("cannot send empty batch");if(s.find((e=>void 0!==e.wait&&null!==e.wait)))throw new Error("transaction request expected for sendTransactionBatch, transaction response found");const i=Wi({},s[0]);return s.length>1&&(i.auxiliary=s.splice(1)),this.sendTransaction(i,t,n)}signTransactions(e,t,n){return e=nt(e),this.provider.send("eth_signTransaction",[e],dt(t)||this.defaultChainId)}sendSignedTransactions(e,t){throw new Error("TODO")}async updateConfig(e){const[t,n]=await this.provider.send("sequence_updateConfig",[e],this.defaultChainId);return null===n?[t,void 0]:[t,(await this.getSender(this.defaultChainId))._wrapTransaction(n,n.hash)]}async publishConfig(){const e=await this.getSender(this.defaultChainId),t=await e.send("sequence_publishConfig",[]);if(null!==t)return e._wrapTransaction(t,t.hash)}async isDeployed(e){const t=await this.getSender(dt(e)),n=await t.getCode(await this.getAddress());return!!n&&"0x"!==n}async _legacySignMessage(e,t,n){const s=await this.getSender(dt(t)||this.defaultChainId),i="string"==typeof e?ke.Y0(e):e,r=await this.getAddress();return await s.send("eth_sign",[r,A.hexlify(i)])}async _signTypedData(e,t,n,s,i){return this.signTypedData(e,t,n,s,i)}async sendUncheckedTransaction(e,t){e=nt(e);const n=this.getAddress(),s=await this.getSender(dt(t)||this.defaultChainId);return et({tx:et(e),sender:await n}).then((({tx:t,sender:n})=>{if(null!=t.from){if(O.getAddress(t.from)!==n)throw new Error(`from address mismatch for transaction ${e}`)}else t.from=n;const i=sr(t);return s.send("eth_sendTransaction",[i]).then((e=>e),(e=>{throw e}))}))}connectUnchecked(){throw new Error("connectUnchecked is unsupported")}async unlock(e){const t=await this.getAddress();return this.provider.send("personal_unlockAccount",[t,e,null])}}const nr={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,value:!0,from:!0,auxiliary:!0,expiration:!0,afterNonce:!0,delegateCall:!0,revertOnError:!0},sr=(e,t)=>{const n=nt(nr);if(t)for(const e in t)t[e]&&(n[e]=!0);hs.checkProperties(e,n);const s={};["gasLimit","gasPrice","nonce","value"].forEach((t=>{const n=e[t];if(null==n)return;const i=A.hexValue(n);"gasLimit"===t&&(t="gas"),s[t]=i})),["from","to","data"].forEach((t=>{e[t]&&(s[t]=A.hexlify(e[t]))})),["delegateCall","revertOnError"].forEach((t=>{const n=e[t];null!=n&&(s[t]=n)}));const i=e.auxiliary;return i&&i.length>0&&(s.auxiliary=[],i.forEach((e=>{s.auxiliary.push(sr(e))}))),s},ir=[{name:"Decentraland Exception",predicate:function(e){try{const t=ke.ZN(e);return rr.test(t)}catch(e){return!1}}},{name:"0x v3 Exception",predicate:function(e){const t=new at.vU(ar);try{return t.decodeFunctionData("OrderWithHash",e),!0}catch(e){return!1}}}],rr=/^Decentraland Login\nEphemeral address: 0x[a-fA-F0-9]{40}\nExpiration: (\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)((-(\d{2}):(\d{2})|Z)?)$/,ar=[{inputs:[{components:[{internalType:"address",name:"makerAddress",type:"address"},{internalType:"address",name:"takerAddress",type:"address"},{internalType:"address",name:"feeRecipientAddress",type:"address"},{internalType:"address",name:"senderAddress",type:"address"},{internalType:"uint256",name:"makerAssetAmount",type:"uint256"},{internalType:"uint256",name:"takerAssetAmount",type:"uint256"},{internalType:"uint256",name:"makerFee",type:"uint256"},{internalType:"uint256",name:"takerFee",type:"uint256"},{internalType:"uint256",name:"expirationTimeSeconds",type:"uint256"},{internalType:"uint256",name:"salt",type:"uint256"},{internalType:"bytes",name:"makerAssetData",type:"bytes"},{internalType:"bytes",name:"takerAssetData",type:"bytes"},{internalType:"bytes",name:"makerFeeAssetData",type:"bytes"},{internalType:"bytes",name:"takerFeeAssetData",type:"bytes"}],internalType:"struct IEIP1271Data.Order",name:"order",type:"tuple"},{internalType:"bytes32",name:"orderHash",type:"bytes32"}],name:"OrderWithHash",outputs:[],stateMutability:"pure",type:"function"}],or=ke.Y0("Ethereum Signed Message:\n"),cr=e=>A.isBytes(e)||A.isHexString(e)?A.arrayify(e):ke.Y0(e),lr=e=>{const t=cr(e);return function(e){return ir.some((t=>t.predicate(e)))}(t)?t:A.concat([or,ke.Y0(String(t.length)),t])},hr=async(e,t,n,s,i,r)=>{var a;return i||(i=null==(a=await s.getNetwork())?void 0:a.chainId),!r&&Zi.isSequenceProvider(s)&&(r=await s.getSigner().getWalletContext()),gi(e,t,n,s,r,i)},dr=async(e,t,n,s,i,r)=>{const a=lr(t),o=Ae(a);return hr(e,o,n,s,i,r)},ur=(e,t,n,s,i,r)=>hr(e,Qe(t),n,s,i,r),pr=async(e,t,n,s,i)=>{const r=Pe(e,s,t),a=await(async(e,t,n,s,i,r)=>{const a=A.arrayify(P.keccak256(e));return mi(a,t,void 0,void 0,void 0,void 0)})(r,n);if(i){const e=gn(a,i);if(a.address&&a.address!==e)throw new Error("recovered address does not match the WalletConfig address, check the WalletContext");a.address=e}return a},gr=()=>"chrome-extension:"===window.location.protocol||"moz-extension:"===window.location.protocol,fr=()=>!!navigator.userAgent.match(/UnitySequence/i),wr=async(e,t)=>{var n;const s=await e.getWalletState(),i=await e.getNetworks(),r=s.find((e=>e.chainId===t));if(!r)throw new Error(`WalletRequestHandler: could not find wallet state for chainId ${t}`);const a=r.deployed;if(!i)throw new Error("isWalletUpToDate util: could not get networks from signer");const o=i.find((e=>e.isAuthChain));if(!o)throw new Error("isWalletUpToDate util: could not get auth chain network information");const c=o.chainId,l=null==(n=s.find((e=>e.chainId===c)))?void 0:n.config;if(!l)throw new Error("isWalletUpToDate util: could not get auth chain config");const h=r.config;if(!h)throw new Error(`isWalletUpToDate util: could not get config for chainId ${t}`);const d=mn(l,h);return a&&d};class mr{constructor(){}static getInstance(){return mr._instance||(mr._instance={getItem:e=>Promise.resolve(window.localStorage.getItem(e)),setItem:(e,t)=>Promise.resolve(window.localStorage.setItem(e,t)),removeItem:e=>Promise.resolve(window.localStorage.removeItem(e))}),this._instance}static use(e){mr._instance=e}}mr._instance=void 0;class yr{constructor(e,t){this.def=t,this.key=void 0,this.key=e}async get(){const e=await mr.getInstance().getItem(this.key);if(null===e)return this.def;try{return JSON.parse(e)}catch(e){console.error(e)}}set(e){e?mr.getInstance().setItem(this.key,JSON.stringify(e)):mr.getInstance().removeItem(this.key)}del(){mr.getInstance().removeItem(this.key)}}const vr="@sequence.transportSession";class br{constructor(e){var t=this;this.walletRequestHandler=void 0,this._sessionId=void 0,this._registered=void 0,this._init=void 0,this._initNonce=void 0,this._initCallback=void 0,this.appOrigin=void 0,this.sendAsync=async function(e,t,n){throw new Error("abstract method")},this.handleMessage=async function(e){const n=e;if(t._init===ji.OK)switch(n.type){case Fi.OPEN:{if(t._init!==ji.OK)return;const e={sessionId:n.data.sessionId,intent:n.data.intent,networkId:n.data.networkId};return void await t.open(e)}case Fi.CLOSE:return t._init,void ji.OK;case Fi.MESSAGE:{const e=await t.walletRequestHandler.sendMessageRequest(n);return t.sendMessage(e),void e.data.error}default:Be.error(`unexpected payload type ${n.type}`)}else if(n.type===Fi.INIT){if(!t.isValidInitAck(e))return void(t._initCallback&&t._initCallback("invalid init"));t._initCallback&&t._initCallback()}},this.sendMessageRequest=async function(e){return t.walletRequestHandler.sendMessageRequest(e)},this.open=async function({sessionId:e,intent:n,networkId:s}){if(e&&(t._sessionId=Ve(e),t.saveTransportSession({sessionId:e,intent:n,networkId:s})),t.walletRequestHandler.setOpenIntent(n),await t.init(),n&&"connect"===n.type&&n.options){const e=n.options,i=e;if(t.appOrigin&&null!=i&&i.origin){if(!gr()&&i.origin!==t.appOrigin)throw new Error("origin is invalid")}else!t.appOrigin&&null!=i&&i.origin?e.origin=Je(i.origin):t.appOrigin&&(e.origin=t.appOrigin);e.app&&(e.app=Ke(e.app)),t.walletRequestHandler.setConnectOptions(e),e.networkId&&(s=e.networkId)}else t.walletRequestHandler.setConnectOptions(void 0);if(await t.walletRequestHandler.getSigner(),!await t.walletRequestHandler.isSignedIn())return t.notifyOpen({sessionId:t._sessionId}),!0;{let e;try{e=s?await t.walletRequestHandler.setDefaultNetwork(s,!1):await t.walletRequestHandler.getChainId()}catch(e){console.error(e)}if(!e||e<=0)return t.notifyOpen({sessionId:t._sessionId,error:`failed to open wallet on network ${s}`}),!1;if(n&&"connect"===n.type){t.notifyOpen({sessionId:t._sessionId});try{const e=await t.walletRequestHandler.promptConnect(n.options);e.connected&&t.walletRequestHandler.notifyConnect(e)}catch(e){Be.warn("promptConnect not connected:",e)}finally{n.options&&!0===n.options.keepWalletOpened||t.notifyClose()}}else t.notifyOpen({sessionId:t._sessionId,chainId:`${e}`,session:await t.walletRequestHandler.walletSession()})}return!0},this.saveTransportSession=e=>{mr.getInstance().setItem(vr,JSON.stringify(e))},this.getCachedTransportSession=async function(){const e=await mr.getInstance().getItem(vr);try{return e?JSON.parse(e):null}catch(t){return console.error(`unable to parse transport session: ${e}`),null}},this.walletRequestHandler=e,this._init=ji.NIL,this.walletRequestHandler.on("connect",(e=>{this.registered&&this.notifyConnect(e)})),this.walletRequestHandler.on("disconnect",(e=>{this.registered&&this.notifyDisconnect(e)})),this.walletRequestHandler.on("accountsChanged",((e,t)=>{this.registered&&this.notifyAccountsChanged(e,t)})),this.walletRequestHandler.on("networks",(e=>{this.registered&&(this.notifyNetworks(e),e&&0!==e.length?this.notifyChainChanged(A.hexlify(e.find((e=>e.isDefaultChain)).chainId)):this.notifyChainChanged("0x0"))})),this.walletRequestHandler.on("walletContext",(e=>{this.registered&&e&&this.notifyWalletContext(e)})),this.walletRequestHandler.on("close",(e=>{this.registered&&this.notifyClose(e)}))}get registered(){return this._registered}register(){throw new Error("abstract method")}unregister(){throw new Error("abstract method")}sendMessage(e){throw new Error("abstract method")}notifyOpen(e){const{chainId:t,sessionId:n,session:s,error:i}=e;this.sendMessage({idx:-1,type:Fi.OPEN,data:{chainId:t,sessionId:n,session:s,error:i}})}notifyClose(e){this.sendMessage({idx:-1,type:Fi.CLOSE,data:e?{error:e}:null})}notifyConnect(e){this.sendMessage({idx:-1,type:Fi.CONNECT,data:e})}notifyDisconnect(e){this.sendMessage({idx:-1,type:Fi.DISCONNECT,data:e?{error:e}:null})}notifyAccountsChanged(e,t){this.sendMessage({idx:-1,type:Fi.ACCOUNTS_CHANGED,data:e,origin:t})}notifyChainChanged(e){this.sendMessage({idx:-1,type:Fi.CHAIN_CHANGED,data:e})}notifyNetworks(e){this.sendMessage({idx:-1,type:Fi.NETWORKS,data:e})}notifyWalletContext(e){this.sendMessage({idx:-1,type:Fi.WALLET_CONTEXT,data:e})}isValidInitAck(e){if(this._init===ji.OK)return Be.warn("isValidInitAck, already in init'd state, so inquiry is invalid."),!1;if(e.type!==Fi.INIT)return Be.warn("isValidInitAck, invalid message type, expecting init"),!1;const{sessionId:t,nonce:n}=e.data;return t&&0!==t.length&&n&&0!==n.length?t===this._sessionId&&n===this._initNonce||(Be.error("invalid init ack match"),!1):(Be.error("invalid init ack"),!1)}init(){return new Promise(((e,t)=>{if(this._init===ji.OK)return void e();if(this._init!==ji.NIL||this._initCallback)return void t("transport init is in progress");const n=setTimeout((()=>{Be.warn("transport init timed out"),this._initCallback&&this._initCallback("transport init timed out")}),Vi/2);this._initCallback=s=>{this._initCallback=void 0,clearTimeout(n),s?t(s):(this._init=ji.OK,e())},this._initNonce=`${performance.now()}`,this.sendMessage({idx:-1,type:Fi.INIT,data:{nonce:this._initNonce}}),this._init=ji.SENT_NONCE}))}}class Cr{constructor(){this.app=void 0,this.wallet=void 0;const e=new Er,t=new Er;e.conn=t,t.conn=e,this.app=e,this.wallet=t}}class Er{constructor(){this.conn=void 0,this.events=new Ui.EventEmitter2,this.handleMessage=e=>{throw new Error("ProxyMessageChannelPort is not registered")},this.sendMessage=e=>{this.conn.handleMessage(e),"open"===e.type&&this.events.emit("open",e),"close"===e.type&&this.events.emit("close",e),"connect"===e.type&&this.events.emit("connect",e),"disconnect"===e.type&&this.events.emit("disconnect",e)}}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}}class _r extends Yi{constructor(e){if(super(),this.port=void 0,this.register=()=>{this.port.handleMessage=e=>{this.handleMessage(e)},this.on("open",((...e)=>{this.port.events.emit("open",...e)})),this.on("close",((...e)=>{this.port.events.emit("close",...e)})),this.on("connect",((...e)=>{this.port.events.emit("connect",...e)})),this.on("disconnect",((...e)=>{this.port.events.emit("disconnect",...e)})),this._registered=!0},this.unregister=()=>{this._registered=!1,this.closeWallet(),this.events.removeAllListeners(),this.port.handleMessage=void 0},this.openWallet=(e,t,n)=>{if(this.state===$i.CLOSED){this.state=$i.OPENING;const s=`${performance.now()}`;this._sessionId=s,this.sendMessage({idx:-1,type:Fi.OPEN,data:{path:e,intent:t,networkId:n,sessionId:s}})}},this.state=$i.CLOSED,this.port=e,!e)throw new Error("port argument cannot be empty");this._init=ji.OK}closeWallet(){this.sendMessage({idx:-1,type:Fi.CLOSE,data:null}),this.close()}sendMessage(e){if(!e.idx)throw new Error("message idx is empty");this.port.sendMessage(e)}}class kr extends br{constructor(e,t){super(e),this.port=void 0,this.port=t,this._init=ji.OK}register(){this.port.handleMessage=e=>{this.handleMessage(e)},this._registered=!0}async restoreSession(){const e=await this.getCachedTransportSession();e&&this.open(e)}unregister(){this.port.handleMessage=void 0,this._registered=!1}sendMessage(e){this.port.sendMessage(e)}}class Sr{constructor(...e){var t=this;this.messageProviders=void 0,this.provider=void 0,this.register=()=>{if(1===this.messageProviders.length)return this.provider=this.messageProviders[0],void this.provider.register();this.messageProviders.forEach((e=>{e.register(),e.once("open",(()=>{this.provider||(this.provider=e,this.messageProviders.forEach((e=>{this.provider!==e&&e.unregister()})))}))}))},this.unregister=()=>{this.messageProviders.forEach((e=>e.unregister())),this.provider=void 0},this.openWallet=(e,t,n)=>{this.provider?this.provider.openWallet(e,t,n):this.messageProviders.forEach((s=>s.openWallet(e,t,n)))},this.sendAsync=async function(e,n,s){if(!t.provider)throw new Error("impossible state, wallet must be opened first");t.provider.sendAsync(e,n,s)},this.sendMessageRequest=async function(e){if(t.provider)return t.provider.sendMessageRequest(e);throw new Error("impossible state, wallet must be opened first")},this.waitUntilOpened=async function(){return t.provider?t.provider.waitUntilOpened():Promise.race(t.messageProviders.map((e=>e.waitUntilOpened())))},this.waitUntilConnected=async function(){if(t.provider)return t.provider.waitUntilConnected();throw new Error("impossible state, wallet must be opened first")},this.messageProviders=e,this.provider=void 0}add(...e){this.messageProviders.push(...e)}closeWallet(){this.provider&&this.provider.closeWallet()}isOpened(){return!!this.provider&&this.provider.isOpened()}isConnected(){return!!this.provider&&this.provider.isConnected()}on(e,t){this.provider?this.provider.on(e,t):this.messageProviders.forEach((n=>{n.on(e,t)}))}once(e,t){this.provider?this.provider.once(e,t):this.messageProviders.forEach((n=>{n.once(e,t)}))}emit(e,...t){if(this.provider)return this.provider.emit(e,...t);for(let n=0;n<this.messageProviders.length;n++)this.messageProviders[n].emit(e,...t);return!0}sendMessage(e){if(!e.idx||e.idx<=0)throw new Error("message idx is empty");if(!this.provider)throw new Error("impossible state, wallet must be opened first");this.provider.sendMessage(e)}handleMessage(e){if(!this.provider)throw new Error("impossible state, wallet must be opened first");this.provider.handleMessage(e)}}let Ir;class xr extends Yi{constructor(e){super(),this.walletURL=void 0,this.walletWindow=void 0,this.register=()=>{Ir&&(Ir.unregister(),Ir=this),window.addEventListener("message",this.onWindowEvent),Ir=this,this.on("open",(()=>{const e=this.walletWindow,t=setInterval((()=>{e&&e.closed&&(clearInterval(t),this.close())}),500)})),this.on("close",(()=>{this.walletWindow&&(this.walletWindow.close(),this.walletWindow=null)})),this._registered=!0},this.unregister=()=>{this._registered=!1,this.closeWallet(),Ir===this&&(Ir=void 0),window.removeEventListener("message",this.onWindowEvent),this.events.removeAllListeners()},this.openWallet=(e,t,n)=>{if(this.walletWindow&&this.isOpened())return void this.walletWindow.focus();const s=new URL(this.walletURL.href),i=new Bi;let r,a;e&&""!==e&&(s.pathname=e.toLowerCase()),this._init=ji.NIL,this._sessionId=`${performance.now()}`,i.set("sid",this._sessionId),t&&("connect"===t.type&&(t.options||(t.options={}),gr()||fr()||(t.options.origin=window.location.origin)),i.set("intent",Te(t))),n&&i.set("net",`${n}`),gr()?(r=[450,750],a=[Math.abs(window.screen.width/2-r[0]/2),Math.abs(window.screen.height/2-r[1]/2)]):(r=[450,750],a=[Math.abs(window.screenX+window.innerWidth/2-r[0]/2),Math.abs(window.screenY+window.innerHeight/2-r[1]/2)]);const o=`toolbar=0,location=0,menubar=0,scrollbars=yes,status=yes,width=${r[0]},height=${r[1]},left=${a[0]},top=${a[1]}`;s.search=i.toString(),this.walletWindow=window.open(s.href,"sequence.app",o)},this.onWindowEvent=e=>{if(e.origin!==this.walletURL.origin)return;let t;try{t=JSON.parse(e.data)}catch(e){return}if(!t)throw new Error("ProviderMessage object is empty");this.handleMessage(t)},this.walletURL=new URL(e)}closeWallet(){var e;this.close(),null==(e=this.walletWindow)||e.close()}sendMessage(e){if(!this.walletWindow)return void Be.warn("WindowMessageProvider: sendMessage failed as walletWindow is unavailable");const t="string"!=typeof e?JSON.stringify(e):e;this.walletWindow.postMessage(t,this.walletURL.origin)}}class Tr extends br{constructor(e){var t;super(e),t=this,this.parentWindow=void 0,this._isPopup=!1,this.onWindowEvent=async function(e){if(!e.origin||""===e.origin)return;if(t.appOrigin&&e.origin!==t.appOrigin)return;let n;try{n=JSON.parse(e.data)}catch(e){return}Be.debug("RECEIVED MESSAGE",n),t._init!==ji.OK&&t.isValidInitAck(n)&&(t.appOrigin=e.origin),t._init!==ji.OK||t.appOrigin&&!(t.appOrigin.length<8)?t.handleMessage(n):Be.error("impossible state, init.OK and appOrigin required")},this.getWindowTransportSession=e=>{const t=new Bi(e);return{sessionId:t.get("sid"),networkId:t.get("net"),intent:Ne(t.get("intent"))}},this._init=ji.NIL}async register(e){const t=null!==parent.window.opener;if(this._isPopup=t,!0!==t)return;const{pathname:n,search:s}=new URL(e||window.location.href);let i=this.getWindowTransportSession(s);!!i.sessionId||(i=await this.getCachedTransportSession()),i?(this.parentWindow=parent.window.opener,window.addEventListener("message",this.onWindowEvent,!1),this._registered=!0,this.open(i).then((e=>{if(!e){var t;const e=`failed to open to network ${null==(t=i)?void 0:t.networkId}`;Be.error(e),this.notifyClose({message:e}),window.close()}})).catch((e=>{var t;const n=`failed to open to network ${null==(t=i)?void 0:t.networkId}, due to: ${e}`;Be.error(n),this.notifyClose({message:n}),window.close()}))):Be.error("window session is undefined")}unregister(){window.removeEventListener("message",this.onWindowEvent),this._registered=!1}sendMessage(e){const t=JSON.stringify(e);e.type===Fi.INIT?this.postMessage(t,!0):this.postMessage(t)}get isPopup(){return this._isPopup}postMessage(e,t=!1){!0===t||this._init===ji.OK?t?this.parentWindow.postMessage(e,"*"):this.appOrigin&&this.appOrigin.length>4?this.parentWindow.postMessage(e,this.appOrigin):Be.error("unable to postMessage as parentOrigin is invalid"):Be.error("impossible state, should not be calling postMessage until inited")}}const Or="sequence-extension-message-handler";class Nr extends br{constructor(e,t){super(e),this.runtime=t,this.port=void 0,this._init=ji.OK}register(){this._registered=!0,this.port=this.runtime.connect({name:Or})}sendMessage(e){Be.info("[ExtensionMessageHandler send]",e),this.port.postMessage(e)}}class Ar extends Yi{constructor(e){super(),this.register=()=>{this._registered=!0},e.onConnect.addListener((e=>{e.name===Or&&(this._init=ji.OK,e.onMessage.addListener((e=>{this.handleMessage(e)})))}))}sendMessage(e){}unregister(){}openWallet(e,t,n){}closeWallet(){}}class Pr extends Ui.EventEmitter2{constructor(e){var t;super(),t=this,this.stream=e,this.responseCallbacks=new Map,this._messageIdx=0,this.nextMessageIdx=()=>++this._messageIdx,this.handleMessage=e=>{if(!e.type||!e.data)return;Be.info("[received message]",e);const t=e.idx,n=this.responseCallbacks.get(t);switch(t&&this.responseCallbacks.delete(t),e.type){case Fi.MESSAGE:if(!n)throw new Error("impossible state");this.emit(Fi.MESSAGE,e),n(e.data.error,e);break;case Fi.DISCONNECT:case Fi.ACCOUNTS_CHANGED:case Fi.CHAIN_CHANGED:this.emit(e.type,e.data);break;default:console.error("unknown message type",e)}},this.sendMessageRequest=async function(e){return new Promise(((n,s)=>{(!e.idx||e.idx<=0)&&s(new Error("message idx not set"));const{idx:i}=e;t.responseCallbacks.get(i)?s(new Error("duplicate message idx, should never happen")):t.responseCallbacks.set(i,((e,t)=>{if(e)s(e);else{if(!t)throw new Error("no valid response to return");n(t)}})),t.sendMessage(e)}))},this.stream.on("data",this.handleMessage)}sendMessage(e){this.stream.writable||console.error("window post message stream is not writable"),this.stream.write(e)}}function Mr(e){var t;if(null!=(t=window.ue)&&t.sequencewallettransport&&!window.logsOverriddenForUnreal){var n;const t=null==(n=window.ue)?void 0:n.sequencewallettransport;console.log=(...n)=>{t.logfromjs(`${e}: ${Rr(n)}`)},console.warn=(...n)=>{t.warnfromjs(`${e}: ${Rr(n)}`)},console.error=(...n)=>{t.errorfromjs(`${e}: ${Rr(n)}`)},window.logsOverriddenForUnreal=!0}}function Rr(e){return e.map((e=>"object"==typeof e?e instanceof Error?e.message:JSON.stringify(e):String(e))).join(" ")}let Lr;class Ur extends Yi{constructor(e){super(),this.walletURL=void 0,this.register=()=>{var e;Mr("dapp"),Lr&&(Lr.unregister(),Lr=this),null!=(e=window.ue)&&e.sequencewallettransport&&(window.ue.sequencewallettransport.onmessagefromwallet=this.onUnrealCallback),Lr=this,this._registered=!0,console.log("registering transport!")},this.unregister=()=>{var e,t;this._registered=!1,this.closeWallet(),Lr===this&&(Lr=void 0),(null==(e=window.ue)||null==(t=e.sequencewallettransport)?void 0:t.onmessagefromwallet)===this.onUnrealCallback&&delete window.ue.sequencewallettransport.onmessagefromwallet,this.events.removeAllListeners()},this.openWallet=(e,t,n)=>{if(this.isOpened())return void console.log("wallet already open!");console.log("opening wallet!");const s=new URL(this.walletURL.href),i=new Bi;e&&(s.pathname=e.toLowerCase()),this._init=ji.NIL,this._sessionId=`${performance.now()}`,i.set("sid",this._sessionId),t&&i.set("intent",Te(t)),n&&i.set("net",`${n}`),s.search=i.toString(),console.log("opening wallet to",s.href),window.open(s.href)},this.onUnrealCallback=e=>{if(!e)throw new Error("ProviderMessage object is empty");this.handleMessage(e)},this.walletURL=new URL(e)}closeWallet(){this.close()}sendMessage(e){var t,n;const s="string"!=typeof e?JSON.stringify(e):e;console.log("Sending message to wallet:",s),null==(t=window.ue)||null==(n=t.sequencewallettransport)||n.sendmessagetowallet(s)}}class Dr extends br{constructor(e){super(e),this.onMessageFromUnreal=e=>{Be.debug("RECEIVED MESSAGE",e),this.handleMessage(e)},this.getUnrealTransportSession=e=>{const t=new Bi(e);return{sessionId:t.get("sid"),networkId:t.get("net"),intent:Ne(t.get("intent"))}},this._init=ji.NIL}async register(e){var t;if(void 0===(null==(t=window.ue)?void 0:t.sequencewallettransport))return;Mr("wallet");const{search:n}=new URL(e||window.location.href);let s=this.getUnrealTransportSession(n);!!s.sessionId||(s=await this.getCachedTransportSession()),s?(window.ue.sequencewallettransport.onmessagefromsequencejs=this.onMessageFromUnreal,this._registered=!0,this.open(s).then((e=>{if(!e){var t;const e=`failed to open to network ${null==(t=s)?void 0:t.networkId}`;Be.error(e),this.notifyClose({message:e}),window.close()}})).catch((e=>{var t;const n=`failed to open to network ${null==(t=s)?void 0:t.networkId}, due to: ${e}`;Be.error(n),this.notifyClose({message:n}),window.close()}))):Be.error("unreal session is undefined")}unregister(){var e,t;(null==(e=window.ue)||null==(t=e.sequencewallettransport)?void 0:t.onmessagefromsequencejs)===this.onMessageFromUnreal&&delete window.ue.sequencewallettransport.onmessagefromsequencejs,this._registered=!1}sendMessage(e){var t,n;if(e.type!==Fi.INIT&&this._init!==ji.OK)return void Be.error("impossible state, should not be calling postMessage until inited");const s=JSON.stringify(e);null==(t=window.ue)||null==(n=t.sequencewallettransport)||n.sendmessagetosequencejs(s)}}class qr{constructor(e){var t=this;this.wallet=void 0,this.recoverWalletConfig=async function(e,n,s,i,r){return r=r||await t.wallet.getWalletContext(),pr(e,n,s,i,r)},this.recoverWalletConfigFromMessage=async function(e,n,s,i,r){return r=r||await t.wallet.getWalletContext(),pr(e,Ae(lr(n)),s,i,r)},this.recoverWalletConfigFromTypedData=async function(e,n,s,i,r){return r=r||await t.wallet.getWalletContext(),pr(e,Qe(n),s,i,r)},this.wallet=e}signMessage(e,t,n){const s=this.wallet.getSigner();if(!s)throw new Error("unable to get signer");return s.signMessage(e,t,n)}async signAuthMessage(e,t){const n=await this.wallet.getAuthSigner();if(!n)throw new Error("unable to get AuthChain signer");return n.signMessage(e,await n.getChainId(),t)}signTypedData(e,t,n,s,i){const r=this.wallet.getSigner();if(!r)throw new Error("unable to get signer");return r.signTypedData(e,t,n,s,i)}async signAuthTypedData(e,t,n,s){const i=await this.wallet.getAuthSigner();if(!i)throw new Error("unable to get AuthChain signer");return i.signTypedData(e,t,n,await i.getChainId(),s)}async isValidSignature(e,t,n,s,i){const r=this.wallet.getProvider(s);if(!r)throw new Error(`unable to get provider for chainId ${s}`);return hr(e,t,n,r,s,i)}async isValidMessageSignature(e,t,n,s,i){const r=this.wallet.getProvider(s);if(!r)throw new Error(`unable to get provider for chainId ${s}`);const a=lr(t),o=Ae(a);return hr(e,o,n,r,s,i)}isValidTypedDataSignature(e,t,n,s,i){return this.isValidSignature(e,Qe(t),n,s,i)}}class Wr{constructor(e,t){var n=this;this.utils=void 0,this.config=void 0,this.session=void 0,this.connectedSites=void 0,this.transport=void 0,this.networks=void 0,this.providers=void 0,this.init=()=>{var e,t,n,s,i,r,a,o;this.transport.provider||(this.transport.messageProvider=new Sr,null!=(e=this.config.transports)&&null!=(t=e.windowTransport)&&t.enabled&&(this.transport.windowMessageProvider=new xr(this.config.walletAppURL),this.transport.messageProvider.add(this.transport.windowMessageProvider)),null!=(n=this.config.transports)&&null!=(s=n.proxyTransport)&&s.enabled&&(this.transport.proxyMessageProvider=new _r(this.config.transports.proxyTransport.appPort),this.transport.messageProvider.add(this.transport.proxyMessageProvider)),null!=(i=this.config.transports)&&null!=(r=i.extensionTransport)&&r.enabled&&(this.transport.extensionMessageProvider=new Ar(this.config.transports.extensionTransport.runtime),this.transport.messageProvider.add(this.transport.extensionMessageProvider)),null!=(a=this.config.transports)&&null!=(o=a.unrealTransport)&&o.enabled&&(this.transport.unrealMessageProvider=new Ur(this.config.walletAppURL),this.transport.messageProvider.add(this.transport.unrealMessageProvider)),this.transport.messageProvider.register(),this.transport.allowProvider=Ft((e=>{if("sequence_setDefaultNetwork"===e.method)return!0;const t=this.isConnected();if(!t)throw new Error("Sequence: wallet not connected");return t})),this.transport.networkProvider=Vt((e=>this.networks&&0!==this.networks.length?this.networks.find((e=>e.isDefaultChain)).chainId:0)),this.transport.cachedProvider=new $t,this.transport.cachedProvider.onUpdate((()=>{this.session||(this.session={providerCache:{}}),this.session.providerCache=this.transport.cachedProvider.getCache(),this.saveSession(this.session)})),this.transport.router=new Mt([Gt,this.transport.networkProvider,this.transport.allowProvider,Ht,this.transport.cachedProvider],this.transport.messageProvider),this.transport.provider=new Zi(this.transport.router),this.transport.messageProvider.on("open",(e=>{const{session:t}=e;t?this.useSession(t,!0):(this.session&&this.session.accountAddress&&this.transport.messageProvider.emit("disconnect"),this.clearSession())})),this.transport.messageProvider.on("accountsChanged",((e,t)=>{t?e.length>0&&this.useSession({accountAddress:e[0]},!0):e&&0!==e.length&&""!==e[0]?this.useSession({accountAddress:e[0]},!0):this.clearSession()})),this.transport.messageProvider.on("networks",(e=>{this.useSession({networks:e},!0)})),this.transport.messageProvider.on("walletContext",(e=>{this.useSession({walletContext:e},!0)})))},this.loadSession=async function(){const e=await mr.getInstance().getItem("@sequence.session");if(e&&""!==e)try{const t=JSON.parse(e);return t&&n.useSession(t,!1),t}catch(e){return void Be.warn("loadSession failed, unable to parse session payload from storage.")}},this.connect=async function(e){if(!0===(null==e?void 0:e.refresh)&&n.disconnect(),n.isConnected()&&await n.isSiteConnected(null==e?void 0:e.origin)&&n.session&&(null==e||!e.authorize)&&(null==e||!e.askForEmail))return{connected:!0,session:n.session,chainId:A.hexlify(await n.getChainId())};if(e&&e.authorize&&(!e.app||""===e.app))throw new Error("connecting with 'authorize' option also requires 'app' to be set");await n.openWallet(void 0,{type:"connect",options:e});const t=await n.transport.messageProvider.waitUntilConnected().catch((e=>({connected:!1})));if(t.connected){if(!t.session)throw new Error("impossible state, connect response is missing session");n.useSession(t.session,!0),n.addConnectedSite(null==e?void 0:e.origin)}return t},this.authorize=async function(e){return n.connect(Wi({},e,{authorize:!0}))},this.getSession=()=>{if(this.isConnected())return this.session},this.getAddress=async function(){if(!n.isConnected())throw new Error("connect first");return n.getSession().accountAddress},this.getNetworks=async function(e){if(!n.isConnected()||!n.networks)throw new Error("connect first");if(e){const t=yt(n.networks,e);return t?[t]:[]}return n.networks},this.getChainId=async function(){if(!n.networks||n.networks.length<1)throw new Error("networks have not been set by session. connect first.");const e=n.networks.find((e=>e.isDefaultChain));if(!e)throw new Error("networks must have a default chain specified");return e.chainId},this.getAuthChainId=async function(){if(!n.networks||n.networks.length<1)throw new Error("networks have not been set by session. connect first.");const e=n.networks.find((e=>e.isAuthChain));if(!e)throw new Error("networks must have an auth chain specified");return e.chainId},this.openWallet=async function(e,t,s){if("connect"!==(null==t?void 0:t.type)&&!n.isConnected())throw new Error("connect first");let i;return i=!n.networks||n.networks.length<1?n.config.defaultNetworkId:await n.getChainId(),n.transport.messageProvider.openWallet(e,t,s||i),await n.transport.messageProvider.waitUntilOpened(),!0},this.closeWallet=()=>{this.transport.messageProvider.closeWallet()},this.saveSession=async function(e){Be.debug("wallet provider: saving session");const t=JSON.stringify(e);await mr.getInstance().setItem("@sequence.session",t)},this.useSession=async function(e,t=!0){n.session||(n.session={}),n.config.walletContext?n.session.walletContext=n.config.walletContext:e.walletContext&&(n.session.walletContext=e.walletContext),e.accountAddress&&n.useAccountAddress(e.accountAddress),e.networks&&n.useNetworks(e.networks),e.providerCache&&n.transport.cachedProvider.setCache(e.providerCache),t&&n.saveSession(n.session)},this.config=Wi({},Br),t&&(this.config=Wi({},this.config,t)),e?this.config.defaultNetworkId=e:this.config.defaultNetworkId||(this.config.defaultNetworkId="mainnet"),null!=t&&t.localStorage&&mr.use(t.localStorage),this.transport={},this.networks=[],this.providers={},this.connectedSites=new yr("@sequence.connectedSites",[]),this.utils=new qr(this),this.init()}async addConnectedSite(e){e=e||window.location.origin;const t=await this.connectedSites.get();if(t){if(t.includes(e))return;this.connectedSites.set([...t,e])}else this.connectedSites.set([e])}async removeConnectedSite(e){const t=await this.connectedSites.get();t&&this.connectedSites.set(t.filter((t=>t!==e)))}getConnectedSites(){return this.connectedSites.get()}async isSiteConnected(e){const t=await this.connectedSites.get();return!!t&&t.includes(e||window.location.origin)}disconnect(){this.isOpened()&&this.closeWallet(),this.clearSession()}getProviderConfig(){return this.config}isOpened(){return this.transport.messageProvider.isOpened()}isConnected(){return void 0!==this.session&&void 0!==this.session.networks&&this.session.networks.length>0&&void 0!==this.networks&&this.networks.length>0&&!!this.session.accountAddress&&this.session.accountAddress.startsWith("0x")}getProvider(e){if(!this.isConnected()){if(e)throw new Error("session is empty. connect and try again.");return this.transport.provider}let t,n=this.networks.find((e=>e.isDefaultChain));if(e&&(n=yt(this.networks,e),!n))throw new Error(`network ${e} is not in the network list`);if(this.providers[n.chainId])return this.providers[n.chainId];const s=n.provider?n.provider:new T.r(n.rpcUrl,n.chainId);if(n.isDefaultChain){const e=new Mt([Gt,Ht,new jt({accountAddress:this.session.accountAddress,walletContext:this.session.walletContext}),new Jt(this.transport.provider),this.transport.cachedProvider],new qt(s));t=new Zi(e,n.chainId)}else{const e=new Mt([Gt,Ht,new jt({accountAddress:this.session.accountAddress,walletContext:this.session.walletContext,chainId:n.chainId}),new Jt(this.transport.provider),new $t(n.chainId)],new qt(s));t=new Zi(e,n.chainId)}return this.providers[n.chainId]=t,t}async getAuthProvider(){return this.getProvider((await this.getAuthNetwork()).chainId)}async getAuthNetwork(){return(await this.getNetworks()).find((e=>e.isAuthChain))}getAllProviders(){return this.providers}getSigner(e){return this.getProvider(e).getSigner()}async getAuthSigner(){return(await this.getAuthProvider()).getSigner()}getWalletConfig(e){return this.getSigner().getWalletConfig(e)}getWalletState(e){return this.getSigner().getWalletState(e)}getWalletContext(){return this.getSigner().getWalletContext()}isDeployed(e){return this.getSigner(e).isDeployed()}on(e,t){this.transport.messageProvider.on(e,t)}once(e,t){this.transport.messageProvider.once(e,t)}useAccountAddress(e){this.session||(this.session={}),this.session.accountAddress=O.getAddress(e)}useNetworks(e){if(this.session||(this.session={}),this.session.networks=e,this.session.networks&&0!==this.session.networks.length)if(this.config.networks||this.config.networkRpcUrl){if(this.networks=e,this.config.networks&&(this.networks=e.map((e=>Wi({},e))),this.config.networks.forEach((e=>{const t=yt(this.networks,e.chainId||e.name);t&&wt(e,t)})),gt(this.networks,!0)),this.config.networkRpcUrl){const e=this.networks.find((e=>e.isDefaultChain));e&&(e.rpcUrl=this.config.networkRpcUrl)}}else this.networks=e}clearSession(){var e;Be.debug("wallet provider: clearing session"),mr.getInstance().removeItem("@sequence.session"),this.session=void 0,this.networks=[],this.providers={},null==(e=this.transport.cachedProvider)||e.clearCache()}}const Br={walletAppURL:"https://sequence.app",transports:{windowTransport:{enabled:!0},proxyTransport:{enabled:!1}}};let Fr;const $r=async(e,t)=>(Fr&&Fr.isOpened()&&Fr.closeWallet(),Fr=new Wr(e,t),await Fr.loadSession(),Fr),jr=()=>{if(!Fr)throw new Error("Wallet has not been initialized, call sequence.initWallet(network, config) first.");return Fr};function Hr(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}var Gr=Hr({__proto__:null},[s]),Vr=Hr({__proto__:null},[i]),Kr=Hr({__proto__:null},[p]),Jr=Hr({__proto__:null},[c]),Yr=Hr({__proto__:null},[g]),zr=Hr({__proto__:null},[l]),Qr=Hr({__proto__:null},[h]),Zr=Hr({__proto__:null},[o]),Xr=Hr({__proto__:null},[a]),ea=Hr({__proto__:null},[f]),ta=Hr({__proto__:null},[u]),na=Hr({__proto__:null},[d]),sa=Hr({__proto__:null,isValidSignature:hr,isValidMessageSignature:dr,isValidTypedDataSignature:ur,recoverWalletConfig:pr,isWalletUpToDate:wr},[r]),ia=Object.freeze({__proto__:null,abi:Gr,api:Vr,auth:Kr,config:Jr,guard:Yr,indexer:zr,metadata:Qr,multicall:Zr,network:Xr,provider:ea,relayer:ta,transactions:na,utils:sa,initWallet:$r,getWallet:jr,Wallet:Wr})},95958:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AbiCoder:()=>s.R,ConstructorFragment:()=>i.Xg,ErrorFragment:()=>i.IC,EventFragment:()=>i.QV,FormatTypes:()=>i.pc,Fragment:()=>i.HY,FunctionFragment:()=>i.YW,HDNode:()=>f.HDNode,Indexed:()=>a.Hk,Interface:()=>a.vU,LogDescription:()=>a.CC,Logger:()=>y.Logger,ParamType:()=>i._R,RLP:()=>k,SigningKey:()=>S.SigningKey,SupportedAlgorithm:()=>M.p,TransactionDescription:()=>a.vk,TransactionTypes:()=>O.TransactionTypes,UnicodeNormalizationForm:()=>x.Uj,Utf8ErrorFuncs:()=>x.te,Utf8ErrorReason:()=>x.Uw,_TypedDataEncoder:()=>g.E,_fetchData:()=>P._fetchData,_toEscapedUtf8String:()=>x.U$,accessListify:()=>O.accessListify,arrayify:()=>h.arrayify,base58:()=>l.Base58,base64:()=>c,checkProperties:()=>_.checkProperties,checkResultErrors:()=>r.BR,commify:()=>N.commify,computeAddress:()=>O.computeAddress,computeHmac:()=>v.Gy,computePublicKey:()=>S.computePublicKey,concat:()=>h.concat,deepCopy:()=>_.deepCopy,defaultAbiCoder:()=>s.$,defaultPath:()=>f.defaultPath,defineReadOnly:()=>_.defineReadOnly,entropyToMnemonic:()=>f.entropyToMnemonic,fetchJson:()=>P.fetchJson,formatBytes32String:()=>T.s,formatEther:()=>N.formatEther,formatUnits:()=>N.formatUnits,getAccountPath:()=>f.getAccountPath,getAddress:()=>o.getAddress,getContractAddress:()=>o.getContractAddress,getCreate2Address:()=>o.getCreate2Address,getIcapAddress:()=>o.getIcapAddress,getJsonWalletAddress:()=>w.Rb,getStatic:()=>_.getStatic,hashMessage:()=>d.r,hexConcat:()=>h.hexConcat,hexDataLength:()=>h.hexDataLength,hexDataSlice:()=>h.hexDataSlice,hexStripZeros:()=>h.hexStripZeros,hexValue:()=>h.hexValue,hexZeroPad:()=>h.hexZeroPad,hexlify:()=>h.hexlify,id:()=>p.id,isAddress:()=>o.isAddress,isBytes:()=>h.isBytes,isBytesLike:()=>h.isBytesLike,isHexString:()=>h.isHexString,isValidMnemonic:()=>f.isValidMnemonic,isValidName:()=>u.r,joinSignature:()=>h.joinSignature,keccak256:()=>m.keccak256,mnemonicToEntropy:()=>f.mnemonicToEntropy,mnemonicToSeed:()=>f.mnemonicToSeed,namehash:()=>u.V,nameprep:()=>I.Ll,parseBytes32String:()=>T.F,parseEther:()=>N.parseEther,parseTransaction:()=>O.parse,parseUnits:()=>N.parseUnits,poll:()=>P.poll,randomBytes:()=>C.O,recoverAddress:()=>O.recoverAddress,recoverPublicKey:()=>S.recoverPublicKey,resolveProperties:()=>_.resolveProperties,ripemd160:()=>v.bP,serializeTransaction:()=>O.serialize,sha256:()=>v.JQ,sha512:()=>v.o,shallowCopy:()=>_.shallowCopy,shuffled:()=>E.y,solidityKeccak256:()=>b.keccak256,solidityPack:()=>b.pack,soliditySha256:()=>b.sha256,splitSignature:()=>h.splitSignature,stripZeros:()=>h.stripZeros,toUtf8Bytes:()=>x.Y0,toUtf8CodePoints:()=>x.XL,toUtf8String:()=>x.ZN,verifyMessage:()=>A.verifyMessage,verifyTypedData:()=>A.verifyTypedData,zeroPad:()=>h.zeroPad});var s=n(99780),i=n(79155),r=n(54848),a=n(99268),o=n(58549),c=n(70462),l=n(50511),h=n(67640),d=n(3686),u=n(66154),p=n(32235),g=n(79378),f=n(36060),w=n(61609),m=n(59256),y=n(78011),v=n(84772),b=n(41731),C=n(42366),E=n(56938),_=n(80221),k=n(48669),S=n(17459),I=n(68953),x=n(2222),T=n(7987),O=n(13390),N=n(49494),A=n(4358),P=n(87581),M=n(21723)},91355:(e,t,n)=>{var s,i=n(34406);!function(r){var a=Object.hasOwnProperty,o=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},c="object"==typeof i&&"function"==typeof i.nextTick,l="function"==typeof Symbol,h="object"==typeof Reflect,d="function"==typeof setImmediate?setImmediate:setTimeout,u=l?h&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys:function(e){var t=Object.getOwnPropertyNames(e);return t.push.apply(t,Object.getOwnPropertySymbols(e)),t}:Object.keys;function p(){this._events={},this._conf&&g.call(this,this._conf)}function g(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners!==r&&(this._maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),e.ignoreErrors&&(this.ignoreErrors=e.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function f(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+t+"."),void 0!==i&&i.emitWarning){var s=new Error(n);s.name="MaxListenersExceededWarning",s.emitter=this,s.count=e,i.emitWarning(s)}else console.error(n),console.trace&&console.trace()}var w=function(e,t,n){var s=arguments.length;switch(s){case 0:return[];case 1:return[e];case 2:return[e,t];case 3:return[e,t,n];default:for(var i=new Array(s);s--;)i[s]=arguments[s];return i}};function m(e,t){for(var n={},s=e.length,i=t?t.length:0,a=0;a<s;a++)n[e[a]]=a<i?t[a]:r;return n}function y(e,t,n){var s,i;if(this._emitter=e,this._target=t,this._listeners={},this._listenersCount=0,(n.on||n.off)&&(s=n.on,i=n.off),t.addEventListener?(s=t.addEventListener,i=t.removeEventListener):t.addListener?(s=t.addListener,i=t.removeListener):t.on&&(s=t.on,i=t.off),!s&&!i)throw Error("target does not implement any known event API");if("function"!=typeof s)throw TypeError("on method must be a function");if("function"!=typeof i)throw TypeError("off method must be a function");this._on=s,this._off=i;var r=e._observers;r?r.push(this):e._observers=[this]}function v(e,t,n,s){var i=Object.assign({},t);if(!e)return i;if("object"!=typeof e)throw TypeError("options must be an object");var o,c,l,h=Object.keys(e),d=h.length;function u(e){throw Error('Invalid "'+o+'" option value'+(e?". Reason: "+e:""))}for(var p=0;p<d;p++){if(o=h[p],!s&&!a.call(t,o))throw Error('Unknown "'+o+'" option');(c=e[o])!==r&&(l=n[o],i[o]=l?l(c,u):c)}return i}function b(e,t){return"function"==typeof e&&e.hasOwnProperty("prototype")||t("value must be a constructor"),e}function C(e){var t="value must be type of "+e.join("|"),n=e.length,s=e[0],i=e[1];return 1===n?function(e,n){if(typeof e===s)return e;n(t)}:2===n?function(e,n){var r=typeof e;if(r===s||r===i)return e;n(t)}:function(s,i){for(var r=typeof s,a=n;a-- >0;)if(r===e[a])return s;i(t)}}Object.assign(y.prototype,{subscribe:function(e,t,n){var s=this,i=this._target,r=this._emitter,a=this._listeners,o=function(){var s=w.apply(null,arguments),a={data:s,name:t,original:e};if(n){var o=n.call(i,a);!1!==o&&r.emit.apply(r,[a.name].concat(s))}else r.emit.apply(r,[t].concat(s))};if(a[e])throw Error("Event '"+e+"' is already listening");this._listenersCount++,r._newListener&&r._removeListener&&!s._onNewListener?(this._onNewListener=function(n){n===t&&null===a[e]&&(a[e]=o,s._on.call(i,e,o))},r.on("newListener",this._onNewListener),this._onRemoveListener=function(n){n===t&&!r.hasListeners(n)&&a[e]&&(a[e]=null,s._off.call(i,e,o))},a[e]=null,r.on("removeListener",this._onRemoveListener)):(a[e]=o,s._on.call(i,e,o))},unsubscribe:function(e){var t,n,s,i=this,r=this._listeners,a=this._emitter,o=this._off,c=this._target;if(e&&"string"!=typeof e)throw TypeError("event must be a string");function l(){i._onNewListener&&(a.off("newListener",i._onNewListener),a.off("removeListener",i._onRemoveListener),i._onNewListener=null,i._onRemoveListener=null);var e=S.call(a,i);a._observers.splice(e,1)}if(e){if(!(t=r[e]))return;o.call(c,e,t),delete r[e],--this._listenersCount||l()}else{for(s=(n=u(r)).length;s-- >0;)e=n[s],o.call(c,e,r[e]);this._listeners={},this._listenersCount=0,l()}}});var E=C(["function"]),_=C(["object","function"]);function k(e,t,n){var s,i,r,a=0,o=new e((function(c,l,h){function d(){i&&(i=null),a&&(clearTimeout(a),a=0)}n=v(n,{timeout:0,overload:!1},{timeout:function(e,t){return("number"!=typeof(e*=1)||e<0||!Number.isFinite(e))&&t("timeout must be a positive number"),e}}),s=!n.overload&&"function"==typeof e.prototype.cancel&&"function"==typeof h;var u=function(e){d(),c(e)},p=function(e){d(),l(e)};s?t(u,p,h):(i=[function(e){p(e||Error("canceled"))}],t(u,p,(function(e){if(r)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof e)throw TypeError("onCancel callback must be a function");i.push(e)})),r=!0),n.timeout>0&&(a=setTimeout((function(){var e=Error("timeout");e.code="ETIMEDOUT",a=0,o.cancel(e),l(e)}),n.timeout))}));return s||(o.cancel=function(e){if(i){for(var t=i.length,n=1;n<t;n++)i[n](e);i[0](e),i=null}}),o}function S(e){var t=this._observers;if(!t)return-1;for(var n=t.length,s=0;s<n;s++)if(t[s]._target===e)return s;return-1}function I(e,t,n,s,i){if(!n)return null;if(0===s){var r=typeof t;if("string"===r){var a,o,c=0,l=0,h=this.delimiter,d=h.length;if(-1!==(o=t.indexOf(h))){a=new Array(5);do{a[c++]=t.slice(l,o),l=o+d}while(-1!==(o=t.indexOf(h,l)));a[c++]=t.slice(l),t=a,i=c}else t=[t],i=1}else"object"===r?i=t.length:(t=[t],i=1)}var p,g,f,w,m,y,v,b=null,C=t[s],E=t[s+1];if(s===i)n._listeners&&("function"==typeof n._listeners?(e&&e.push(n._listeners),b=[n]):(e&&e.push.apply(e,n._listeners),b=[n]));else{if("*"===C){for(o=(y=u(n)).length;o-- >0;)"_listeners"!==(p=y[o])&&(v=I(e,t,n[p],s+1,i))&&(b?b.push.apply(b,v):b=v);return b}if("**"===C){for((m=s+1===i||s+2===i&&"*"===E)&&n._listeners&&(b=I(e,t,n,i,i)),o=(y=u(n)).length;o-- >0;)"_listeners"!==(p=y[o])&&("*"===p||"**"===p?(n[p]._listeners&&!m&&(v=I(e,t,n[p],i,i))&&(b?b.push.apply(b,v):b=v),v=I(e,t,n[p],s,i)):v=I(e,t,n[p],p===E?s+2:s,i),v&&(b?b.push.apply(b,v):b=v));return b}n[C]&&(b=I(e,t,n[C],s+1,i))}if((g=n["*"])&&I(e,t,g,s+1,i),f=n["**"])if(s<i)for(f._listeners&&I(e,t,f,i,i),o=(y=u(f)).length;o-- >0;)"_listeners"!==(p=y[o])&&(p===E?I(e,t,f[p],s+2,i):p===C?I(e,t,f[p],s+1,i):((w={})[p]=f[p],I(e,t,{"**":w},s+1,i)));else f._listeners?I(e,t,f,i,i):f["*"]&&f["*"]._listeners&&I(e,t,f["*"],i,i);return b}function x(e,t,n){var s,i,r=0,a=0,o=this.delimiter,c=o.length;if("string"==typeof e)if(-1!==(s=e.indexOf(o))){i=new Array(5);do{i[r++]=e.slice(a,s),a=s+c}while(-1!==(s=e.indexOf(o,a)));i[r++]=e.slice(a)}else i=[e],r=1;else i=e,r=e.length;if(r>1)for(s=0;s+1<r;s++)if("**"===i[s]&&"**"===i[s+1])return;var l,h=this.listenerTree;for(s=0;s<r;s++)if(h=h[l=i[s]]||(h[l]={}),s===r-1)return h._listeners?("function"==typeof h._listeners&&(h._listeners=[h._listeners]),n?h._listeners.unshift(t):h._listeners.push(t),!h._listeners.warned&&this._maxListeners>0&&h._listeners.length>this._maxListeners&&(h._listeners.warned=!0,f.call(this,h._listeners.length,l))):h._listeners=t,!0;return!0}function T(e,t,n,s){for(var i,r,a,o,c=u(e),l=c.length,h=e._listeners;l-- >0;)i=e[r=c[l]],a="_listeners"===r?n:n?n.concat(r):[r],o=s||"symbol"==typeof r,h&&t.push(o?a:a.join(this.delimiter)),"object"==typeof i&&T.call(this,i,t,a,o);return t}function O(e){for(var t,n,s,i=u(e),r=i.length;r-- >0;)(t=e[n=i[r]])&&(s=!0,"_listeners"===n||O(t)||delete e[n]);return s}function N(e,t,n){this.emitter=e,this.event=t,this.listener=n}function A(e,t,n){if(!0===n)a=!0;else if(!1===n)s=!0;else{if(!n||"object"!=typeof n)throw TypeError("options should be an object or true");var s=n.async,a=n.promisify,o=n.nextTick,l=n.objectify}if(s||o||a){var h=t,u=t._origin||t;if(o&&!c)throw Error("process.nextTick is not supported");a===r&&(a="AsyncFunction"===t.constructor.name),t=function(){var e=arguments,t=this,n=this.event;return a?o?Promise.resolve():new Promise((function(e){d(e)})).then((function(){return t.event=n,h.apply(t,e)})):(o?i.nextTick:d)((function(){t.event=n,h.apply(t,e)}))},t._async=!0,t._origin=u}return[t,l?new N(this,e,t):this]}function P(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,g.call(this,e)}N.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},P.EventEmitter2=P,P.prototype.listenTo=function(e,t,n){if("object"!=typeof e)throw TypeError("target musts be an object");var s=this;function i(t){if("object"!=typeof t)throw TypeError("events must be an object");var i,r=n.reducers,a=S.call(s,e);i=-1===a?new y(s,e,n):s._observers[a];for(var o,c=u(t),l=c.length,h="function"==typeof r,d=0;d<l;d++)o=c[d],i.subscribe(o,t[o]||o,h?r:r&&r[o])}return n=v(n,{on:r,off:r,reducers:r},{on:E,off:E,reducers:_}),o(t)?i(m(t)):i("string"==typeof t?m(t.split(/\s+/)):t),this},P.prototype.stopListeningTo=function(e,t){var n=this._observers;if(!n)return!1;var s,i=n.length,r=!1;if(e&&"object"!=typeof e)throw TypeError("target should be an object");for(;i-- >0;)s=n[i],e&&s._target!==e||(s.unsubscribe(t),r=!0);return r},P.prototype.delimiter=".",P.prototype.setMaxListeners=function(e){e!==r&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},P.prototype.getMaxListeners=function(){return this._maxListeners},P.prototype.event="",P.prototype.once=function(e,t,n){return this._once(e,t,!1,n)},P.prototype.prependOnceListener=function(e,t,n){return this._once(e,t,!0,n)},P.prototype._once=function(e,t,n,s){return this._many(e,1,t,n,s)},P.prototype.many=function(e,t,n,s){return this._many(e,t,n,!1,s)},P.prototype.prependMany=function(e,t,n,s){return this._many(e,t,n,!0,s)},P.prototype._many=function(e,t,n,s,i){var r=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function a(){return 0==--t&&r.off(e,a),n.apply(this,arguments)}return a._origin=n,this._on(e,a,s,i)},P.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||p.call(this);var e,t,n,s,i,r,a=arguments[0],o=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return!1;if(o&&(e=a,"newListener"!==a&&"removeListener"!==a&&"object"==typeof a)){if(n=a.length,l)for(s=0;s<n;s++)if("symbol"==typeof a[s]){r=!0;break}r||(a=a.join(this.delimiter))}var c,h=arguments.length;if(this._all&&this._all.length)for(s=0,n=(c=this._all.slice()).length;s<n;s++)switch(this.event=a,h){case 1:c[s].call(this,a);break;case 2:c[s].call(this,a,arguments[1]);break;case 3:c[s].call(this,a,arguments[1],arguments[2]);break;default:c[s].apply(this,arguments)}if(o)c=[],I.call(this,c,e,this.listenerTree,0,n);else{if("function"==typeof(c=this._events[a])){switch(this.event=a,h){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(h-1),i=1;i<h;i++)t[i-1]=arguments[i];c.apply(this,t)}return!0}c&&(c=c.slice())}if(c&&c.length){if(h>3)for(t=new Array(h-1),i=1;i<h;i++)t[i-1]=arguments[i];for(s=0,n=c.length;s<n;s++)switch(this.event=a,h){case 1:c[s].call(this);break;case 2:c[s].call(this,arguments[1]);break;case 3:c[s].call(this,arguments[1],arguments[2]);break;default:c[s].apply(this,t)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===a)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},P.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||p.call(this);var e,t,n,s,i,r,a=arguments[0],o=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(o&&(e=a,"newListener"!==a&&"removeListener"!==a&&"object"==typeof a)){if(s=a.length,l)for(i=0;i<s;i++)if("symbol"==typeof a[i]){t=!0;break}t||(a=a.join(this.delimiter))}var c,h=[],d=arguments.length;if(this._all)for(i=0,s=this._all.length;i<s;i++)switch(this.event=a,d){case 1:h.push(this._all[i].call(this,a));break;case 2:h.push(this._all[i].call(this,a,arguments[1]));break;case 3:h.push(this._all[i].call(this,a,arguments[1],arguments[2]));break;default:h.push(this._all[i].apply(this,arguments))}if(o?(c=[],I.call(this,c,e,this.listenerTree,0)):c=this._events[a],"function"==typeof c)switch(this.event=a,d){case 1:h.push(c.call(this));break;case 2:h.push(c.call(this,arguments[1]));break;case 3:h.push(c.call(this,arguments[1],arguments[2]));break;default:for(n=new Array(d-1),r=1;r<d;r++)n[r-1]=arguments[r];h.push(c.apply(this,n))}else if(c&&c.length){if(c=c.slice(),d>3)for(n=new Array(d-1),r=1;r<d;r++)n[r-1]=arguments[r];for(i=0,s=c.length;i<s;i++)switch(this.event=a,d){case 1:h.push(c[i].call(this));break;case 2:h.push(c[i].call(this,arguments[1]));break;case 3:h.push(c[i].call(this,arguments[1],arguments[2]));break;default:h.push(c[i].apply(this,n))}}else if(!this.ignoreErrors&&!this._all&&"error"===a)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(h)},P.prototype.on=function(e,t,n){return this._on(e,t,!1,n)},P.prototype.prependListener=function(e,t,n){return this._on(e,t,!0,n)},P.prototype.onAny=function(e){return this._onAny(e,!1)},P.prototype.prependAny=function(e){return this._onAny(e,!0)},P.prototype.addListener=P.prototype.on,P.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},P.prototype._on=function(e,t,n,s){if("function"==typeof e)return this._onAny(e,t),this;if("function"!=typeof t)throw new Error("on only accepts instances of Function");this._events||p.call(this);var i,a=this;return s!==r&&(t=(i=A.call(this,e,t,s))[0],a=i[1]),this._newListener&&this.emit("newListener",e,t),this.wildcard?(x.call(this,e,t,n),a):(this._events[e]?("function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),n?this._events[e].unshift(t):this._events[e].push(t),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,f.call(this,this._events[e].length,e))):this._events[e]=t,a)},P.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var n,s=[];if(this.wildcard){var i="string"==typeof e?e.split(this.delimiter):e.slice();if(!(s=I.call(this,null,i,this.listenerTree,0)))return this}else{if(!this._events[e])return this;n=this._events[e],s.push({_listeners:n})}for(var r=0;r<s.length;r++){var a=s[r];if(n=a._listeners,o(n)){for(var c=-1,l=0,h=n.length;l<h;l++)if(n[l]===t||n[l].listener&&n[l].listener===t||n[l]._origin&&n[l]._origin===t){c=l;break}if(c<0)continue;return this.wildcard?a._listeners.splice(c,1):this._events[e].splice(c,1),0===n.length&&(this.wildcard?delete a._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete a._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return this.listenerTree&&O(this.listenerTree),this},P.prototype.offAny=function(e){var t,n=0,s=0;if(e&&this._all&&this._all.length>0){for(n=0,s=(t=this._all).length;n<s;n++)if(e===t[n])return t.splice(n,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(n=0,s=t.length;n<s;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this},P.prototype.removeListener=P.prototype.off,P.prototype.removeAllListeners=function(e){if(e===r)return!this._events||p.call(this),this;if(this.wildcard){var t,n=I.call(this,null,e,this.listenerTree,0);if(!n)return this;for(t=0;t<n.length;t++)n[t]._listeners=null;this.listenerTree&&O(this.listenerTree)}else this._events&&(this._events[e]=null);return this},P.prototype.listeners=function(e){var t,n,s,i,a,o=this._events;if(e===r){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!o)return[];for(i=(t=u(o)).length,s=[];i-- >0;)"function"==typeof(n=o[t[i]])?s.push(n):s.push.apply(s,n);return s}if(this.wildcard){if(!(a=this.listenerTree))return[];var c=[],l="string"==typeof e?e.split(this.delimiter):e.slice();return I.call(this,c,l,a,0),c}return o&&(n=o[e])?"function"==typeof n?[n]:n:[]},P.prototype.eventNames=function(e){var t=this._events;return this.wildcard?T.call(this,this.listenerTree,[],null,e):t?u(t):[]},P.prototype.listenerCount=function(e){return this.listeners(e).length},P.prototype.hasListeners=function(e){if(this.wildcard){var t=[],n="string"==typeof e?e.split(this.delimiter):e.slice();return I.call(this,t,n,this.listenerTree,0),t.length>0}var s=this._events,i=this._all;return!!(i&&i.length||s&&(e===r?u(s).length:s[e]))},P.prototype.listenersAny=function(){return this._all?this._all:[]},P.prototype.waitFor=function(e,t){var n=this,s=typeof t;return"number"===s?t={timeout:t}:"function"===s&&(t={filter:t}),k((t=v(t,{timeout:0,filter:r,handleError:!1,Promise,overload:!1},{filter:E,Promise:b})).Promise,(function(s,i,r){function a(){var r=t.filter;if(!r||r.apply(n,arguments))if(n.off(e,a),t.handleError){var o=arguments[0];o?i(o):s(w.apply(null,arguments).slice(1))}else s(w.apply(null,arguments))}r((function(){n.off(e,a)})),n._on(e,a,!1)}),{timeout:t.timeout,overload:t.overload})};var M=P.prototype;Object.defineProperties(P,{defaultMaxListeners:{get:function(){return M._maxListeners},set:function(e){if("number"!=typeof e||e<0||Number.isNaN(e))throw TypeError("n must be a non-negative number");M._maxListeners=e},enumerable:!0},once:{value:function(e,t,n){return k((n=v(n,{Promise,timeout:0,overload:!1},{Promise:b})).Promise,(function(n,s,i){var r;if("function"==typeof e.addEventListener)return r=function(){n(w.apply(null,arguments))},i((function(){e.removeEventListener(t,r)})),void e.addEventListener(t,r,{once:!0});var a,o=function(){a&&e.removeListener("error",a),n(w.apply(null,arguments))};"error"!==t&&(a=function(n){e.removeListener(t,o),s(n)},e.once("error",a)),i((function(){a&&e.removeListener("error",a),e.removeListener(t,o)})),e.once(t,o)}),{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(M,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),(s=function(){return P}.call(t,n,t,e))===r||(e.exports=s)}()}}]);